
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>基于OAtuth2的新浪微博Java爬虫 | XingLiu&#39;s  Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="XingLiu">
    

    
    <meta name="description" content="OAUTH协议为用户资源的授权提供了一个安全的、开放而又简易的标准。与以往的授权方式不同之处是OAUTH的授权不会使第三方触及到用户的帐号信息（如用户名与密码），即第三方无需使用用户的用户名与密码就可以申请获得该用户资源的授权，因此OAUTH是安全的。oAuth是Open Authorization的简写。">
<meta property="og:type" content="article">
<meta property="og:title" content="基于OAtuth2的新浪微博Java爬虫">
<meta property="og:url" content="http://pangjiuzala.github.io/2015/09/07/基于OAtuth2的新浪微博Java爬虫/index.html">
<meta property="og:site_name" content="XingLiu's  Blog">
<meta property="og:description" content="OAUTH协议为用户资源的授权提供了一个安全的、开放而又简易的标准。与以往的授权方式不同之处是OAUTH的授权不会使第三方触及到用户的帐号信息（如用户名与密码），即第三方无需使用用户的用户名与密码就可以申请获得该用户资源的授权，因此OAUTH是安全的。oAuth是Open Authorization的简写。">
<meta property="og:image" content="http://7xiur2.com1.z0.glb.clouddn.com/0253.png">
<meta property="og:updated_time" content="2015-09-07T03:20:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于OAtuth2的新浪微博Java爬虫">
<meta name="twitter:description" content="OAUTH协议为用户资源的授权提供了一个安全的、开放而又简易的标准。与以往的授权方式不同之处是OAUTH的授权不会使第三方触及到用户的帐号信息（如用户名与密码），即第三方无需使用用户的用户名与密码就可以申请获得该用户资源的授权，因此OAUTH是安全的。oAuth是Open Authorization的简写。">

    
    <link rel="alternative" href="https://github.com/search?q=pangjiuzala&type=Users" title="XingLiu&#39;s  Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="XingLiu&#39;s  Blog" title="XingLiu&#39;s  Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="XingLiu&#39;s  Blog">XingLiu&#39;s  Blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">文章列表</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/09/07/基于OAtuth2的新浪微博Java爬虫/" title="基于OAtuth2的新浪微博Java爬虫" itemprop="url">基于OAtuth2的新浪微博Java爬虫</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="XingLiu" target="_blank" itemprop="author">XingLiu</a>
		
  <p class="article-time">
    <time datetime="2015-09-07T02:50:50.000Z" itemprop="datePublished"> 发表于 2015-09-07</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#代码结构图"><span class="toc-number">1.</span> <span class="toc-text">代码结构图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#说明"><span class="toc-number">2.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#依赖jar包"><span class="toc-number">3.</span> <span class="toc-text">依赖jar包</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#存储文件"><span class="toc-number">4.</span> <span class="toc-text">存储文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#配置文件"><span class="toc-number">5.</span> <span class="toc-text">配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#config-properties"><span class="toc-number">5.1.</span> <span class="toc-text">config.properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log4j-properties"><span class="toc-number">5.2.</span> <span class="toc-text">log4j.properties</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#getData包"><span class="toc-number">6.</span> <span class="toc-text">getData包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GetFriendsData-java"><span class="toc-number">6.1.</span> <span class="toc-text">GetFriendsData.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#graph包"><span class="toc-number">7.</span> <span class="toc-text">graph包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GraphGenerate-java"><span class="toc-number">7.1.</span> <span class="toc-text">GraphGenerate.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GraphGenerateDriver-java"><span class="toc-number">7.2.</span> <span class="toc-text">GraphGenerateDriver.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MergeGraph-java"><span class="toc-number">7.3.</span> <span class="toc-text">MergeGraph.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IO包"><span class="toc-number">8.</span> <span class="toc-text">IO包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#FileIOOperation-java"><span class="toc-number">8.1.</span> <span class="toc-text">FileIOOperation.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j包"><span class="toc-number">9.</span> <span class="toc-text">weibo4j包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Friendships-java"><span class="toc-number">9.1.</span> <span class="toc-text">Friendships.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Users-java"><span class="toc-number">9.2.</span> <span class="toc-text">Users.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weibo-java"><span class="toc-number">9.3.</span> <span class="toc-text">Weibo.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-http包"><span class="toc-number">10.</span> <span class="toc-text">weibo4j.http包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AccessToken-java"><span class="toc-number">10.1.</span> <span class="toc-text">AccessToken.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BASE64Encoder-java"><span class="toc-number">10.2.</span> <span class="toc-text">BASE64Encoder.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTMLEntity-java"><span class="toc-number">10.3.</span> <span class="toc-text">HTMLEntity.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HttpClient-java"><span class="toc-number">10.4.</span> <span class="toc-text">HttpClient.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ImageItem-java"><span class="toc-number">10.5.</span> <span class="toc-text">ImageItem.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Response-java"><span class="toc-number">10.6.</span> <span class="toc-text">Response.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-model包"><span class="toc-number">11.</span> <span class="toc-text">weibo4j.model包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ApiRateLimits-java"><span class="toc-number">11.1.</span> <span class="toc-text">ApiRateLimits.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configuration-java"><span class="toc-number">11.2.</span> <span class="toc-text">Configuration.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Constants-java"><span class="toc-number">11.3.</span> <span class="toc-text">Constants.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySSLSocketFactory-java"><span class="toc-number">11.4.</span> <span class="toc-text">MySSLSocketFactory.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paging-java"><span class="toc-number">11.5.</span> <span class="toc-text">Paging.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PostParameter-java"><span class="toc-number">11.6.</span> <span class="toc-text">PostParameter.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Source-java"><span class="toc-number">11.7.</span> <span class="toc-text">Source.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Status-java"><span class="toc-number">11.8.</span> <span class="toc-text">Status.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StatusWapper-java"><span class="toc-number">11.9.</span> <span class="toc-text">StatusWapper.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#User-java"><span class="toc-number">11.10.</span> <span class="toc-text">User.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UserTrend-java"><span class="toc-number">11.11.</span> <span class="toc-text">UserTrend.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UserWapper-java"><span class="toc-number">11.12.</span> <span class="toc-text">UserWapper.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Version-java"><span class="toc-number">11.13.</span> <span class="toc-text">Version.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Visible-java"><span class="toc-number">11.14.</span> <span class="toc-text">Visible.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboException-java"><span class="toc-number">11.15.</span> <span class="toc-text">WeiboException.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboResponse-java"><span class="toc-number">11.16.</span> <span class="toc-text">WeiboResponse.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-org-json包"><span class="toc-number">12.</span> <span class="toc-text">weibo4j.org.json包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CDL-java"><span class="toc-number">12.1.</span> <span class="toc-text">CDL.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-java"><span class="toc-number">12.2.</span> <span class="toc-text">Cookie.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CookieList-java"><span class="toc-number">12.3.</span> <span class="toc-text">CookieList.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-java"><span class="toc-number">12.4.</span> <span class="toc-text">HTTP.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTPTokener-java"><span class="toc-number">12.5.</span> <span class="toc-text">HTTPTokener.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONArray-java"><span class="toc-number">12.6.</span> <span class="toc-text">JSONArray.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONException-java"><span class="toc-number">12.7.</span> <span class="toc-text">JSONException.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONObject-java"><span class="toc-number">12.8.</span> <span class="toc-text">JSONObject.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONString-java"><span class="toc-number">12.9.</span> <span class="toc-text">JSONString.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONStringer-java"><span class="toc-number">12.10.</span> <span class="toc-text">JSONStringer.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONTokener-java"><span class="toc-number">12.11.</span> <span class="toc-text">JSONTokener.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONWriter-java"><span class="toc-number">12.12.</span> <span class="toc-text">JSONWriter.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-util包"><span class="toc-number">13.</span> <span class="toc-text">weibo4j.util包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BareBonesBrowserLaunch-java"><span class="toc-number">13.1.</span> <span class="toc-text">BareBonesBrowserLaunch.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URLEncodeUtils-java"><span class="toc-number">13.2.</span> <span class="toc-text">URLEncodeUtils.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboConfig-java"><span class="toc-number">13.3.</span> <span class="toc-text">WeiboConfig.java</span></a></li></ol></li></ol>
		
		</div>
		
		<p>OAUTH协议为用户资源的授权提供了一个安全的、开放而又简易的标准。与以往的授权方式不同之处是OAUTH的授权不会使第三方触及到用户的帐号信息（如用户名与密码），即第三方无需使用用户的用户名与密码就可以申请获得该用户资源的授权，因此OAUTH是安全的。oAuth是Open Authorization的简写。<br><a id="more"></a><br>其实多数尝试动手写新浪微博爬虫的童鞋都知道，新浪微博虽然为用户提供了API调用的接口。但是依然是存在调用频率限制、API设计不完整等诸多问题。因此在某些需要大规模或者详细数据获取的一些研究我们还是得自己动手解析新浪微博的网页。</p>
<h1 id="代码结构图">代码结构图</h1><p><img src="http://7xiur2.com1.z0.glb.clouddn.com/0253.png" alt=""></p>
<h1 id="说明">说明</h1><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">请先填写相关配置：在Config.properties里</span><br><span class="line">client_ID ：appkey                           </span><br><span class="line">client_SERCRET ：app_secret</span><br><span class="line"><span class="string">redirect_URI :</span> 回调地址</span><br><span class="line">将存储文件中的文件拷贝到D盘</span><br><span class="line">申请微博的开发者权限</span><br><span class="line"><span class="string">http:</span><span class="comment">//open.weibo.com/development</span></span><br><span class="line">下载Java的SDK，然后调用相关的接口，例如</span><br><span class="line"><span class="string">http:</span><span class="comment">//open.weibo.com/wiki/2/friendships/followers</span></span><br><span class="line">返回结果是JSON</span><br><span class="line">运行主类GetFriendsData.java</span><br></pre></td></tr></table></figure>
<h1 id="依赖jar包">依赖jar包</h1><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">链接：<span class="string">http:</span><span class="comment">//pan.baidu.com/s/1qW3iI4G 密码：wvdz</span></span><br></pre></td></tr></table></figure>
<h1 id="存储文件">存储文件</h1><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">链接：<span class="string">http:</span><span class="comment">//pan.baidu.com/s/1jG4aTlc 密码：eoxa</span></span><br></pre></td></tr></table></figure>
<h1 id="配置文件">配置文件</h1><h2 id="config-properties">config.properties</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">client_ID = <span class="number">2299723665</span>    </span><br><span class="line">client_SERCRET = af784b4e0fc05c7e2ff7bc9c7453c3f6</span><br><span class="line">redirect_URI = <span class="string">http:</span><span class="comment">//www.baidu.com</span></span><br><span class="line">baseURL=<span class="string">https:</span><span class="comment">//api.weibo.com/2/</span></span><br><span class="line">accessTokenURL=<span class="string">https:</span><span class="comment">//api.weibo.com/oauth2/access_token</span></span><br><span class="line">authorizeURL=<span class="string">https:</span><span class="comment">//api.weibo.com/oauth2/authorize</span></span><br><span class="line">rmURL=https\:<span class="comment">//rm.api.weibo.com/2/</span></span><br></pre></td></tr></table></figure>
<h2 id="log4j-properties">log4j.properties</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">log</span>4j.rootLogger=debug, stdout, R</span><br><span class="line"><span class="built_in">log</span>4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line"><span class="built_in">log</span>4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>4j.logger.org.apache.commons.httpclient=info</span><br><span class="line"><span class="built_in">log</span>4j.logger.httpclient.wire.content=info</span><br><span class="line"><span class="built_in">log</span>4j.logger.httpclient.wire.header=info</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pattern to output the caller's file name and line number.</span></span><br><span class="line"><span class="built_in">log</span>4j.appender.stdout.layout.ConversionPattern=%-<span class="number">4</span>r %-<span class="number">5</span>p [%d&#123;yyyy-MM-dd HH:mm:ss&#125;]  %m%n</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>4j.appender.R=org.apache.log4j.RollingFileAppender</span><br><span class="line"><span class="built_in">log</span>4j.appender.R.File=weibo.log</span><br><span class="line"><span class="built_in">log</span>4j.appender.R.MaxFileSize= <span class="number">100</span>KB</span><br><span class="line"></span><br><span class="line"><span class="comment"># Keep one backup file</span></span><br><span class="line"><span class="built_in">log</span>4j.appender.R.MaxBackupIndex=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>4j.appender.R.layout=org.apache.log4j.PatternLayout</span><br><span class="line"><span class="built_in">log</span>4j.appender.R.layout.ConversionPattern=%-<span class="number">4</span>r %-<span class="number">5</span>p [%d&#123;yyyy-MM-dd HH\:mm\:ss&#125;]  %m%n</span><br></pre></td></tr></table></figure>
<h1 id="getData包">getData包</h1><h2 id="GetFriendsData-java">GetFriendsData.java</h2><figure class="highlight nimrod"><table><tr><td class="code"><pre><span class="line">package getData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">BufferedReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">BufferedWriter</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">FileInputStream</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">FileNotFoundException</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">FileOutputStream</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">IOException</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">InputStreamReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">OutputStreamWriter</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">UnsupportedEncodingException</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">Iterator</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">List</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.<span class="type">Friendships</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.<span class="type">User</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.<span class="type">UserWapper</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.<span class="type">WeiboException</span>;</span><br><span class="line"></span><br><span class="line">public class <span class="type">GetFriendsData</span> &#123;</span><br><span class="line"></span><br><span class="line">	private <span class="type">BufferedWriter</span> bw;</span><br><span class="line">	private <span class="type">BufferedReader</span> br;</span><br><span class="line">	private <span class="type">String</span> userID;</span><br><span class="line">	private <span class="type">UserWapper</span> userWapper;</span><br><span class="line">	private <span class="type">Friendships</span> friends;</span><br><span class="line">	private <span class="type">String</span> token;</span><br><span class="line">	private <span class="type">List</span>&lt;<span class="type">User</span>&gt; users;</span><br><span class="line"></span><br><span class="line">	public <span class="type">void</span> getDataFromSina() throws <span class="type">IOException</span> &#123;</span><br><span class="line">		br = new <span class="type">BufferedReader</span>(new <span class="type">InputStreamReader</span>(new <span class="type">FileInputStream</span>(</span><br><span class="line">				<span class="string">"D:\\sinaData.txt"</span>), <span class="string">"gbk"</span>));</span><br><span class="line">		<span class="type">String</span> line = null;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			line = br.readLine();</span><br><span class="line">			<span class="keyword">if</span> (line != null) &#123;</span><br><span class="line">				<span class="type">int</span> begin = line.indexOf(<span class="string">"="</span>);</span><br><span class="line">				userID = line.substring(begin, begin + <span class="number">10</span>);</span><br><span class="line">				friends = new <span class="type">Friendships</span>();</span><br><span class="line">				friends.client.setToken(token);</span><br><span class="line">				// 获取用户关注的用户列表</span><br><span class="line"></span><br><span class="line">				userWapper = friends.getFollowersById(userID);</span><br><span class="line"></span><br><span class="line">				users = userWapper.getUsers();</span><br><span class="line">				<span class="type">File</span> file = new <span class="type">File</span>(<span class="string">"D:\\users.txt"</span>);</span><br><span class="line">				<span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">					bw = new <span class="type">BufferedWriter</span>(new <span class="type">OutputStreamWriter</span>(</span><br><span class="line">							new <span class="type">FileOutputStream</span>(<span class="string">"D:\\users.txt"</span>), <span class="string">"gbk"</span>));</span><br><span class="line">				&#125; <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">				&#123;</span><br><span class="line">					bw = new <span class="type">BufferedWriter</span>(new <span class="type">OutputStreamWriter</span>(</span><br><span class="line">							new <span class="type">FileOutputStream</span>(<span class="string">"D:\\users.txt"</span>, <span class="literal">true</span>), <span class="string">"gbk"</span>));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="type">Iterator</span>&lt;<span class="type">User</span>&gt; <span class="keyword">iterator</span> = users.<span class="keyword">iterator</span>();</span><br><span class="line">				<span class="type">User</span> user = null;</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">iterator</span>.hasNext()) &#123;</span><br><span class="line">					user = (<span class="type">User</span>) <span class="keyword">iterator</span>.next();</span><br><span class="line">					bw.write(user.toString() + <span class="string">"\n"</span>);</span><br><span class="line">					bw.flush();</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (<span class="type">IOException</span> e) &#123;</span><br><span class="line">			// <span class="type">TODO</span> <span class="type">Auto</span>-generated catch <span class="keyword">block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (<span class="type">WeiboException</span> e) &#123;</span><br><span class="line">			// <span class="type">TODO</span> <span class="type">Auto</span>-generated catch <span class="keyword">block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			bw.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @param args</span><br><span class="line">	 * @throws <span class="type">IOException</span></span><br><span class="line">	 */</span><br><span class="line">	public <span class="keyword">static</span> <span class="type">void</span> main(<span class="type">String</span>[] args) throws <span class="type">IOException</span> &#123;</span><br><span class="line">		// <span class="type">TODO</span> <span class="type">Auto</span>-generated <span class="keyword">method</span> stub</span><br><span class="line"></span><br><span class="line">		<span class="type">Friendships</span> friends = new <span class="type">Friendships</span>();</span><br><span class="line">		<span class="type">String</span> userID = <span class="string">"2034465497"</span>;</span><br><span class="line">		<span class="type">String</span> token = <span class="string">"2.00d66gNC0WEQHS4a88a85c7903wynB"</span>;</span><br><span class="line">		friends.client.setToken(token);</span><br><span class="line">		<span class="type">UserWapper</span> userWapper = null;</span><br><span class="line">		<span class="type">List</span>&lt;<span class="type">User</span>&gt; users = null;</span><br><span class="line">		<span class="type">BufferedWriter</span> bw = null;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			// 获取用户关注的用户列表</span><br><span class="line">			userWapper = friends.getFollowersById(userID);</span><br><span class="line">			users = userWapper.getUsers();</span><br><span class="line"></span><br><span class="line">			bw = new <span class="type">BufferedWriter</span>(new <span class="type">OutputStreamWriter</span>(</span><br><span class="line">					new <span class="type">FileOutputStream</span>(<span class="string">"D:\\users.txt"</span>), <span class="string">"gbk"</span>));</span><br><span class="line">			<span class="type">Iterator</span>&lt;<span class="type">User</span>&gt; <span class="keyword">iterator</span> = users.<span class="keyword">iterator</span>();</span><br><span class="line">			<span class="type">User</span> user = null;</span><br><span class="line">			<span class="keyword">while</span> (<span class="keyword">iterator</span>.hasNext()) &#123;</span><br><span class="line">				user = (<span class="type">User</span>) <span class="keyword">iterator</span>.next();</span><br><span class="line">				bw.write(user.toString() + <span class="string">"\n"</span>);</span><br><span class="line">				bw.flush();</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (<span class="type">WeiboException</span> e) &#123;</span><br><span class="line">			// <span class="type">TODO</span> <span class="type">Auto</span>-generated catch <span class="keyword">block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="type">System</span>.<span class="keyword">out</span>.println(e);</span><br><span class="line">		&#125; catch (<span class="type">FileNotFoundException</span> e) &#123;</span><br><span class="line">			// <span class="type">TODO</span> <span class="type">Auto</span>-generated catch <span class="keyword">block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (<span class="type">IOException</span> e) &#123;</span><br><span class="line">			// <span class="type">TODO</span> <span class="type">Auto</span>-generated catch <span class="keyword">block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			bw.close();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="graph包">graph包</h1><h2 id="GraphGenerate-java">GraphGenerate.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> graph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">BufferedReader</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.Friendships;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.WeiboException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class GraphGenerate &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> uid; <span class="comment">// My id for application in sina</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> access_Token; <span class="comment">// My access token for application in sina</span></span><br><span class="line">	<span class="keyword">private</span> Friendships fm;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> BufferedWriter bw;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">BufferedReader</span> br;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt; table; <span class="comment">// Define an adjacency</span></span><br><span class="line">														<span class="comment">// list</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">int</span> count; <span class="comment">// Authorize count (75/h)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> GraphGenerate() &#123; <span class="comment">// Constructor</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\AccessToken.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			access_Token = br.readLine(); <span class="comment">// Initialize</span></span><br><span class="line">			uid = br.readLine();</span><br><span class="line"></span><br><span class="line">			fm = <span class="keyword">new</span> Friendships();</span><br><span class="line"></span><br><span class="line">			table = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt;();</span><br><span class="line"></span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\GraphGenerateId.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(</span><br><span class="line">					<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\liu\\TmpGraphGenerateId.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			count = <span class="number">10</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span>[] getIds(<span class="keyword">String</span> friendId) &#123; <span class="comment">// Get friends' ids of the</span></span><br><span class="line">												<span class="comment">// friendId</span></span><br><span class="line"></span><br><span class="line">		fm.client.setToken(access_Token);</span><br><span class="line">		<span class="keyword">String</span>[] ids = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ids = fm.getFriendsIdsByUid(friendId); <span class="comment">// Sina interface</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (WeiboException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ids;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> LinkedList&lt;<span class="keyword">String</span>&gt; getList(<span class="keyword">String</span>[] ids) &#123; <span class="comment">// Generate a list for</span></span><br><span class="line">														<span class="comment">// ids</span></span><br><span class="line"></span><br><span class="line">		LinkedList&lt;<span class="keyword">String</span>&gt; list = <span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ids.length; i++) &#123;</span><br><span class="line">			list.<span class="built_in">add</span>(ids[i]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> generateGraph() &#123; <span class="comment">// Invocated when the information of graph is</span></span><br><span class="line">									<span class="comment">// none</span></span><br><span class="line"></span><br><span class="line">		table.put(uid, getList(getIds(uid))); <span class="comment">// Put my friends' ids to table</span></span><br><span class="line">												<span class="comment">// for the first time</span></span><br><span class="line"></span><br><span class="line">		adjustTable(); <span class="comment">// Generate more graph information to table</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> adjustTable() &#123; <span class="comment">// Generate more graph information to table</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt; tmpTable = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt;(); <span class="comment">// Extended</span></span><br><span class="line">																									<span class="comment">// node</span></span><br><span class="line">																									<span class="comment">// should</span></span><br><span class="line">																									<span class="comment">// be</span></span><br><span class="line">																									<span class="comment">// putted</span></span><br><span class="line">																									<span class="comment">// in</span></span><br><span class="line">																									<span class="comment">// this</span></span><br><span class="line">																									<span class="comment">// table</span></span><br><span class="line"></span><br><span class="line">		Set&lt;<span class="keyword">String</span>&gt; keyset = table.keySet();</span><br><span class="line"></span><br><span class="line">		LinkedList&lt;<span class="keyword">String</span>&gt; list;</span><br><span class="line"></span><br><span class="line">		Iterator&lt;<span class="keyword">String</span>&gt; itkey = keyset.iterator();</span><br><span class="line"></span><br><span class="line">		Iterator&lt;<span class="keyword">String</span>&gt; itlist;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> keyid;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> id;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (itkey.hasNext()) &#123; <span class="comment">// The next map key</span></span><br><span class="line"></span><br><span class="line">			keyid = itkey.next();</span><br><span class="line"></span><br><span class="line">			list = table.<span class="built_in">get</span>(keyid);</span><br><span class="line"></span><br><span class="line">			itlist = list.iterator();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (itlist.hasNext()) &#123; <span class="comment">// The next list's element</span></span><br><span class="line"></span><br><span class="line">				id = itlist.next();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (!table.containsKey(id)) &#123;</span><br><span class="line"></span><br><span class="line">					tmpTable.put(id, getList(getIds(id)));</span><br><span class="line"></span><br><span class="line">					<span class="keyword">this</span>.count--;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">this</span>.count == <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.count == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		itkey = tmpTable.keySet().iterator();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (itkey.hasNext()) &#123;</span><br><span class="line"></span><br><span class="line">			id = itkey.next();</span><br><span class="line"></span><br><span class="line">			table.put(id, tmpTable.<span class="built_in">get</span>(id));</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> serializeTable() &#123; <span class="comment">// Put the adjacency to the disk</span></span><br><span class="line"></span><br><span class="line">		Set&lt;<span class="keyword">String</span>&gt; keyset = table.keySet();</span><br><span class="line"></span><br><span class="line">		Iterator&lt;<span class="keyword">String</span>&gt; itkey = keyset.iterator();</span><br><span class="line"></span><br><span class="line">		Iterator&lt;<span class="keyword">String</span>&gt; itlist;</span><br><span class="line"></span><br><span class="line">		LinkedList&lt;<span class="keyword">String</span>&gt; list;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> id;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (itkey.hasNext()) &#123; <span class="comment">// The key set</span></span><br><span class="line"></span><br><span class="line">				id = itkey.next();</span><br><span class="line"></span><br><span class="line">				bw.write(<span class="string">"\n"</span> + id + <span class="string">"\t:\t"</span>);</span><br><span class="line"></span><br><span class="line">				list = table.<span class="built_in">get</span>(id);</span><br><span class="line"></span><br><span class="line">				itlist = list.iterator();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (itlist.hasNext()) &#123; <span class="comment">// The list</span></span><br><span class="line"></span><br><span class="line">					bw.write(itlist.next() + <span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				bw.write(<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			bw.flush();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">boolean</span> shouldRemove(LinkedList&lt;<span class="keyword">String</span>&gt; ids, Set&lt;<span class="keyword">String</span>&gt; reIds) &#123; <span class="comment">// If</span></span><br><span class="line">																				<span class="comment">// the</span></span><br><span class="line">																				<span class="comment">// node</span></span><br><span class="line">																				<span class="comment">// we</span></span><br><span class="line">																				<span class="comment">// have</span></span><br><span class="line">																				<span class="comment">// search</span></span><br><span class="line">																				<span class="comment">// in</span></span><br><span class="line">																				<span class="comment">// the</span></span><br><span class="line">																				<span class="comment">// file</span></span><br><span class="line">																				<span class="comment">// Should</span></span><br><span class="line">																				<span class="comment">// not</span></span><br><span class="line">																				<span class="comment">// read</span></span><br><span class="line">																				<span class="comment">// to</span></span><br><span class="line">																				<span class="comment">// table</span></span><br><span class="line">		Iterator&lt;<span class="keyword">String</span>&gt; it = ids.iterator();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!reIds.contains(it.next())) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// Read the node</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>; <span class="comment">// Discard the list</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> deSerializeTable() &#123; <span class="comment">// Read the adjacency from the file of</span></span><br><span class="line">										<span class="comment">// GraphGenerateId</span></span><br><span class="line">										<span class="comment">// The memory has only 75 item of</span></span><br><span class="line">										<span class="comment">// adjacency table</span></span><br><span class="line">		<span class="built_in">int</span> amount = <span class="number">10</span>; <span class="comment">// Assume the list read at least have a node that needs</span></span><br><span class="line">							<span class="comment">// to invocate the interface of sina</span></span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span>;</span><br><span class="line">		<span class="keyword">String</span>[] strs;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> head = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		LinkedList&lt;<span class="keyword">String</span>&gt; list = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		Set&lt;<span class="keyword">String</span>&gt; reIds = <span class="keyword">new</span> HashSet&lt;<span class="keyword">String</span>&gt;(); <span class="comment">// Redundante ids in map key</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> ((<span class="built_in">str</span> = br.readLine()) != <span class="keyword">null</span>) &#123; <span class="comment">// Initialize the reIds</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.contains(<span class="string">":"</span>)) &#123;</span><br><span class="line"></span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					reIds.<span class="built_in">add</span>(strs[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\GraphGenerateId.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> ((<span class="built_in">str</span> = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.contains(<span class="string">":"</span>)) &#123; <span class="comment">// A list head</span></span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (list != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (!shouldRemove(list, reIds)) &#123;</span><br><span class="line"></span><br><span class="line">							table.put(head, list);</span><br><span class="line"></span><br><span class="line">							amount--;</span><br><span class="line"></span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (amount == <span class="number">0</span>) &#123; <span class="comment">// Have enough list in table</span></span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					head = strs[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">					list = <span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">2</span>; i &lt; strs.length; i++) &#123;</span><br><span class="line">						list.<span class="built_in">add</span>(strs[i]);</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; strs.length; i++) &#123;</span><br><span class="line">						list.<span class="built_in">add</span>(strs[i]);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (amount == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (!shouldRemove(list, reIds)) &#123; <span class="comment">// The last list</span></span><br><span class="line"></span><br><span class="line">				table.put(head, list);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> releaseResourse() &#123; <span class="comment">// Release the related stream</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			br.close();</span><br><span class="line">			bw.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> start() &#123; <span class="comment">// The main function</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (br.readLine() == <span class="keyword">null</span>) &#123; <span class="comment">// No information of graph on the disk</span></span><br><span class="line">				generateGraph();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				deSerializeTable(); <span class="comment">// Read file(Only 240 id_key-id_list)</span></span><br><span class="line">				adjustTable();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			serializeTable();</span><br><span class="line"></span><br><span class="line">			releaseResourse();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="GraphGenerateDriver-java">GraphGenerateDriver.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> graph;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphGenerateDriver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		GraphGenerate gg = <span class="keyword">new</span> GraphGenerate();</span><br><span class="line"></span><br><span class="line">		MergeGraph mg = <span class="keyword">new</span> MergeGraph();</span><br><span class="line"></span><br><span class="line">		gg.start(); <span class="comment">// Step onee</span></span><br><span class="line"></span><br><span class="line">		mg.start(); <span class="comment">// Step two</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="MergeGraph-java">MergeGraph.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> graph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">BufferedReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.Friendships;</span><br><span class="line"><span class="keyword">import</span> weibo4j.Users;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.User;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.UserWapper;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.WeiboException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class MergeGraph &#123; <span class="comment">// Merge the file of TmpGenerateGraphId to the file of</span></span><br><span class="line">							<span class="comment">// GenerateGraphId</span></span><br><span class="line">							<span class="comment">// Need to remove redundancy item</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">BufferedReader</span> br;</span><br><span class="line">	<span class="keyword">private</span> BufferedWriter bw1;</span><br><span class="line">	<span class="keyword">private</span> BufferedWriter bw2;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;<span class="keyword">String</span>&gt; <span class="built_in">set</span>; <span class="comment">// The ids existed in the file of GraphGenerateId</span></span><br><span class="line">	<span class="keyword">private</span> Map&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt; table; <span class="comment">// The adjacency in file of</span></span><br><span class="line">													<span class="comment">// TmpGraphGenerateId</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> access_Token;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Friendships fm;</span><br><span class="line">	<span class="keyword">private</span> UserWapper users;</span><br><span class="line">	<span class="keyword">private</span> User user;</span><br><span class="line">	<span class="keyword">private</span> Users um;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> MergeGraph() &#123; <span class="comment">// Construct</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\AccessToken.txt"</span>)));</span><br><span class="line">			access_Token = br.readLine();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">set</span> = <span class="keyword">new</span> HashSet&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line">		table = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, LinkedList&lt;<span class="keyword">String</span>&gt;&gt;();</span><br><span class="line">		fm = <span class="keyword">new</span> Friendships();</span><br><span class="line">		fm.client.setToken(access_Token);</span><br><span class="line">		um = <span class="keyword">new</span> Users();</span><br><span class="line">		um.client.setToken(access_Token);</span><br><span class="line"></span><br><span class="line">		br = <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> class ConstantString &#123; <span class="comment">// Format Token</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> NODE_USER = <span class="string">"�����û���\t"</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> OUT_DEGREE_USER = <span class="string">"����û���\n"</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> SEPARATER1 = <span class="string">"--------------------------------------------------------------------\n"</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> SEPARATER2 = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n"</span></span><br><span class="line">				+ <span class="string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> deSerializeTable() &#123; <span class="comment">// Read the adjacency from the file of</span></span><br><span class="line">										<span class="comment">// TmpGraphGeneratedId</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span>;</span><br><span class="line">		<span class="keyword">String</span>[] strs;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\TmpGraphGenerateId.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">String</span> head = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">			LinkedList&lt;<span class="keyword">String</span>&gt; list = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> ((<span class="built_in">str</span> = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.contains(<span class="string">":"</span>)) &#123; <span class="comment">// A list head</span></span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (list != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">						table.put(head, list);</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					head = strs[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">					list = <span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">2</span>; i &lt; strs.length; i++) &#123;</span><br><span class="line">						list.<span class="built_in">add</span>(strs[i]);</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; strs.length; i++) &#123;</span><br><span class="line">						list.<span class="built_in">add</span>(strs[i]);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			table.put(head, list); <span class="comment">// The last list</span></span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> serializeTable() &#123; <span class="comment">// Merge the graph information in the file</span></span><br><span class="line">									<span class="comment">// of TmpGraphGenerateId</span></span><br><span class="line">									<span class="comment">// to the file of GraphGeneratedId(need to</span></span><br><span class="line">									<span class="comment">// remove redundancy item)</span></span><br><span class="line">									<span class="comment">// At the same time, generate detail</span></span><br><span class="line">									<span class="comment">// information to the file of</span></span><br><span class="line">									<span class="comment">// GraphGenerateDetailInfo</span></span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span>;</span><br><span class="line">		<span class="keyword">String</span>[] strs;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"D:\\liu\\GraphGenerateId.txt"</span>)));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> ((<span class="built_in">str</span> = br.readLine()) != <span class="keyword">null</span>) &#123; <span class="comment">// Initial set</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">str</span>.contains(<span class="string">":"</span>)) &#123;</span><br><span class="line">					strs = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\t"</span>);</span><br><span class="line">					<span class="built_in">set</span>.<span class="built_in">add</span>(strs[<span class="number">0</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			Iterator&lt;<span class="keyword">String</span>&gt; itkey = table.keySet().iterator();</span><br><span class="line"></span><br><span class="line">			bw1 = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(</span><br><span class="line">					<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\liu\\GraphGenerateId.txt"</span>, <span class="keyword">true</span>)));</span><br><span class="line"></span><br><span class="line">			bw2 = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(</span><br><span class="line">					<span class="keyword">new</span> FileOutputStream(</span><br><span class="line">							<span class="string">"D:\\liu\\GraphGenerateDetailInfo.txt"</span>, <span class="keyword">true</span>)));</span><br><span class="line"></span><br><span class="line">			LinkedList&lt;<span class="keyword">String</span>&gt; list;</span><br><span class="line"></span><br><span class="line">			Iterator&lt;<span class="keyword">String</span>&gt; itlist;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (itkey.hasNext()) &#123; <span class="comment">// The key set</span></span><br><span class="line"></span><br><span class="line">				<span class="built_in">str</span> = itkey.next();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (!<span class="built_in">set</span>.contains(<span class="built_in">str</span>)) &#123;</span><br><span class="line"></span><br><span class="line">					bw1.write(<span class="string">"\n"</span> + <span class="built_in">str</span> + <span class="string">"\t:\t"</span>);</span><br><span class="line"></span><br><span class="line">					bw2.write(ConstantString.NODE_USER + <span class="built_in">str</span> + <span class="string">"\n\n"</span>);</span><br><span class="line"></span><br><span class="line">					user = um.showUserById(<span class="built_in">str</span>);</span><br><span class="line"></span><br><span class="line">					bw2.write(user.toString() + <span class="string">"\n\n"</span>); <span class="comment">// The detail</span></span><br><span class="line">															<span class="comment">// information of</span></span><br><span class="line">															<span class="comment">// user node</span></span><br><span class="line"></span><br><span class="line">					bw2.write(ConstantString.SEPARATER1 + <span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">					bw2.write(ConstantString.OUT_DEGREE_USER + <span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">					users = fm.getFriendsByID(<span class="built_in">str</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (User u : users.getUsers()) &#123;</span><br><span class="line">						bw2.write(u.toString() + <span class="string">"\n\n"</span>); <span class="comment">// The detail</span></span><br><span class="line">															<span class="comment">// information of</span></span><br><span class="line">															<span class="comment">// out degree user</span></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					bw2.write(ConstantString.SEPARATER2 + <span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">					list = table.<span class="built_in">get</span>(<span class="built_in">str</span>);</span><br><span class="line"></span><br><span class="line">					itlist = list.iterator();</span><br><span class="line"></span><br><span class="line">					<span class="keyword">while</span> (itlist.hasNext()) &#123; <span class="comment">// The list</span></span><br><span class="line"></span><br><span class="line">						bw1.write(itlist.next() + <span class="string">"\t"</span>);</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					bw1.write(<span class="string">"\n"</span>);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			bw1.flush();</span><br><span class="line">			bw2.flush();</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (WeiboException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> releaseResource() &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			br.close();</span><br><span class="line">			bw1.close();</span><br><span class="line">			bw2.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> start() &#123;</span><br><span class="line"></span><br><span class="line">		deSerializeTable();</span><br><span class="line"></span><br><span class="line">		serializeTable();</span><br><span class="line"></span><br><span class="line">		releaseResource();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="IO包">IO包</h1><h2 id="FileIOOperation-java">FileIOOperation.java</h2><figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">import</span> java.io.Reader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> FileIOOperation &#123;</span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 以字节为单位读取文件，常用于读二进制文件，如图片、声音、影像等文件。</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 *            文件的名</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> readFileByBytes(String fileName) &#123;</span><br><span class="line">		<span class="keyword">File</span> <span class="keyword">file</span> = <span class="keyword">new</span> <span class="keyword">File</span>(fileName);</span><br><span class="line">		InputStream in = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"以字节为单位读取文件内容，一次读一个字节："</span>);</span><br><span class="line">			<span class="comment">// 一次读一个字节</span></span><br><span class="line">			in = <span class="keyword">new</span> FileInputStream(<span class="keyword">file</span>);</span><br><span class="line">			<span class="keyword">int</span> tempbyte;</span><br><span class="line">			<span class="keyword">while</span> ((tempbyte = in.<span class="keyword">read</span>()) != -<span class="number">1</span>) &#123;</span><br><span class="line">				System.out.<span class="keyword">write</span>(tempbyte);</span><br><span class="line">			&#125;</span><br><span class="line">			in.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"以字节为单位读取文件内容，一次读多个字节："</span>);</span><br><span class="line">			<span class="comment">// 一次读多个字节</span></span><br><span class="line">			<span class="keyword">byte</span>[] tempbytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">100</span>];</span><br><span class="line">			<span class="keyword">int</span> byteread = <span class="number">0</span>;</span><br><span class="line">			in = <span class="keyword">new</span> FileInputStream(fileName);</span><br><span class="line">			FileIOOperation.showAvailableBytes(in);</span><br><span class="line">			<span class="comment">// 读入多个字节到字节数组中，byteread为一次读入的字节数</span></span><br><span class="line">			<span class="keyword">while</span> ((byteread = in.<span class="keyword">read</span>(tempbytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">				System.out.<span class="keyword">write</span>(tempbytes, <span class="number">0</span>, byteread);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					in.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 以字符为单位读取文件，常用于读文本，数字等类型的文件</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 *            文件名</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> readFileByChars(String fileName) &#123;</span><br><span class="line">		<span class="keyword">File</span> <span class="keyword">file</span> = <span class="keyword">new</span> <span class="keyword">File</span>(fileName);</span><br><span class="line">		Reader reader = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"以字符为单位读取文件内容，一次读一个字节："</span>);</span><br><span class="line">			<span class="comment">// 一次读一个字符</span></span><br><span class="line">			reader = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(<span class="keyword">file</span>));</span><br><span class="line">			<span class="keyword">int</span> tempchar;</span><br><span class="line">			<span class="keyword">while</span> ((tempchar = reader.<span class="keyword">read</span>()) != -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="comment">// 对于windows下，这两个字符在一起时，表示一个换行。</span></span><br><span class="line">				<span class="comment">// 但如果这两个字符分开显示时，会换两次行。</span></span><br><span class="line">				<span class="comment">// 因此，屏蔽掉，或者屏蔽。否则，将会多出很多空行。</span></span><br><span class="line">				<span class="keyword">if</span> (((<span class="keyword">char</span>) tempchar) != <span class="string">' '</span>) &#123;</span><br><span class="line">					System.out.<span class="keyword">print</span>((<span class="keyword">char</span>) tempchar);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			reader.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"以字符为单位读取文件内容，一次读多个字节："</span>);</span><br><span class="line">			<span class="comment">// 一次读多个字符</span></span><br><span class="line">			<span class="keyword">char</span>[] tempchars = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">30</span>];</span><br><span class="line">			<span class="keyword">int</span> charread = <span class="number">0</span>;</span><br><span class="line">			reader = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(fileName));</span><br><span class="line">			<span class="comment">// 读入多个字符到字符数组中，charread为一次读取字符数</span></span><br><span class="line">			<span class="keyword">while</span> ((charread = reader.<span class="keyword">read</span>(tempchars)) != -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="comment">// 同样屏蔽掉不显示</span></span><br><span class="line">				<span class="keyword">if</span> ((charread == tempchars.length)</span><br><span class="line">						&amp;&amp; (tempchars[tempchars.length - <span class="number">1</span>] != <span class="string">' '</span>)) &#123;</span><br><span class="line">					System.out.<span class="keyword">print</span>(tempchars);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charread; i++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (tempchars[i] == <span class="string">' '</span>) &#123;</span><br><span class="line">							<span class="keyword">continue</span>;</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							System.out.<span class="keyword">print</span>(tempchars[i]);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e1) &#123;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					reader.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 以行为单位读取文件，常用于读面向行的格式化文件</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 *            文件名</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> readFileByLines(String fileName) &#123;</span><br><span class="line">		<span class="keyword">File</span> <span class="keyword">file</span> = <span class="keyword">new</span> <span class="keyword">File</span>(fileName);</span><br><span class="line">		BufferedReader reader = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"以行为单位读取文件内容，一次读一整行："</span>);</span><br><span class="line">			reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="keyword">file</span>));</span><br><span class="line">			String tempString = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">int</span> line = <span class="number">1</span>;</span><br><span class="line">			<span class="comment">// 一次读入一行，直到读入null为文件结束</span></span><br><span class="line">			<span class="keyword">while</span> ((tempString = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="comment">// 显示行号</span></span><br><span class="line">				System.out.<span class="keyword">println</span>(<span class="string">"line "</span> + line + <span class="string">": "</span> + tempString);</span><br><span class="line">				line++;</span><br><span class="line">			&#125;</span><br><span class="line">			reader.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (reader != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					reader.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 随机读取文件内容</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 *            文件名</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> readFileByRandomAccess(String fileName) &#123;</span><br><span class="line">		RandomAccessFile randomFile = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"随机读取一段文件内容："</span>);</span><br><span class="line">			<span class="comment">// 打开一个随机访问文件流，按只读方式</span></span><br><span class="line">			randomFile = <span class="keyword">new</span> RandomAccessFile(fileName, <span class="string">"r"</span>);</span><br><span class="line">			<span class="comment">// 文件长度，字节数</span></span><br><span class="line">			<span class="keyword">long</span> fileLength = randomFile.length();</span><br><span class="line">			<span class="comment">// 读文件的起始位置</span></span><br><span class="line">			<span class="keyword">int</span> beginIndex = (fileLength &gt; <span class="number">4</span>) ? <span class="number">4</span> : <span class="number">0</span>;</span><br><span class="line">			<span class="comment">// 将读文件的开始位置移到beginIndex位置。</span></span><br><span class="line">			randomFile.seek(beginIndex);</span><br><span class="line">			<span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10</span>];</span><br><span class="line">			<span class="keyword">int</span> byteread = <span class="number">0</span>;</span><br><span class="line">			<span class="comment">// 一次读10个字节，如果文件内容不足10个字节，则读剩下的字节。</span></span><br><span class="line">			<span class="comment">// 将一次读取的字节数赋给byteread</span></span><br><span class="line">			<span class="keyword">while</span> ((byteread = randomFile.<span class="keyword">read</span>(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">				System.out.<span class="keyword">write</span>(bytes, <span class="number">0</span>, byteread);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (randomFile != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					randomFile.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 显示输入流中还剩的字节数</span><br><span class="line">	 * </span><br><span class="line">	 * @param in</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> showAvailableBytes(InputStream in) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.<span class="keyword">println</span>(<span class="string">"当前字节输入流中的字节数为:"</span> + in.available());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * A方法追加文件：使用RandomAccessFile</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 *            文件</span><br><span class="line">	 * @param content</span><br><span class="line">	 *            追加的内容</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> appendMethodA(String fileName, String content) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 打开一个随机访问文件流，按读写方式</span></span><br><span class="line">			RandomAccessFile randomFile = <span class="keyword">new</span> RandomAccessFile(fileName, <span class="string">"rw"</span>);</span><br><span class="line">			<span class="comment">// 文件长度，字节数</span></span><br><span class="line">			<span class="keyword">long</span> fileLength = randomFile.length();</span><br><span class="line">			<span class="comment">// 将写文件指针移到文件尾。</span></span><br><span class="line">			randomFile.seek(fileLength);</span><br><span class="line">			randomFile.writeBytes(content);</span><br><span class="line">			randomFile.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * B方法追加文件：使用FileWriter</span><br><span class="line">	 * </span><br><span class="line">	 * @param fileName</span><br><span class="line">	 * @param content</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> appendMethodB(String fileName, String content) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 打开一个写文件器，构造函数中的第二个参数true表示以追加形式写文件</span></span><br><span class="line">			FileWriter writer = <span class="keyword">new</span> FileWriter(fileName, <span class="keyword">true</span>);</span><br><span class="line">			writer.<span class="keyword">write</span>(content);</span><br><span class="line">			writer.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="weibo4j包">weibo4j包</h1><h2 id="Friendships-java">Friendships.java</h2><figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">package weibo4j;</span><br><span class="line"></span><br><span class="line">import weibo4j.model.Paging;</span><br><span class="line">import weibo4j.model.PostParameter;</span><br><span class="line">import weibo4j.model.User;</span><br><span class="line">import weibo4j.model.UserWapper;</span><br><span class="line">import weibo4j.model.WeiboException;</span><br><span class="line">import weibo4j.org.json.JSONArray;</span><br><span class="line">import weibo4j.util.WeiboConfig;</span><br><span class="line"></span><br><span class="line">public class Friendships extends Weibo &#123;</span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	private static final long serialVersionUID = 3603512821159421447L;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span>----------------------------关系接口----------------------------------------<span class="keyword">*</span>/</span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的关注列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user's follow</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends"</span>&gt;friendships/friends<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsByID(String id) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/friends.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, id) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的关注列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user's follow</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends"</span>&gt;friendships/friends<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsByScreenName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/friends.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取两个用户之间的共同关注人列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取共同关注关系的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user's follow</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/in_common"</span>&gt;friendships/friends/in_common<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsInCommon(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends/in_common.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取两个用户之间的共同关注人列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取共同关注关系的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param suid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取共同关注关系的用户UID，默认为当前登录用户</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为50</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param page</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的页码，默认为1</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user's follow</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/in_common"</span>&gt;friendships/friends/in_common<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsInCommon(String uid, String suid, Paging page)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends/in_common.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"suid"</span>, suid) &#125;, page));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的双向关注列表，即互粉列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取双向关注列表的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/bilateral"</span>&gt;friendships/friends/bilateral<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsBilateral(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends/bilateral.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的双向关注列表，即互粉列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取双向关注列表的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为50。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param page</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的页码，默认为1。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param sort</span></span><br><span class="line">	 <span class="keyword">*</span>            排序类型，0：按关注时间最近排序，默认为0。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of the user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/bilateral"</span>&gt;friendships/friends/bilateral<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsBilateral(String uid, Integer sort, Paging page)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends/bilateral.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"sort"</span>, sort.toString()) &#125;, page));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户双向关注的用户ID列表，即互粉UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取双向关注列表的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/bilateral/ids"</span>&gt;friendships/friends/bilateral/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsBilateralIds(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/bilateral/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户双向关注的用户ID列表，即互粉UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取双向关注列表的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为50。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param page</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的页码，默认为1。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param sort</span></span><br><span class="line">	 <span class="keyword">*</span>            排序类型，0：按关注时间最近排序，默认为0。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/bilateral/ids"</span>&gt;friendships/friends/bilateral/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsBilateralIds(String uid, Integer sort, Paging page)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/bilateral/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"sort"</span>, sort.toString()) &#125;, page));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户关注的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/ids"</span>&gt;friendships/friends/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsIdsByUid(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户关注的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/ids"</span>&gt;friendships/friends/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsIdsByName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户关注的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户UID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/ids"</span>&gt;friendships/friends/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsIdsByUid(String uid, Integer count, Integer cursor)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">						new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户关注的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return ids</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/ids"</span>&gt;friendships/friends/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFriendsIdsByName(String screen_name, Integer count,</span><br><span class="line">			Integer cursor) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/friends/ids.json"</span>, new PostParameter[] &#123;</span><br><span class="line">				new PostParameter(<span class="string">"screen_name"</span>, screen_name),</span><br><span class="line">				new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">				new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 批量获取当前登录用户的关注人的备注信息</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uids</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取备注的用户UID，用半角逗号分隔，最多不超过50个</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of user's remark</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends/remark_batch"</span>&gt;friendships/friends/remark_batch<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public JSONArray getRemark(String uids) throws WeiboException &#123;</span><br><span class="line">		return client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends/remark_batch.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uids"</span>, uids) &#125;)</span><br><span class="line">				.asJSONArray();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers"</span>&gt;friendships/followers<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersByName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/followers.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers"</span>&gt;friendships/followers<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersByName(String screen_name, Integer count,</span><br><span class="line">			Integer cursor) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/followers.json"</span>,</span><br><span class="line">				new PostParameter[] &#123;</span><br><span class="line">						new PostParameter(<span class="string">"screen_name"</span>, screen_name),</span><br><span class="line">						new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">						new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers"</span>&gt;friendships/followers<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersById(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/followers.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers"</span>&gt;friendships/followers<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersById(String uid, Integer count, Integer cursor)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/followers.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">						new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户粉丝的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/ids"</span>&gt;friendships/followers/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFollowersIdsById(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/followers/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户粉丝的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/ids"</span>&gt;friendships/followers/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFollowersIdsById(String uid, Integer count,</span><br><span class="line">			Integer cursor) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/followers/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">						new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户粉丝的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/ids"</span>&gt;friendships/followers/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFollowersIdsByName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/followers/ids.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户粉丝的用户UID列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            单页返回的记录条数，默认为500，最大不超过5000</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param cursor</span></span><br><span class="line">	 <span class="keyword">*</span>            返回结果的游标，下一页用返回值里的next_cursor，上一页用previous_cursor，默认为0</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/ids"</span>&gt;friendships/followers/ids<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public String[] getFollowersIdsByName(String screen_name, Integer count,</span><br><span class="line">			Integer cursor) throws WeiboException &#123;</span><br><span class="line">		return User.constructIds(client.get(WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">				+ <span class="string">"friendships/followers/ids.json"</span>, new PostParameter[] &#123;</span><br><span class="line">				new PostParameter(<span class="string">"screen_name"</span>, screen_name),</span><br><span class="line">				new PostParameter(<span class="string">"count"</span>, count.toString()),</span><br><span class="line">				new PostParameter(<span class="string">"cursor"</span>, cursor.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的活跃粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of user's id</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/active"</span>&gt;friendships/followers/active<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersActive(String uid) throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/followers/active.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取用户的活跃粉丝列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param count</span></span><br><span class="line">	 <span class="keyword">*</span>            返回的记录条数，默认为20，最大不超过200。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/followers/active"</span>&gt;friendships/followers/active<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFollowersActive(String uid, Integer count)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/followers/active.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid),</span><br><span class="line">						new PostParameter(<span class="string">"count"</span>, count.toString()) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 获取当前登录用户的关注人中又关注了指定用户的用户列表</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return list of users</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/friends_chain/followers"</span>&gt;friendships/friends_chain/followers<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public UserWapper getFriendsChainFollowers(String uid)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return User.constructWapperUsers(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>)</span><br><span class="line">						+ <span class="string">"friendships/friends_chain/followers.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 关注一个用户</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/create"</span>&gt;friendships/create<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User createFriendshipsById(String uid) throws WeiboException &#123;</span><br><span class="line">		return new User(client.post(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/create.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;)</span><br><span class="line">				.asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 关注一个用户</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户screen_name</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/create"</span>&gt;friendships/create<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User createFriendshipsByName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return new User(client.post(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/create.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;).asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 取消关注一个用户</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/destroy"</span>&gt;friendships/destroy<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User destroyFriendshipsDestroyById(String uid) throws WeiboException &#123;</span><br><span class="line">		return new User(client.post(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/destroy.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;)</span><br><span class="line">				.asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 取消关注一个用户</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户screen_name</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return user</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.0</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/friendships/destroy"</span>&gt;friendships/destroy<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User destroyFriendshipsDestroyByName(String screen_name)</span><br><span class="line">			throws WeiboException &#123;</span><br><span class="line">		return new User(client.post(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"friendships/destroy.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;).asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Users-java">Users.java</h2><figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">package weibo4j;</span><br><span class="line"></span><br><span class="line">import weibo4j.model.PostParameter;</span><br><span class="line">import weibo4j.model.User;</span><br><span class="line">import weibo4j.model.WeiboException;</span><br><span class="line">import weibo4j.org.json.JSONArray;</span><br><span class="line">import weibo4j.util.WeiboConfig;</span><br><span class="line"></span><br><span class="line">public class Users extends Weibo &#123;</span><br><span class="line"></span><br><span class="line">	private static final long serialVersionUID = 4742830953302255953L;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span>----------------------------用户接口----------------------------------------<span class="keyword">*</span>/</span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 根据用户ID获取用户信息</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uid</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的用户ID</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return User</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.1</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a href="http://open.weibo.com/wiki/2/users/show"&gt;users/show&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User showUserById(String uid) throws WeiboException &#123;</span><br><span class="line">		return new User(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"users/show.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uid"</span>, uid) &#125;)</span><br><span class="line">				.asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 根据用户ID获取用户信息</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param screen_name</span></span><br><span class="line">	 <span class="keyword">*</span>            用户昵称</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return User</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.1</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a href="http://open.weibo.com/wiki/2/users/show"&gt;users/show&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User showUserByScreenName(String screen_name) throws WeiboException &#123;</span><br><span class="line">		return new User(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"users/show.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"screen_name"</span>,</span><br><span class="line">						screen_name) &#125;).asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 通过个性化域名获取用户资料以及用户最新的一条微博</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param domain</span></span><br><span class="line">	 <span class="keyword">*</span>            需要查询的个性化域名。</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return User</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.1</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/users/domain_show"</span>&gt;users/domain_show<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public User showUserByDomain(String domain) throws WeiboException &#123;</span><br><span class="line">		return new User(client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"users/domain_show.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"domain"</span>, domain) &#125;)</span><br><span class="line">				.asJSONObject());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">	 <span class="keyword">*</span> 批量获取用户的粉丝数、关注数、微博数</span><br><span class="line">	 <span class="keyword">*</span> </span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@param uids</span></span><br><span class="line">	 <span class="keyword">*</span>            需要获取数据的用户UID，多个之间用逗号分隔，最多不超过100个</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@return jsonobject</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@throws WeiboException</span></span><br><span class="line">	 <span class="keyword">*</span>             when Weibo service or network is unavailable</span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@version weibo4j-V2 1.0.1</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@see &lt;a</span></span><br><span class="line">	 <span class="keyword">*</span>      href=<span class="string">"http://open.weibo.com/wiki/2/users/domain_show"</span>&gt;users/domain_show<span class="variable">&lt;/a&gt;</span></span><br><span class="line">	 <span class="keyword">*</span> <span class="comment">@since JDK 1.5</span></span><br><span class="line">	 <span class="keyword">*</span>/</span><br><span class="line">	public JSONArray getUserCount(String uids) throws WeiboException &#123;</span><br><span class="line">		return client.get(</span><br><span class="line">				WeiboConfig.getValue(<span class="string">"baseURL"</span>) + <span class="string">"users/counts.json"</span>,</span><br><span class="line">				new PostParameter[] &#123; new PostParameter(<span class="string">"uids"</span>, uids) &#125;)</span><br><span class="line">				.asJSONArray();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Weibo-java">Weibo.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.http.HttpClient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Weibo</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">4282616848978535016L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> HttpClient client = <span class="keyword">new</span> HttpClient();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setToken</span><span class="params">(String token)</span> </span>&#123;</span><br><span class="line">		client.setToken(token);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="weibo4j-http包">weibo4j.http包</h1><h2 id="AccessToken-java">AccessToken.java</h2><figure class="highlight nimrod"><table><tr><td class="code"><pre><span class="line">package weibo4j.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">Serializable</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.model.<span class="type">WeiboException</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.<span class="type">WeiboResponse</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="type">JSONException</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="type">JSONObject</span>;</span><br><span class="line"></span><br><span class="line">public class <span class="type">AccessToken</span> extends <span class="type">WeiboResponse</span> implements <span class="type">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">	private <span class="keyword">static</span> final long serialVersionUID = <span class="number">6986530164134648944</span>L;</span><br><span class="line">	private <span class="type">String</span> accessToken;</span><br><span class="line">	private <span class="type">String</span> expireIn;</span><br><span class="line">	private <span class="type">String</span> refreshToken;</span><br><span class="line">	private <span class="type">String</span> uid;</span><br><span class="line"></span><br><span class="line">	public <span class="type">AccessToken</span>(<span class="type">Response</span> res) throws <span class="type">WeiboException</span> &#123;</span><br><span class="line">		super(res);</span><br><span class="line">		<span class="type">JSONObject</span> json = res.asJSONObject();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			accessToken = json.getString(<span class="string">"access_token"</span>);</span><br><span class="line">			expireIn = json.getString(<span class="string">"expires_in"</span>);</span><br><span class="line">			refreshToken = json.getString(<span class="string">"refresh_token"</span>);</span><br><span class="line">			uid = json.getString(<span class="string">"uid"</span>);</span><br><span class="line">		&#125; catch (<span class="type">JSONException</span> je) &#123;</span><br><span class="line">			throw new <span class="type">WeiboException</span>(je.getMessage() + <span class="string">":"</span> + json.toString(),</span><br><span class="line">					je);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">AccessToken</span>(<span class="type">String</span> res) throws <span class="type">WeiboException</span>, <span class="type">JSONException</span> &#123;</span><br><span class="line">		super();</span><br><span class="line">		<span class="type">JSONObject</span> json = new <span class="type">JSONObject</span>(res);</span><br><span class="line">		accessToken = json.getString(<span class="string">"access_token"</span>);</span><br><span class="line">		expireIn = json.getString(<span class="string">"expires_in"</span>);</span><br><span class="line">		refreshToken = json.getString(<span class="string">"refresh_token"</span>);</span><br><span class="line">		uid = json.getString(<span class="string">"uid"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">String</span> getAccessToken() &#123;</span><br><span class="line">		<span class="keyword">return</span> accessToken;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">String</span> getExpireIn() &#123;</span><br><span class="line">		<span class="keyword">return</span> expireIn;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">String</span> getRefreshToken() &#123;</span><br><span class="line">		<span class="keyword">return</span> refreshToken;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public <span class="type">int</span> hashCode() &#123;</span><br><span class="line">		final <span class="type">int</span> prime = <span class="number">31</span>;</span><br><span class="line">		<span class="type">int</span> <span class="literal">result</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="literal">result</span> = prime * <span class="literal">result</span></span><br><span class="line">				+ ((accessToken == null) ? <span class="number">0</span> : accessToken.hashCode());</span><br><span class="line">		<span class="literal">result</span> = prime * <span class="literal">result</span></span><br><span class="line">				+ ((expireIn == null) ? <span class="number">0</span> : expireIn.hashCode());</span><br><span class="line">		<span class="literal">result</span> = prime * <span class="literal">result</span></span><br><span class="line">				+ ((refreshToken == null) ? <span class="number">0</span> : refreshToken.hashCode());</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public boolean equals(<span class="type">Object</span> obj) &#123;</span><br><span class="line">		<span class="keyword">if</span> (this == obj)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj == null)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (getClass() != obj.getClass())</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="type">AccessToken</span> other = (<span class="type">AccessToken</span>) obj;</span><br><span class="line">		<span class="keyword">if</span> (accessToken == null) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.accessToken != null)</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!accessToken.equals(other.accessToken))</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (expireIn == null) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.expireIn != null)</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!expireIn.equals(other.expireIn))</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (refreshToken == null) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.refreshToken != null)</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!refreshToken.equals(other.refreshToken))</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public <span class="type">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"AccessToken ["</span> + <span class="string">"accessToken="</span> + accessToken + <span class="string">", expireIn="</span></span><br><span class="line">				+ expireIn + <span class="string">", refreshToken="</span> + refreshToken + <span class="string">",uid="</span> + uid</span><br><span class="line">				+ <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BASE64Encoder-java">BASE64Encoder.java</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">package weibo4j.http;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * A utility class encodes byte array into String using Base64 encoding scheme.</span><br><span class="line"> * </span><br><span class="line"> * @see weibo4j.http.HttpClient</span><br><span class="line"> * @author Yusuke Yamamoto - yusuke at mac.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> BASE64Encoder &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> last2byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"00000011"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> last4byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"00001111"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> last6byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"00111111"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> lead6byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"11111100"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> lead4byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"11110000"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span> lead2byte = (<span class="keyword">char</span>) Integer</span><br><span class="line">			.parseInt(<span class="string">"11000000"</span>, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">char</span>[] encodeTable = <span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>,</span><br><span class="line">			<span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>,</span><br><span class="line">			<span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>,</span><br><span class="line">			<span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>,</span><br><span class="line">			<span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>,</span><br><span class="line">			<span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'+'</span>, <span class="string">'/'</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">BASE64Encoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encode</span><span class="params">(byte[] from)</span> </span>&#123;</span><br><span class="line">		StringBuffer to = <span class="keyword">new</span> StringBuffer((<span class="keyword">int</span>) (from.length * <span class="number">1.34</span>) + <span class="number">3</span>);</span><br><span class="line">		<span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">char</span> currentByte = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; from.length; i++) &#123;</span><br><span class="line">			num = num % <span class="number">8</span>;</span><br><span class="line">			<span class="keyword">while</span> (num &lt; <span class="number">8</span>) &#123;</span><br><span class="line">				<span class="keyword">switch</span> (num) &#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (from[i] &amp; lead6byte);</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (currentByte &gt;&gt;&gt; <span class="number">2</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (from[i] &amp; last6byte);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (from[i] &amp; last4byte);</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (currentByte &lt;&lt; <span class="number">2</span>);</span><br><span class="line">					<span class="keyword">if</span> ((i + <span class="number">1</span>) &lt; from.length) &#123;</span><br><span class="line">						currentByte |= (from[i + <span class="number">1</span>] &amp; lead2byte) &gt;&gt;&gt; <span class="number">6</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (from[i] &amp; last2byte);</span><br><span class="line">					currentByte = (<span class="keyword">char</span>) (currentByte &lt;&lt; <span class="number">4</span>);</span><br><span class="line">					<span class="keyword">if</span> ((i + <span class="number">1</span>) &lt; from.length) &#123;</span><br><span class="line">						currentByte |= (from[i + <span class="number">1</span>] &amp; lead4byte) &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				to.append(encodeTable[currentByte]);</span><br><span class="line">				num += <span class="number">6</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (to.length() % <span class="number">4</span> != <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">4</span> - to.length() % <span class="number">4</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">				to.append(<span class="string">"="</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> to.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HTMLEntity-java">HTMLEntity.java</h2><figure class="highlight zephir"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">package weibo4j.http;</span><br><span class="line"></span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTMLEntity</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String escape(String original) &#123;</span><br><span class="line">		StringBuffer buf = <span class="keyword">new</span> StringBuffer(original);</span><br><span class="line">		escape(buf);</span><br><span class="line">		<span class="keyword">return</span> buf.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> void escape(StringBuffer original) &#123;</span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">		String escaped;</span><br><span class="line">		<span class="keyword">while</span> (index &lt; original.length()) &#123;</span><br><span class="line">			escaped = entityEscapeMap.get(original.substring(index, index + <span class="number">1</span>));</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> != escaped) &#123;</span><br><span class="line">				original.replace(index, index + <span class="number">1</span>, escaped);</span><br><span class="line">				index += escaped.length();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				index++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String unescape(String original) &#123;</span><br><span class="line">		StringBuffer buf = <span class="keyword">new</span> StringBuffer(original);</span><br><span class="line">		unescape(buf);</span><br><span class="line">		<span class="keyword">return</span> buf.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> void unescape(StringBuffer original) &#123;</span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> semicolonIndex = <span class="number">0</span>;</span><br><span class="line">		String escaped;</span><br><span class="line">		String entity;</span><br><span class="line">		<span class="keyword">while</span> (index &lt; original.length()) &#123;</span><br><span class="line">			index = original.indexOf(<span class="string">"&amp;"</span>, index);</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> == index) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			semicolonIndex = original.indexOf(<span class="string">";"</span>, index);</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> != semicolonIndex &amp;&amp; <span class="number">10</span> &gt; (semicolonIndex - index)) &#123;</span><br><span class="line">				escaped = original.substring(index, semicolonIndex + <span class="number">1</span>);</span><br><span class="line">				entity = escapeEntityMap.get(escaped);</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">null</span> != entity) &#123;</span><br><span class="line">					original.replace(index, semicolonIndex + <span class="number">1</span>, entity);</span><br><span class="line">				&#125;</span><br><span class="line">				index++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, String&gt; entityEscapeMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, String&gt; escapeEntityMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		String[][] entities = &#123;</span><br><span class="line">				&#123; <span class="string">"&amp;nbsp;"</span>, <span class="string">"&amp;#160;"</span><span class="comment">/* no-break space = non-breaking space */</span>,</span><br><span class="line">						<span class="string">"\u00A0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;iexcl;"</span>, <span class="string">"&amp;#161;"</span><span class="comment">/* inverted exclamation mark */</span>, <span class="string">"\u00A1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;cent;"</span>, <span class="string">"&amp;#162;"</span><span class="comment">/* cent sign */</span>, <span class="string">"\u00A2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;pound;"</span>, <span class="string">"&amp;#163;"</span><span class="comment">/* pound sign */</span>, <span class="string">"\u00A3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;curren;"</span>, <span class="string">"&amp;#164;"</span><span class="comment">/* currency sign */</span>, <span class="string">"\u00A4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;yen;"</span>, <span class="string">"&amp;#165;"</span><span class="comment">/* yen sign = yuan sign */</span>, <span class="string">"\u00A5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;brvbar;"</span>, <span class="string">"&amp;#166;"</span><span class="comment">/* broken bar = broken vertical bar */</span>,</span><br><span class="line">						<span class="string">"\u00A6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sect;"</span>, <span class="string">"&amp;#167;"</span><span class="comment">/* section sign */</span>, <span class="string">"\u00A7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;uml;"</span>, <span class="string">"&amp;#168;"</span><span class="comment">/* diaeresis = spacing diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00A8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;copy;"</span>, <span class="string">"&amp;#169;"</span><span class="comment">/* copyright sign */</span>, <span class="string">"\u00A9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ordf;"</span>, <span class="string">"&amp;#170;"</span><span class="comment">/* feminine ordinal indicator */</span>, <span class="string">"\u00AA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;laquo;"</span>, <span class="string">"&amp;#171;"</span><span class="comment">/*</span><br><span class="line">									 * left-pointing double angle quotation mark</span><br><span class="line">									 * = left pointing guillemet</span><br><span class="line">									 */</span>, <span class="string">"\u00AB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;not;"</span>, <span class="string">"&amp;#172;"</span><span class="comment">/* not sign = discretionary hyphen */</span>,</span><br><span class="line">						<span class="string">"\u00AC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;shy;"</span>, <span class="string">"&amp;#173;"</span><span class="comment">/* soft hyphen = discretionary hyphen */</span>,</span><br><span class="line">						<span class="string">"\u00AD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;reg;"</span>, <span class="string">"&amp;#174;"</span><span class="comment">/*</span><br><span class="line">									 * registered sign = registered trade mark</span><br><span class="line">									 * sign</span><br><span class="line">									 */</span>, <span class="string">"\u00AE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;macr;"</span>, <span class="string">"&amp;#175;"</span><span class="comment">/*</span><br><span class="line">									 * macron = spacing macron = overline = APL</span><br><span class="line">									 * overbar</span><br><span class="line">									 */</span>, <span class="string">"\u00AF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;deg;"</span>, <span class="string">"&amp;#176;"</span><span class="comment">/* degree sign */</span>, <span class="string">"\u00B0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;plusmn;"</span>, <span class="string">"&amp;#177;"</span><span class="comment">/* plus-minus sign = plus-or-minus sign */</span>,</span><br><span class="line">						<span class="string">"\u00B1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sup2;"</span>, <span class="string">"&amp;#178;"</span><span class="comment">/*</span><br><span class="line">									 * superscript two = superscript digit two =</span><br><span class="line">									 * squared</span><br><span class="line">									 */</span>, <span class="string">"\u00B2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sup3;"</span>, <span class="string">"&amp;#179;"</span><span class="comment">/*</span><br><span class="line">									 * superscript three = superscript digit</span><br><span class="line">									 * three = cubed</span><br><span class="line">									 */</span>, <span class="string">"\u00B3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;acute;"</span>, <span class="string">"&amp;#180;"</span><span class="comment">/* acute accent = spacing acute */</span>,</span><br><span class="line">						<span class="string">"\u00B4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;micro;"</span>, <span class="string">"&amp;#181;"</span><span class="comment">/* micro sign */</span>, <span class="string">"\u00B5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;para;"</span>, <span class="string">"&amp;#182;"</span><span class="comment">/* pilcrow sign = paragraph sign */</span>,</span><br><span class="line">						<span class="string">"\u00B6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;middot;"</span>, <span class="string">"&amp;#183;"</span><span class="comment">/*</span><br><span class="line">									 * middle dot = Georgian comma = Greek</span><br><span class="line">									 * middle dot</span><br><span class="line">									 */</span>, <span class="string">"\u00B7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;cedil;"</span>, <span class="string">"&amp;#184;"</span><span class="comment">/* cedilla = spacing cedilla */</span>, <span class="string">"\u00B8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sup1;"</span>,</span><br><span class="line">						<span class="string">"&amp;#185;"</span><span class="comment">/* superscript one = superscript digit one */</span>,</span><br><span class="line">						<span class="string">"\u00B9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ordm;"</span>, <span class="string">"&amp;#186;"</span><span class="comment">/* masculine ordinal indicator */</span>, <span class="string">"\u00BA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;raquo;"</span>, <span class="string">"&amp;#187;"</span><span class="comment">/*</span><br><span class="line">									 * right-pointing double angle quotation</span><br><span class="line">									 * mark = right pointing guillemet</span><br><span class="line">									 */</span>, <span class="string">"\u00BB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;frac14;"</span>, <span class="string">"&amp;#188;"</span><span class="comment">/*</span><br><span class="line">									 * vulgar fraction one quarter = fraction</span><br><span class="line">									 * one quarter</span><br><span class="line">									 */</span>, <span class="string">"\u00BC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;frac12;"</span>, <span class="string">"&amp;#189;"</span><span class="comment">/*</span><br><span class="line">									 * vulgar fraction one half = fraction one</span><br><span class="line">									 * half</span><br><span class="line">									 */</span>, <span class="string">"\u00BD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;frac34;"</span>, <span class="string">"&amp;#190;"</span><span class="comment">/*</span><br><span class="line">									 * vulgar fraction three quarters = fraction</span><br><span class="line">									 * three quarters</span><br><span class="line">									 */</span>, <span class="string">"\u00BE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;iquest;"</span>, <span class="string">"&amp;#191;"</span><span class="comment">/*</span><br><span class="line">									 * inverted question mark = turned question</span><br><span class="line">									 * mark</span><br><span class="line">									 */</span>, <span class="string">"\u00BF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Agrave;"</span>, <span class="string">"&amp;#192;"</span><span class="comment">/*</span><br><span class="line">									 * latin capital letter A with grave = latin</span><br><span class="line">									 * capital letter A grave</span><br><span class="line">									 */</span>, <span class="string">"\u00C0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Aacute;"</span>, <span class="string">"&amp;#193;"</span><span class="comment">/* latin capital letter A with acute */</span>,</span><br><span class="line">						<span class="string">"\u00C1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Acirc;"</span>,</span><br><span class="line">						<span class="string">"&amp;#194;"</span><span class="comment">/* latin capital letter A with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00C2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Atilde;"</span>, <span class="string">"&amp;#195;"</span><span class="comment">/* latin capital letter A with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00C3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Auml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#196;"</span><span class="comment">/* latin capital letter A with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00C4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Aring;"</span>, <span class="string">"&amp;#197;"</span><span class="comment">/*</span><br><span class="line">									 * latin capital letter A with ring above =</span><br><span class="line">									 * latin capital letter A ring</span><br><span class="line">									 */</span>, <span class="string">"\u00C5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;AElig;"</span>, <span class="string">"&amp;#198;"</span><span class="comment">/*</span><br><span class="line">									 * latin capital letter AE = latin capital</span><br><span class="line">									 * ligature AE</span><br><span class="line">									 */</span>, <span class="string">"\u00C6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ccedil;"</span>, <span class="string">"&amp;#199;"</span><span class="comment">/* latin capital letter C with cedilla */</span>,</span><br><span class="line">						<span class="string">"\u00C7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Egrave;"</span>, <span class="string">"&amp;#200;"</span><span class="comment">/* latin capital letter E with grave */</span>,</span><br><span class="line">						<span class="string">"\u00C8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Eacute;"</span>, <span class="string">"&amp;#201;"</span><span class="comment">/* latin capital letter E with acute */</span>,</span><br><span class="line">						<span class="string">"\u00C9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ecirc;"</span>,</span><br><span class="line">						<span class="string">"&amp;#202;"</span><span class="comment">/* latin capital letter E with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00CA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Euml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#203;"</span><span class="comment">/* latin capital letter E with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00CB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Igrave;"</span>, <span class="string">"&amp;#204;"</span><span class="comment">/* latin capital letter I with grave */</span>,</span><br><span class="line">						<span class="string">"\u00CC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Iacute;"</span>, <span class="string">"&amp;#205;"</span><span class="comment">/* latin capital letter I with acute */</span>,</span><br><span class="line">						<span class="string">"\u00CD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Icirc;"</span>,</span><br><span class="line">						<span class="string">"&amp;#206;"</span><span class="comment">/* latin capital letter I with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00CE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Iuml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#207;"</span><span class="comment">/* latin capital letter I with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00CF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ETH;"</span>, <span class="string">"&amp;#208;"</span><span class="comment">/* latin capital letter ETH */</span>, <span class="string">"\u00D0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ntilde;"</span>, <span class="string">"&amp;#209;"</span><span class="comment">/* latin capital letter N with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00D1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ograve;"</span>, <span class="string">"&amp;#210;"</span><span class="comment">/* latin capital letter O with grave */</span>,</span><br><span class="line">						<span class="string">"\u00D2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Oacute;"</span>, <span class="string">"&amp;#211;"</span><span class="comment">/* latin capital letter O with acute */</span>,</span><br><span class="line">						<span class="string">"\u00D3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ocirc;"</span>,</span><br><span class="line">						<span class="string">"&amp;#212;"</span><span class="comment">/* latin capital letter O with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00D4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Otilde;"</span>, <span class="string">"&amp;#213;"</span><span class="comment">/* latin capital letter O with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00D5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ouml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#214;"</span><span class="comment">/* latin capital letter O with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00D6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;times;"</span>, <span class="string">"&amp;#215;"</span><span class="comment">/* multiplication sign */</span>, <span class="string">"\u00D7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Oslash;"</span>, <span class="string">"&amp;#216;"</span><span class="comment">/*</span><br><span class="line">									 * latin capital letter O with stroke =</span><br><span class="line">									 * latin capital letter O slash</span><br><span class="line">									 */</span>, <span class="string">"\u00D8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ugrave;"</span>, <span class="string">"&amp;#217;"</span><span class="comment">/* latin capital letter U with grave */</span>,</span><br><span class="line">						<span class="string">"\u00D9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Uacute;"</span>, <span class="string">"&amp;#218;"</span><span class="comment">/* latin capital letter U with acute */</span>,</span><br><span class="line">						<span class="string">"\u00DA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Ucirc;"</span>,</span><br><span class="line">						<span class="string">"&amp;#219;"</span><span class="comment">/* latin capital letter U with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00DB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Uuml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#220;"</span><span class="comment">/* latin capital letter U with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00DC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Yacute;"</span>, <span class="string">"&amp;#221;"</span><span class="comment">/* latin capital letter Y with acute */</span>,</span><br><span class="line">						<span class="string">"\u00DD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;THORN;"</span>, <span class="string">"&amp;#222;"</span><span class="comment">/* latin capital letter THORN */</span>, <span class="string">"\u00DE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;szlig;"</span>, <span class="string">"&amp;#223;"</span><span class="comment">/* latin small letter sharp s = ess-zed */</span>,</span><br><span class="line">						<span class="string">"\u00DF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;agrave;"</span>, <span class="string">"&amp;#224;"</span><span class="comment">/*</span><br><span class="line">									 * latin small letter a with grave = latin</span><br><span class="line">									 * small letter a grave</span><br><span class="line">									 */</span>, <span class="string">"\u00E0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;aacute;"</span>, <span class="string">"&amp;#225;"</span><span class="comment">/* latin small letter a with acute */</span>,</span><br><span class="line">						<span class="string">"\u00E1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;acirc;"</span>, <span class="string">"&amp;#226;"</span><span class="comment">/* latin small letter a with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00E2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;atilde;"</span>, <span class="string">"&amp;#227;"</span><span class="comment">/* latin small letter a with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00E3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;auml;"</span>, <span class="string">"&amp;#228;"</span><span class="comment">/* latin small letter a with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00E4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;aring;"</span>, <span class="string">"&amp;#229;"</span><span class="comment">/*</span><br><span class="line">									 * latin small letter a with ring above =</span><br><span class="line">									 * latin small letter a ring</span><br><span class="line">									 */</span>, <span class="string">"\u00E5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;aelig;"</span>, <span class="string">"&amp;#230;"</span><span class="comment">/*</span><br><span class="line">									 * latin small letter ae = latin small</span><br><span class="line">									 * ligature ae</span><br><span class="line">									 */</span>, <span class="string">"\u00E6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ccedil;"</span>, <span class="string">"&amp;#231;"</span><span class="comment">/* latin small letter c with cedilla */</span>,</span><br><span class="line">						<span class="string">"\u00E7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;egrave;"</span>, <span class="string">"&amp;#232;"</span><span class="comment">/* latin small letter e with grave */</span>,</span><br><span class="line">						<span class="string">"\u00E8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;eacute;"</span>, <span class="string">"&amp;#233;"</span><span class="comment">/* latin small letter e with acute */</span>,</span><br><span class="line">						<span class="string">"\u00E9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ecirc;"</span>, <span class="string">"&amp;#234;"</span><span class="comment">/* latin small letter e with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00EA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;euml;"</span>, <span class="string">"&amp;#235;"</span><span class="comment">/* latin small letter e with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00EB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;igrave;"</span>, <span class="string">"&amp;#236;"</span><span class="comment">/* latin small letter i with grave */</span>,</span><br><span class="line">						<span class="string">"\u00EC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;iacute;"</span>, <span class="string">"&amp;#237;"</span><span class="comment">/* latin small letter i with acute */</span>,</span><br><span class="line">						<span class="string">"\u00ED"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;icirc;"</span>, <span class="string">"&amp;#238;"</span><span class="comment">/* latin small letter i with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00EE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;iuml;"</span>, <span class="string">"&amp;#239;"</span><span class="comment">/* latin small letter i with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00EF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;eth;"</span>, <span class="string">"&amp;#240;"</span><span class="comment">/* latin small letter eth */</span>, <span class="string">"\u00F0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ntilde;"</span>, <span class="string">"&amp;#241;"</span><span class="comment">/* latin small letter n with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00F1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ograve;"</span>, <span class="string">"&amp;#242;"</span><span class="comment">/* latin small letter o with grave */</span>,</span><br><span class="line">						<span class="string">"\u00F2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;oacute;"</span>, <span class="string">"&amp;#243;"</span><span class="comment">/* latin small letter o with acute */</span>,</span><br><span class="line">						<span class="string">"\u00F3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ocirc;"</span>, <span class="string">"&amp;#244;"</span><span class="comment">/* latin small letter o with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00F4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;otilde;"</span>, <span class="string">"&amp;#245;"</span><span class="comment">/* latin small letter o with tilde */</span>,</span><br><span class="line">						<span class="string">"\u00F5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ouml;"</span>, <span class="string">"&amp;#246;"</span><span class="comment">/* latin small letter o with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00F6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;divide;"</span>, <span class="string">"&amp;#247;"</span><span class="comment">/* division sign */</span>, <span class="string">"\u00F7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;oslash;"</span>, <span class="string">"&amp;#248;"</span><span class="comment">/*</span><br><span class="line">									 * latin small letter o with stroke = latin</span><br><span class="line">									 * small letter o slash</span><br><span class="line">									 */</span>, <span class="string">"\u00F8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ugrave;"</span>, <span class="string">"&amp;#249;"</span><span class="comment">/* latin small letter u with grave */</span>,</span><br><span class="line">						<span class="string">"\u00F9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;uacute;"</span>, <span class="string">"&amp;#250;"</span><span class="comment">/* latin small letter u with acute */</span>,</span><br><span class="line">						<span class="string">"\u00FA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ucirc;"</span>, <span class="string">"&amp;#251;"</span><span class="comment">/* latin small letter u with circumflex */</span>,</span><br><span class="line">						<span class="string">"\u00FB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;uuml;"</span>, <span class="string">"&amp;#252;"</span><span class="comment">/* latin small letter u with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00FC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;yacute;"</span>, <span class="string">"&amp;#253;"</span><span class="comment">/* latin small letter y with acute */</span>,</span><br><span class="line">						<span class="string">"\u00FD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;thorn;"</span>, <span class="string">"&amp;#254;"</span><span class="comment">/* latin small letter thorn with */</span>,</span><br><span class="line">						<span class="string">"\u00FE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;yuml;"</span>, <span class="string">"&amp;#255;"</span><span class="comment">/* latin small letter y with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u00FF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;fnof;"</span>, <span class="string">"&amp;#402;"</span><span class="comment">/*</span><br><span class="line">									 * latin small f with hook = function =</span><br><span class="line">									 * florin</span><br><span class="line">									 */</span>, <span class="string">"\u0192"</span> &#125;</span><br><span class="line">				<span class="comment">/* Greek */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;Alpha;"</span>, <span class="string">"&amp;#913;"</span><span class="comment">/* greek capital letter alpha */</span>, <span class="string">"\u0391"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Beta;"</span>, <span class="string">"&amp;#914;"</span><span class="comment">/* greek capital letter beta */</span>, <span class="string">"\u0392"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Gamma;"</span>, <span class="string">"&amp;#915;"</span><span class="comment">/* greek capital letter gamma */</span>, <span class="string">"\u0393"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Delta;"</span>, <span class="string">"&amp;#916;"</span><span class="comment">/* greek capital letter delta */</span>, <span class="string">"\u0394"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Epsilon;"</span>, <span class="string">"&amp;#917;"</span><span class="comment">/* greek capital letter epsilon */</span>,</span><br><span class="line">						<span class="string">"\u0395"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Zeta;"</span>, <span class="string">"&amp;#918;"</span><span class="comment">/* greek capital letter zeta */</span>, <span class="string">"\u0396"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Eta;"</span>, <span class="string">"&amp;#919;"</span><span class="comment">/* greek capital letter eta */</span>, <span class="string">"\u0397"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Theta;"</span>, <span class="string">"&amp;#920;"</span><span class="comment">/* greek capital letter theta */</span>, <span class="string">"\u0398"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Iota;"</span>, <span class="string">"&amp;#921;"</span><span class="comment">/* greek capital letter iota */</span>, <span class="string">"\u0399"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Kappa;"</span>, <span class="string">"&amp;#922;"</span><span class="comment">/* greek capital letter kappa */</span>, <span class="string">"\u039A"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Lambda;"</span>, <span class="string">"&amp;#923;"</span><span class="comment">/* greek capital letter lambda */</span>, <span class="string">"\u039B"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Mu;"</span>, <span class="string">"&amp;#924;"</span><span class="comment">/* greek capital letter mu */</span>, <span class="string">"\u039C"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Nu;"</span>, <span class="string">"&amp;#925;"</span><span class="comment">/* greek capital letter nu */</span>, <span class="string">"\u039D"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Xi;"</span>, <span class="string">"&amp;#926;"</span><span class="comment">/* greek capital letter xi */</span>, <span class="string">"\u039E"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Omicron;"</span>, <span class="string">"&amp;#927;"</span><span class="comment">/* greek capital letter omicron */</span>,</span><br><span class="line">						<span class="string">"\u039F"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Pi;"</span>, <span class="string">"&amp;#928;"</span><span class="comment">/* greek capital letter pi */</span>, <span class="string">"\u03A0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Rho;"</span>, <span class="string">"&amp;#929;"</span><span class="comment">/* greek capital letter rho */</span>, <span class="string">"\u03A1"</span> &#125;</span><br><span class="line">				<span class="comment">/* there is no Sigmaf and no \u03A2 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;Sigma;"</span>, <span class="string">"&amp;#931;"</span><span class="comment">/* greek capital letter sigma */</span>, <span class="string">"\u03A3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Tau;"</span>, <span class="string">"&amp;#932;"</span><span class="comment">/* greek capital letter tau */</span>, <span class="string">"\u03A4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Upsilon;"</span>, <span class="string">"&amp;#933;"</span><span class="comment">/* greek capital letter upsilon */</span>,</span><br><span class="line">						<span class="string">"\u03A5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Phi;"</span>, <span class="string">"&amp;#934;"</span><span class="comment">/* greek capital letter phi */</span>, <span class="string">"\u03A6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Chi;"</span>, <span class="string">"&amp;#935;"</span><span class="comment">/* greek capital letter chi */</span>, <span class="string">"\u03A7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Psi;"</span>, <span class="string">"&amp;#936;"</span><span class="comment">/* greek capital letter psi */</span>, <span class="string">"\u03A8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Omega;"</span>, <span class="string">"&amp;#937;"</span><span class="comment">/* greek capital letter omega */</span>, <span class="string">"\u03A9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;alpha;"</span>, <span class="string">"&amp;#945;"</span><span class="comment">/* greek small letter alpha */</span>, <span class="string">"\u03B1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;beta;"</span>, <span class="string">"&amp;#946;"</span><span class="comment">/* greek small letter beta */</span>, <span class="string">"\u03B2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;gamma;"</span>, <span class="string">"&amp;#947;"</span><span class="comment">/* greek small letter gamma */</span>, <span class="string">"\u03B3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;delta;"</span>, <span class="string">"&amp;#948;"</span><span class="comment">/* greek small letter delta */</span>, <span class="string">"\u03B4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;epsilon;"</span>, <span class="string">"&amp;#949;"</span><span class="comment">/* greek small letter epsilon */</span>,</span><br><span class="line">						<span class="string">"\u03B5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;zeta;"</span>, <span class="string">"&amp;#950;"</span><span class="comment">/* greek small letter zeta */</span>, <span class="string">"\u03B6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;eta;"</span>, <span class="string">"&amp;#951;"</span><span class="comment">/* greek small letter eta */</span>, <span class="string">"\u03B7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;theta;"</span>, <span class="string">"&amp;#952;"</span><span class="comment">/* greek small letter theta */</span>, <span class="string">"\u03B8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;iota;"</span>, <span class="string">"&amp;#953;"</span><span class="comment">/* greek small letter iota */</span>, <span class="string">"\u03B9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;kappa;"</span>, <span class="string">"&amp;#954;"</span><span class="comment">/* greek small letter kappa */</span>, <span class="string">"\u03BA"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lambda;"</span>, <span class="string">"&amp;#955;"</span><span class="comment">/* greek small letter lambda */</span>, <span class="string">"\u03BB"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;mu;"</span>, <span class="string">"&amp;#956;"</span><span class="comment">/* greek small letter mu */</span>, <span class="string">"\u03BC"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;nu;"</span>, <span class="string">"&amp;#957;"</span><span class="comment">/* greek small letter nu */</span>, <span class="string">"\u03BD"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;xi;"</span>, <span class="string">"&amp;#958;"</span><span class="comment">/* greek small letter xi */</span>, <span class="string">"\u03BE"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;omicron;"</span>, <span class="string">"&amp;#959;"</span><span class="comment">/* greek small letter omicron */</span>,</span><br><span class="line">						<span class="string">"\u03BF"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;pi;"</span>, <span class="string">"&amp;#960;"</span><span class="comment">/* greek small letter pi */</span>, <span class="string">"\u03C0"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rho;"</span>, <span class="string">"&amp;#961;"</span><span class="comment">/* greek small letter rho */</span>, <span class="string">"\u03C1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sigmaf;"</span>, <span class="string">"&amp;#962;"</span><span class="comment">/* greek small letter final sigma */</span>,</span><br><span class="line">						<span class="string">"\u03C2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sigma;"</span>, <span class="string">"&amp;#963;"</span><span class="comment">/* greek small letter sigma */</span>, <span class="string">"\u03C3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;tau;"</span>, <span class="string">"&amp;#964;"</span><span class="comment">/* greek small letter tau */</span>, <span class="string">"\u03C4"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;upsilon;"</span>, <span class="string">"&amp;#965;"</span><span class="comment">/* greek small letter upsilon */</span>,</span><br><span class="line">						<span class="string">"\u03C5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;phi;"</span>, <span class="string">"&amp;#966;"</span><span class="comment">/* greek small letter phi */</span>, <span class="string">"\u03C6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;chi;"</span>, <span class="string">"&amp;#967;"</span><span class="comment">/* greek small letter chi */</span>, <span class="string">"\u03C7"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;psi;"</span>, <span class="string">"&amp;#968;"</span><span class="comment">/* greek small letter psi */</span>, <span class="string">"\u03C8"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;omega;"</span>, <span class="string">"&amp;#969;"</span><span class="comment">/* greek small letter omega */</span>, <span class="string">"\u03C9"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;thetasym;"</span>, <span class="string">"&amp;#977;"</span><span class="comment">/* greek small letter theta symbol */</span>,</span><br><span class="line">						<span class="string">"\u03D1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;upsih;"</span>, <span class="string">"&amp;#978;"</span><span class="comment">/* greek upsilon with hook symbol */</span>,</span><br><span class="line">						<span class="string">"\u03D2"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;piv;"</span>, <span class="string">"&amp;#982;"</span><span class="comment">/* greek pi symbol */</span>, <span class="string">"\u03D6"</span> &#125;</span><br><span class="line">				<span class="comment">/* General Punctuation */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;bull;"</span>, <span class="string">"&amp;#8226;"</span><span class="comment">/* bullet = black small circle */</span>, <span class="string">"\u2022"</span> &#125;</span><br><span class="line">				<span class="comment">/* bullet is NOT the same as bullet operator ,"\u2219 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;hellip;"</span>, <span class="string">"&amp;#8230;"</span><span class="comment">/*</span><br><span class="line">										 * horizontal ellipsis = three dot</span><br><span class="line">										 * leader</span><br><span class="line">										 */</span>, <span class="string">"\u2026"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;prime;"</span>, <span class="string">"&amp;#8242;"</span><span class="comment">/* prime = minutes = feet */</span>, <span class="string">"\u2032"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Prime;"</span>, <span class="string">"&amp;#8243;"</span><span class="comment">/* double prime = seconds = inches */</span>,</span><br><span class="line">						<span class="string">"\u2033"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;oline;"</span>, <span class="string">"&amp;#8254;"</span><span class="comment">/* overline = spacing overscore */</span>,</span><br><span class="line">						<span class="string">"\u203E"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;frasl;"</span>, <span class="string">"&amp;#8260;"</span><span class="comment">/* fraction slash */</span>, <span class="string">"\u2044"</span> &#125;</span><br><span class="line">				<span class="comment">/* Letterlike Symbols */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;weierp;"</span>, <span class="string">"&amp;#8472;"</span><span class="comment">/*</span><br><span class="line">										 * script capital P = power set =</span><br><span class="line">										 * Weierstrass p</span><br><span class="line">										 */</span>, <span class="string">"\u2118"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;image;"</span>,</span><br><span class="line">						<span class="string">"&amp;#8465;"</span><span class="comment">/* blackletter capital I = imaginary part */</span>,</span><br><span class="line">						<span class="string">"\u2111"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;real;"</span>,</span><br><span class="line">						<span class="string">"&amp;#8476;"</span><span class="comment">/* blackletter capital R = real part symbol */</span>,</span><br><span class="line">						<span class="string">"\u211C"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;trade;"</span>, <span class="string">"&amp;#8482;"</span><span class="comment">/* trade mark sign */</span>, <span class="string">"\u2122"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;alefsym;"</span>, <span class="string">"&amp;#8501;"</span><span class="comment">/*</span><br><span class="line">										 * alef symbol = first transfinite</span><br><span class="line">										 * cardinal</span><br><span class="line">										 */</span>, <span class="string">"\u2135"</span> &#125;</span><br><span class="line">				<span class="comment">/* alef symbol is NOT the same as hebrew letter alef ,"\u05D0"&#125; */</span></span><br><span class="line">				<span class="comment">/* Arrows */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;larr;"</span>, <span class="string">"&amp;#8592;"</span><span class="comment">/* leftwards arrow */</span>, <span class="string">"\u2190"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;uarr;"</span>, <span class="string">"&amp;#8593;"</span><span class="comment">/* upwards arrow */</span>, <span class="string">"\u2191"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rarr;"</span>, <span class="string">"&amp;#8594;"</span><span class="comment">/* rightwards arrow */</span>, <span class="string">"\u2192"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;darr;"</span>, <span class="string">"&amp;#8595;"</span><span class="comment">/* downwards arrow */</span>, <span class="string">"\u2193"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;harr;"</span>, <span class="string">"&amp;#8596;"</span><span class="comment">/* left right arrow */</span>, <span class="string">"\u2194"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;crarr;"</span>, <span class="string">"&amp;#8629;"</span><span class="comment">/*</span><br><span class="line">									 * downwards arrow with corner leftwards =</span><br><span class="line">									 * carriage return</span><br><span class="line">									 */</span>, <span class="string">"\u21B5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lArr;"</span>, <span class="string">"&amp;#8656;"</span><span class="comment">/* leftwards double arrow */</span>, <span class="string">"\u21D0"</span> &#125;</span><br><span class="line">				<span class="comment">/*</span><br><span class="line">				 * Unicode does not say that lArr is the same as the 'is implied</span><br><span class="line">				 * by' arrow but also does not have any other character for that</span><br><span class="line">				 * function. So ? lArr can be used for 'is implied by' as</span><br><span class="line">				 * ISOtech suggests</span><br><span class="line">				 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;uArr;"</span>, <span class="string">"&amp;#8657;"</span><span class="comment">/* upwards double arrow */</span>, <span class="string">"\u21D1"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rArr;"</span>, <span class="string">"&amp;#8658;"</span><span class="comment">/* rightwards double arrow */</span>, <span class="string">"\u21D2"</span> &#125;</span><br><span class="line">				<span class="comment">/*</span><br><span class="line">				 * Unicode does not say this is the 'implies' character but does</span><br><span class="line">				 * not have another character with this function so ? rArr can</span><br><span class="line">				 * be used for 'implies' as ISOtech suggests</span><br><span class="line">				 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;dArr;"</span>, <span class="string">"&amp;#8659;"</span><span class="comment">/* downwards double arrow */</span>, <span class="string">"\u21D3"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;hArr;"</span>, <span class="string">"&amp;#8660;"</span><span class="comment">/* left right double arrow */</span>, <span class="string">"\u21D4"</span> &#125;</span><br><span class="line">				<span class="comment">/* Mathematical Operators */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;forall;"</span>, <span class="string">"&amp;#8704;"</span><span class="comment">/* for all */</span>, <span class="string">"\u2200"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;part;"</span>, <span class="string">"&amp;#8706;"</span><span class="comment">/* partial differential */</span>, <span class="string">"\u2202"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;exist;"</span>, <span class="string">"&amp;#8707;"</span><span class="comment">/* there exists */</span>, <span class="string">"\u2203"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;empty;"</span>, <span class="string">"&amp;#8709;"</span><span class="comment">/* empty set = null set = diameter */</span>,</span><br><span class="line">						<span class="string">"\u2205"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;nabla;"</span>, <span class="string">"&amp;#8711;"</span><span class="comment">/* nabla = backward difference */</span>, <span class="string">"\u2207"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;isin;"</span>, <span class="string">"&amp;#8712;"</span><span class="comment">/* element of */</span>, <span class="string">"\u2208"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;notin;"</span>, <span class="string">"&amp;#8713;"</span><span class="comment">/* not an element of */</span>, <span class="string">"\u2209"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ni;"</span>, <span class="string">"&amp;#8715;"</span><span class="comment">/* contains as member */</span>, <span class="string">"\u220B"</span> &#125;</span><br><span class="line">				<span class="comment">/* should there be a more memorable name than 'ni'? */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;prod;"</span>, <span class="string">"&amp;#8719;"</span><span class="comment">/* n-ary product = product sign */</span>,</span><br><span class="line">						<span class="string">"\u220F"</span> &#125;</span><br><span class="line">				<span class="comment">/* prod is NOT the same character as ,"\u03A0"&#125; */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;sum;"</span>, <span class="string">"&amp;#8721;"</span><span class="comment">/* n-ary sumation */</span>, <span class="string">"\u2211"</span> &#125;</span><br><span class="line">				<span class="comment">/* sum is NOT the same character as ,"\u03A3"&#125; */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;minus;"</span>, <span class="string">"&amp;#8722;"</span><span class="comment">/* minus sign */</span>, <span class="string">"\u2212"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lowast;"</span>, <span class="string">"&amp;#8727;"</span><span class="comment">/* asterisk operator */</span>, <span class="string">"\u2217"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;radic;"</span>, <span class="string">"&amp;#8730;"</span><span class="comment">/* square root = radical sign */</span>, <span class="string">"\u221A"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;prop;"</span>, <span class="string">"&amp;#8733;"</span><span class="comment">/* proportional to */</span>, <span class="string">"\u221D"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;infin;"</span>, <span class="string">"&amp;#8734;"</span><span class="comment">/* infinity */</span>, <span class="string">"\u221E"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ang;"</span>, <span class="string">"&amp;#8736;"</span><span class="comment">/* angle */</span>, <span class="string">"\u2220"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;and;"</span>, <span class="string">"&amp;#8743;"</span><span class="comment">/* logical and = wedge */</span>, <span class="string">"\u2227"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;or;"</span>, <span class="string">"&amp;#8744;"</span><span class="comment">/* logical or = vee */</span>, <span class="string">"\u2228"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;cap;"</span>, <span class="string">"&amp;#8745;"</span><span class="comment">/* intersection = cap */</span>, <span class="string">"\u2229"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;cup;"</span>, <span class="string">"&amp;#8746;"</span><span class="comment">/* union = cup */</span>, <span class="string">"\u222A"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;int;"</span>, <span class="string">"&amp;#8747;"</span><span class="comment">/* integral */</span>, <span class="string">"\u222B"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;there4;"</span>, <span class="string">"&amp;#8756;"</span><span class="comment">/* therefore */</span>, <span class="string">"\u2234"</span> &#125;,</span><br><span class="line">				&#123;</span><br><span class="line">						<span class="string">"&amp;sim;"</span>,</span><br><span class="line">						<span class="string">"&amp;#8764;"</span><span class="comment">/* tilde operator = varies with = similar to */</span>,</span><br><span class="line">						<span class="string">"\u223C"</span> &#125;</span><br><span class="line">				<span class="comment">/*</span><br><span class="line">				 * tilde operator is NOT the same character as the tilde</span><br><span class="line">				 * ,"\u007E"&#125;</span><br><span class="line">				 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;cong;"</span>, <span class="string">"&amp;#8773;"</span><span class="comment">/* approximately equal to */</span>, <span class="string">"\u2245"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;asymp;"</span>, <span class="string">"&amp;#8776;"</span><span class="comment">/* almost equal to = asymptotic to */</span>,</span><br><span class="line">						<span class="string">"\u2248"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ne;"</span>, <span class="string">"&amp;#8800;"</span><span class="comment">/* not equal to */</span>, <span class="string">"\u2260"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;equiv;"</span>, <span class="string">"&amp;#8801;"</span><span class="comment">/* identical to */</span>, <span class="string">"\u2261"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;le;"</span>, <span class="string">"&amp;#8804;"</span><span class="comment">/* less-than or equal to */</span>, <span class="string">"\u2264"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ge;"</span>, <span class="string">"&amp;#8805;"</span><span class="comment">/* greater-than or equal to */</span>, <span class="string">"\u2265"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sub;"</span>, <span class="string">"&amp;#8834;"</span><span class="comment">/* subset of */</span>, <span class="string">"\u2282"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sup;"</span>, <span class="string">"&amp;#8835;"</span><span class="comment">/* superset of */</span>, <span class="string">"\u2283"</span> &#125;</span><br><span class="line">				<span class="comment">/* note that nsup 'not a superset of ,"\u2283"&#125; */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;sube;"</span>, <span class="string">"&amp;#8838;"</span><span class="comment">/* subset of or equal to */</span>, <span class="string">"\u2286"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;supe;"</span>, <span class="string">"&amp;#8839;"</span><span class="comment">/* superset of or equal to */</span>, <span class="string">"\u2287"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;oplus;"</span>, <span class="string">"&amp;#8853;"</span><span class="comment">/* circled plus = direct sum */</span>, <span class="string">"\u2295"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;otimes;"</span>, <span class="string">"&amp;#8855;"</span><span class="comment">/* circled times = vector product */</span>,</span><br><span class="line">						<span class="string">"\u2297"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;perp;"</span>,</span><br><span class="line">						<span class="string">"&amp;#8869;"</span><span class="comment">/* up tack = orthogonal to = perpendicular */</span>,</span><br><span class="line">						<span class="string">"\u22A5"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sdot;"</span>, <span class="string">"&amp;#8901;"</span><span class="comment">/* dot operator */</span>, <span class="string">"\u22C5"</span> &#125;</span><br><span class="line">				<span class="comment">/*</span><br><span class="line">				 * dot operator is NOT the same character as ,"\u00B7"&#125; /*</span><br><span class="line">				 * Miscellaneous Technical</span><br><span class="line">				 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;lceil;"</span>, <span class="string">"&amp;#8968;"</span><span class="comment">/* left ceiling = apl upstile */</span>, <span class="string">"\u2308"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rceil;"</span>, <span class="string">"&amp;#8969;"</span><span class="comment">/* right ceiling */</span>, <span class="string">"\u2309"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lfloor;"</span>, <span class="string">"&amp;#8970;"</span><span class="comment">/* left floor = apl downstile */</span>,</span><br><span class="line">						<span class="string">"\u230A"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rfloor;"</span>, <span class="string">"&amp;#8971;"</span><span class="comment">/* right floor */</span>, <span class="string">"\u230B"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lang;"</span>, <span class="string">"&amp;#9001;"</span><span class="comment">/* left-pointing angle bracket = bra */</span>,</span><br><span class="line">						<span class="string">"\u2329"</span> &#125;</span><br><span class="line">				<span class="comment">/* lang is NOT the same character as ,"\u003C"&#125; */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;rang;"</span>, <span class="string">"&amp;#9002;"</span><span class="comment">/* right-pointing angle bracket = ket */</span>,</span><br><span class="line">						<span class="string">"\u232A"</span> &#125;</span><br><span class="line">				<span class="comment">/* rang is NOT the same character as ,"\u003E"&#125; */</span></span><br><span class="line">				<span class="comment">/* Geometric Shapes */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;loz;"</span>, <span class="string">"&amp;#9674;"</span><span class="comment">/* lozenge */</span>, <span class="string">"\u25CA"</span> &#125;</span><br><span class="line">				<span class="comment">/* Miscellaneous Symbols */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;spades;"</span>, <span class="string">"&amp;#9824;"</span><span class="comment">/* black spade suit */</span>, <span class="string">"\u2660"</span> &#125;</span><br><span class="line">				<span class="comment">/* black here seems to mean filled as opposed to hollow */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;clubs;"</span>, <span class="string">"&amp;#9827;"</span><span class="comment">/* black club suit = shamrock */</span>, <span class="string">"\u2663"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;hearts;"</span>, <span class="string">"&amp;#9829;"</span><span class="comment">/* black heart suit = valentine */</span>,</span><br><span class="line">						<span class="string">"\u2665"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;diams;"</span>, <span class="string">"&amp;#9830;"</span><span class="comment">/* black diamond suit */</span>, <span class="string">"\u2666"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;quot;"</span>, <span class="string">"&amp;#34;"</span> <span class="comment">/* quotation mark = APL quote */</span>, <span class="string">"\""</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;amp;"</span>, <span class="string">"&amp;#38;"</span> <span class="comment">/* ampersand */</span>, <span class="string">"\u0026"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lt;"</span>, <span class="string">"&amp;#60;"</span> <span class="comment">/* less-than sign */</span>, <span class="string">"\u003C"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;gt;"</span>, <span class="string">"&amp;#62;"</span> <span class="comment">/* greater-than sign */</span>, <span class="string">"\u003E"</span> &#125;</span><br><span class="line">				<span class="comment">/* Latin Extended-A */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;OElig;"</span>, <span class="string">"&amp;#338;"</span> <span class="comment">/* latin capital ligature OE */</span>, <span class="string">"\u0152"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;oelig;"</span>, <span class="string">"&amp;#339;"</span> <span class="comment">/* latin small ligature oe */</span>, <span class="string">"\u0153"</span> &#125;</span><br><span class="line">				<span class="comment">/*</span><br><span class="line">				 * ligature is a misnomer this is a separate character in some</span><br><span class="line">				 * languages</span><br><span class="line">				 */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;Scaron;"</span>,</span><br><span class="line">						<span class="string">"&amp;#352;"</span> <span class="comment">/* latin capital letter S with caron */</span>,</span><br><span class="line">						<span class="string">"\u0160"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;scaron;"</span>, <span class="string">"&amp;#353;"</span> <span class="comment">/* latin small letter s with caron */</span>,</span><br><span class="line">						<span class="string">"\u0161"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Yuml;"</span>,</span><br><span class="line">						<span class="string">"&amp;#376;"</span> <span class="comment">/* latin capital letter Y with diaeresis */</span>,</span><br><span class="line">						<span class="string">"\u0178"</span> &#125;</span><br><span class="line">				<span class="comment">/* Spacing Modifier Letters */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;circ;"</span>, <span class="string">"&amp;#710;"</span> <span class="comment">/* modifier letter circumflex accent */</span>,</span><br><span class="line">						<span class="string">"\u02C6"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;tilde;"</span>, <span class="string">"&amp;#732;"</span> <span class="comment">/* small tilde */</span>, <span class="string">"\u02DC"</span> &#125;</span><br><span class="line">				<span class="comment">/* General Punctuation */</span></span><br><span class="line">				,</span><br><span class="line">				&#123; <span class="string">"&amp;ensp;"</span>, <span class="string">"&amp;#8194;"</span><span class="comment">/* en space */</span>, <span class="string">"\u2002"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;emsp;"</span>, <span class="string">"&amp;#8195;"</span><span class="comment">/* em space */</span>, <span class="string">"\u2003"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;thinsp;"</span>, <span class="string">"&amp;#8201;"</span><span class="comment">/* thin space */</span>, <span class="string">"\u2009"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;zwnj;"</span>, <span class="string">"&amp;#8204;"</span><span class="comment">/* zero width non-joiner */</span>, <span class="string">"\u200C"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;zwj;"</span>, <span class="string">"&amp;#8205;"</span><span class="comment">/* zero width joiner */</span>, <span class="string">"\u200D"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lrm;"</span>, <span class="string">"&amp;#8206;"</span><span class="comment">/* left-to-right mark */</span>, <span class="string">"\u200E"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rlm;"</span>, <span class="string">"&amp;#8207;"</span><span class="comment">/* right-to-left mark */</span>, <span class="string">"\u200F"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ndash;"</span>, <span class="string">"&amp;#8211;"</span><span class="comment">/* en dash */</span>, <span class="string">"\u2013"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;mdash;"</span>, <span class="string">"&amp;#8212;"</span><span class="comment">/* em dash */</span>, <span class="string">"\u2014"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lsquo;"</span>, <span class="string">"&amp;#8216;"</span><span class="comment">/* left single quotation mark */</span>, <span class="string">"\u2018"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rsquo;"</span>, <span class="string">"&amp;#8217;"</span><span class="comment">/* right single quotation mark */</span>, <span class="string">"\u2019"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;sbquo;"</span>, <span class="string">"&amp;#8218;"</span><span class="comment">/* single low-9 quotation mark */</span>, <span class="string">"\u201A"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;ldquo;"</span>, <span class="string">"&amp;#8220;"</span><span class="comment">/* left double quotation mark */</span>, <span class="string">"\u201C"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;rdquo;"</span>, <span class="string">"&amp;#8221;"</span><span class="comment">/* right double quotation mark */</span>, <span class="string">"\u201D"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;bdquo;"</span>, <span class="string">"&amp;#8222;"</span><span class="comment">/* double low-9 quotation mark */</span>, <span class="string">"\u201E"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;dagger;"</span>, <span class="string">"&amp;#8224;"</span><span class="comment">/* dagger */</span>, <span class="string">"\u2020"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;Dagger;"</span>, <span class="string">"&amp;#8225;"</span><span class="comment">/* double dagger */</span>, <span class="string">"\u2021"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;permil;"</span>, <span class="string">"&amp;#8240;"</span><span class="comment">/* per mille sign */</span>, <span class="string">"\u2030"</span> &#125;,</span><br><span class="line">				&#123; <span class="string">"&amp;lsaquo;"</span>, <span class="string">"&amp;#8249;"</span><span class="comment">/*</span><br><span class="line">										 * single left-pointing angle quotation</span><br><span class="line">										 * mark</span><br><span class="line">										 */</span>, <span class="string">"\u2039"</span> &#125;</span><br><span class="line">				<span class="comment">/* lsaquo is proposed but not yet ISO standardized */</span></span><br><span class="line">				, &#123; <span class="string">"&amp;rsaquo;"</span>, <span class="string">"&amp;#8250;"</span><span class="comment">/*</span><br><span class="line">										 * single right-pointing angle quotation</span><br><span class="line">										 * mark</span><br><span class="line">										 */</span>, <span class="string">"\u203A"</span> &#125;</span><br><span class="line">				<span class="comment">/* rsaquo is proposed but not yet ISO standardized */</span></span><br><span class="line">				, &#123; <span class="string">"&amp;euro;"</span>, <span class="string">"&amp;#8364;"</span> <span class="comment">/* euro sign */</span>, <span class="string">"\u20AC"</span> &#125; &#125;;</span><br><span class="line">		<span class="keyword">for</span> (String[] entity : entities) &#123;</span><br><span class="line">			entityEscapeMap.put(entity[<span class="number">2</span>], entity[<span class="number">0</span>]);</span><br><span class="line">			escapeEntityMap.put(entity[<span class="number">0</span>], entity[<span class="number">2</span>]);</span><br><span class="line">			escapeEntityMap.put(entity[<span class="number">1</span>], entity[<span class="number">2</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HttpClient-java">HttpClient.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.MimetypesFileTypeMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.DefaultHttpMethodRetryHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.Header;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.HttpMethod;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.MultiThreadedHttpConnectionManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.UsernamePasswordCredentials;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.auth.AuthScope;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.cookie.CookiePolicy;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.DeleteMethod;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.GetMethod;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.PostMethod;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.multipart.FilePart;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.multipart.MultipartRequestEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.multipart.Part;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.multipart.PartBase;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.multipart.StringPart;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.params.HttpClientParams;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.params.HttpConnectionManagerParams;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.params.HttpMethodParams;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.protocol.Protocol;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.model.Configuration;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.MySSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.Paging;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.PostParameter;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.WeiboException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * @author sinaWeibo</span><br><span class="line"> * </span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class HttpClient implements java.io.Serializable &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">176092625883595547</span>L;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> OK = <span class="number">200</span>; <span class="comment">// OK: Success!</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> NOT_MODIFIED = <span class="number">304</span>; <span class="comment">// Not Modified: There was no</span></span><br><span class="line">													<span class="comment">// new data to return.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> BAD_REQUEST = <span class="number">400</span>; <span class="comment">// Bad Request: The request was</span></span><br><span class="line">												<span class="comment">// invalid. An accompanying</span></span><br><span class="line">												<span class="comment">// error message will explain</span></span><br><span class="line">												<span class="comment">// why. This is the status code</span></span><br><span class="line">												<span class="comment">// will be returned during rate</span></span><br><span class="line">												<span class="comment">// limiting.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> NOT_AUTHORIZED = <span class="number">401</span>; <span class="comment">// Not Authorized:</span></span><br><span class="line">													<span class="comment">// Authentication</span></span><br><span class="line">													<span class="comment">// credentials were missing</span></span><br><span class="line">													<span class="comment">// or incorrect.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> FORBIDDEN = <span class="number">403</span>; <span class="comment">// Forbidden: The request is</span></span><br><span class="line">												<span class="comment">// understood, but it has been</span></span><br><span class="line">												<span class="comment">// refused. An accompanying</span></span><br><span class="line">												<span class="comment">// error message will explain</span></span><br><span class="line">												<span class="comment">// why.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> NOT_FOUND = <span class="number">404</span>; <span class="comment">// Not Found: The URI requested is</span></span><br><span class="line">												<span class="comment">// invalid or the resource</span></span><br><span class="line">												<span class="comment">// requested, such as a user,</span></span><br><span class="line">												<span class="comment">// does not exists.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> NOT_ACCEPTABLE = <span class="number">406</span>; <span class="comment">// Not Acceptable: Returned</span></span><br><span class="line">													<span class="comment">// by the Search API when an</span></span><br><span class="line">													<span class="comment">// invalid format is</span></span><br><span class="line">													<span class="comment">// specified in the request.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> INTERNAL_SERVER_ERROR = <span class="number">500</span>;<span class="comment">// Internal Server</span></span><br><span class="line">															<span class="comment">// Error: Something</span></span><br><span class="line">															<span class="comment">// is broken. Please</span></span><br><span class="line">															<span class="comment">// post to the group</span></span><br><span class="line">															<span class="comment">// so the Weibo team</span></span><br><span class="line">															<span class="comment">// can investigate.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> BAD_GATEWAY = <span class="number">502</span>;<span class="comment">// Bad Gateway: Weibo is down or</span></span><br><span class="line">												<span class="comment">// being upgraded.</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> SERVICE_UNAVAILABLE = <span class="number">503</span>;<span class="comment">// Service Unavailable:</span></span><br><span class="line">														<span class="comment">// The Weibo servers are</span></span><br><span class="line">														<span class="comment">// up, but overloaded</span></span><br><span class="line">														<span class="comment">// with requests. Try</span></span><br><span class="line">														<span class="comment">// again later. The</span></span><br><span class="line">														<span class="comment">// search and trend</span></span><br><span class="line">														<span class="comment">// methods use this to</span></span><br><span class="line">														<span class="comment">// indicate when you are</span></span><br><span class="line">														<span class="comment">// being rate limited.</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> proxyHost = Configuration.getProxyHost();</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">int</span> proxyPort = Configuration.getProxyPort();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> proxyAuthUser = Configuration.getProxyUser();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> proxyAuthPassword = Configuration.getProxyPassword();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> token;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getProxyHost() &#123;</span><br><span class="line">		<span class="keyword">return</span> proxyHost;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Sets proxy host. System property -Dsinat4j.http.proxyHost or</span><br><span class="line">	 * http.proxyHost overrides this attribute.</span><br><span class="line">	 * </span><br><span class="line">	 * @param proxyHost</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setProxyHost(<span class="keyword">String</span> proxyHost) &#123;</span><br><span class="line">		<span class="keyword">this</span>.proxyHost = Configuration.getProxyHost(proxyHost);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> getProxyPort() &#123;</span><br><span class="line">		<span class="keyword">return</span> proxyPort;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Sets proxy port. System property -Dsinat4j.http.proxyPort or</span><br><span class="line">	 * -Dhttp.proxyPort overrides this attribute.</span><br><span class="line">	 * </span><br><span class="line">	 * @param proxyPort</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setProxyPort(<span class="built_in">int</span> proxyPort) &#123;</span><br><span class="line">		<span class="keyword">this</span>.proxyPort = Configuration.getProxyPort(proxyPort);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getProxyAuthUser() &#123;</span><br><span class="line">		<span class="keyword">return</span> proxyAuthUser;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Sets proxy authentication user. System property -Dsinat4j.http.proxyUser</span><br><span class="line">	 * overrides this attribute.</span><br><span class="line">	 * </span><br><span class="line">	 * @param proxyAuthUser</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setProxyAuthUser(<span class="keyword">String</span> proxyAuthUser) &#123;</span><br><span class="line">		<span class="keyword">this</span>.proxyAuthUser = Configuration.getProxyUser(proxyAuthUser);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getProxyAuthPassword() &#123;</span><br><span class="line">		<span class="keyword">return</span> proxyAuthPassword;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Sets proxy authentication password. System property</span><br><span class="line">	 * -Dsinat4j.http.proxyPassword overrides this attribute.</span><br><span class="line">	 * </span><br><span class="line">	 * @param proxyAuthPassword</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setProxyAuthPassword(<span class="keyword">String</span> proxyAuthPassword) &#123;</span><br><span class="line">		<span class="keyword">this</span>.proxyAuthPassword = Configuration</span><br><span class="line">				.getProxyPassword(proxyAuthPassword);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> setToken(<span class="keyword">String</span> token) &#123;</span><br><span class="line">		<span class="keyword">this</span>.token = token;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.token;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="built_in">boolean</span> DEBUG = Configuration.getDebug();</span><br><span class="line">	<span class="keyword">static</span> Logger <span class="built_in">log</span> = Logger.getLogger(HttpClient.class.getName());</span><br><span class="line">	org.apache.commons.httpclient.HttpClient client = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> MultiThreadedHttpConnectionManager connectionManager;</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">int</span> maxSize;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> HttpClient() &#123;</span><br><span class="line">		<span class="keyword">this</span>(<span class="number">150</span>, <span class="number">30000</span>, <span class="number">30000</span>, <span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> HttpClient(<span class="built_in">int</span> maxConPerHost, <span class="built_in">int</span> conTimeOutMs, <span class="built_in">int</span> soTimeOutMs,</span><br><span class="line">			<span class="built_in">int</span> maxSize) &#123;</span><br><span class="line">		connectionManager = <span class="keyword">new</span> MultiThreadedHttpConnectionManager();</span><br><span class="line">		HttpConnectionManagerParams params = connectionManager.getParams();</span><br><span class="line">		params.setDefaultMaxConnectionsPerHost(maxConPerHost);</span><br><span class="line">		params.setConnectionTimeout(conTimeOutMs);</span><br><span class="line">		params.setSoTimeout(soTimeOutMs);</span><br><span class="line"></span><br><span class="line">		HttpClientParams clientParams = <span class="keyword">new</span> HttpClientParams();</span><br><span class="line">		<span class="comment">// 忽略cookie 避免 Cookie rejected 警告</span></span><br><span class="line">		clientParams.setCookiePolicy(CookiePolicy.IGNORE_COOKIES);</span><br><span class="line">		client = <span class="keyword">new</span> org.apache.commons.httpclient.HttpClient(clientParams,</span><br><span class="line">				connectionManager);</span><br><span class="line">		Protocol myhttps = <span class="keyword">new</span> Protocol(<span class="string">"https"</span>, <span class="keyword">new</span> MySSLSocketFactory(), <span class="number">443</span>);</span><br><span class="line">		Protocol.registerProtocol(<span class="string">"https"</span>, myhttps);</span><br><span class="line">		<span class="keyword">this</span>.maxSize = maxSize;</span><br><span class="line">		<span class="comment">// 支持proxy</span></span><br><span class="line">		<span class="keyword">if</span> (proxyHost != <span class="keyword">null</span> &amp;&amp; !proxyHost.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">			client.getHostConfiguration().setProxy(proxyHost, proxyPort);</span><br><span class="line">			client.getParams().setAuthenticationPreemptive(<span class="keyword">true</span>);</span><br><span class="line">			<span class="keyword">if</span> (proxyAuthUser != <span class="keyword">null</span> &amp;&amp; !proxyAuthUser.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">				client.getState().setProxyCredentials(</span><br><span class="line">						AuthScope.ANY,</span><br><span class="line">						<span class="keyword">new</span> UsernamePasswordCredentials(proxyAuthUser,</span><br><span class="line">								proxyAuthPassword));</span><br><span class="line">				<span class="built_in">log</span>(<span class="string">"Proxy AuthUser: "</span> + proxyAuthUser);</span><br><span class="line">				<span class="built_in">log</span>(<span class="string">"Proxy AuthPassword: "</span> + proxyAuthPassword);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * log调试</span><br><span class="line">	 * </span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="built_in">log</span>(<span class="keyword">String</span> message) &#123;</span><br><span class="line">		<span class="keyword">if</span> (DEBUG) &#123;</span><br><span class="line">			<span class="built_in">log</span>.debug(message);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 处理http getmethod 请求</span><br><span class="line">	 * </span><br><span class="line">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response <span class="built_in">get</span>(<span class="keyword">String</span> url) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">get</span>(url, <span class="keyword">new</span> PostParameter[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response <span class="built_in">get</span>(<span class="keyword">String</span> url, PostParameter[] params)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Request:"</span>);</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"GET:"</span> + url);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != params &amp;&amp; params.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">String</span> encodedParams = HttpClient.encodeParameters(params);</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> == url.indexOf(<span class="string">"?"</span>)) &#123;</span><br><span class="line">				url += <span class="string">"?"</span> + encodedParams;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				url += <span class="string">"&amp;"</span> + encodedParams;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		GetMethod getmethod = <span class="keyword">new</span> GetMethod(url);</span><br><span class="line">		<span class="keyword">return</span> httpRequest(getmethod);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response <span class="built_in">get</span>(<span class="keyword">String</span> url, PostParameter[] params, Paging paging)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != paging) &#123;</span><br><span class="line">			List&lt;PostParameter&gt; pagingParams = <span class="keyword">new</span> ArrayList&lt;PostParameter&gt;(<span class="number">4</span>);</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> != paging.getMaxId()) &#123;</span><br><span class="line">				pagingParams.<span class="built_in">add</span>(<span class="keyword">new</span> PostParameter(<span class="string">"max_id"</span>, <span class="keyword">String</span></span><br><span class="line">						.valueOf(paging.getMaxId())));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> != paging.getSinceId()) &#123;</span><br><span class="line">				pagingParams.<span class="built_in">add</span>(<span class="keyword">new</span> PostParameter(<span class="string">"since_id"</span>, <span class="keyword">String</span></span><br><span class="line">						.valueOf(paging.getSinceId())));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> != paging.getPage()) &#123;</span><br><span class="line">				pagingParams.<span class="built_in">add</span>(<span class="keyword">new</span> PostParameter(<span class="string">"page"</span>, <span class="keyword">String</span></span><br><span class="line">						.valueOf(paging.getPage())));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> != paging.getCount()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (-<span class="number">1</span> != url.indexOf(<span class="string">"search"</span>)) &#123;</span><br><span class="line">					<span class="comment">// search api takes "rpp"</span></span><br><span class="line">					pagingParams.<span class="built_in">add</span>(<span class="keyword">new</span> PostParameter(<span class="string">"rpp"</span>, <span class="keyword">String</span></span><br><span class="line">							.valueOf(paging.getCount())));</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					pagingParams.<span class="built_in">add</span>(<span class="keyword">new</span> PostParameter(<span class="string">"count"</span>, <span class="keyword">String</span></span><br><span class="line">							.valueOf(paging.getCount())));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			PostParameter[] newparams = <span class="keyword">null</span>;</span><br><span class="line">			PostParameter[] arrayPagingParams = pagingParams</span><br><span class="line">					.toArray(<span class="keyword">new</span> PostParameter[pagingParams.<span class="built_in">size</span>()]);</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> != params) &#123;</span><br><span class="line">				newparams = <span class="keyword">new</span> PostParameter[params.length</span><br><span class="line">						+ pagingParams.<span class="built_in">size</span>()];</span><br><span class="line">				System.arraycopy(params, <span class="number">0</span>, newparams, <span class="number">0</span>, params.length);</span><br><span class="line">				System.arraycopy(arrayPagingParams, <span class="number">0</span>, newparams,</span><br><span class="line">						params.length, pagingParams.<span class="built_in">size</span>());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="number">0</span> != arrayPagingParams.length) &#123;</span><br><span class="line">					<span class="keyword">String</span> encodedParams = HttpClient</span><br><span class="line">							.encodeParameters(arrayPagingParams);</span><br><span class="line">					<span class="keyword">if</span> (-<span class="number">1</span> != url.indexOf(<span class="string">"?"</span>)) &#123;</span><br><span class="line">						url += <span class="string">"&amp;"</span> + encodedParams;</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						url += <span class="string">"?"</span> + encodedParams;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">get</span>(url, newparams);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">get</span>(url, params);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 处理http deletemethod请求</span><br><span class="line">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response delete(<span class="keyword">String</span> url, PostParameter[] params)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> != params.length) &#123;</span><br><span class="line">			<span class="keyword">String</span> encodedParams = HttpClient.encodeParameters(params);</span><br><span class="line">			<span class="keyword">if</span> (-<span class="number">1</span> == url.indexOf(<span class="string">"?"</span>)) &#123;</span><br><span class="line">				url += <span class="string">"?"</span> + encodedParams;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				url += <span class="string">"&amp;"</span> + encodedParams;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		DeleteMethod deleteMethod = <span class="keyword">new</span> DeleteMethod(url);</span><br><span class="line">		<span class="keyword">return</span> httpRequest(deleteMethod);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 处理http post请求</span><br><span class="line">	 * </span><br><span class="line">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response post(<span class="keyword">String</span> url, PostParameter[] params)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">return</span> post(url, params, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response post(<span class="keyword">String</span> url, PostParameter[] params,</span><br><span class="line">			Boolean WithTokenHeader) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"Request:"</span>);</span><br><span class="line">		<span class="built_in">log</span>(<span class="string">"POST"</span> + url);</span><br><span class="line">		PostMethod postMethod = <span class="keyword">new</span> PostMethod(url);</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">			postMethod.addParameter(params[i].getName(), params[i].getValue());</span><br><span class="line">		&#125;</span><br><span class="line">		HttpMethodParams param = postMethod.getParams();</span><br><span class="line">		param.setContentCharset(<span class="string">"UTF-8"</span>);</span><br><span class="line">		<span class="keyword">if</span> (WithTokenHeader) &#123;</span><br><span class="line">			<span class="keyword">return</span> httpRequest(postMethod);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> httpRequest(postMethod, WithTokenHeader);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 支持multipart方式上传图片</span><br><span class="line">	 * </span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Response multPartURL(<span class="keyword">String</span> url, PostParameter[] params,</span><br><span class="line">			ImageItem item) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		PostMethod postMethod = <span class="keyword">new</span> PostMethod(url);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Part[] parts = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">if</span> (params == <span class="keyword">null</span>) &#123;</span><br><span class="line">				parts = <span class="keyword">new</span> Part[<span class="number">1</span>];</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				parts = <span class="keyword">new</span> Part[params.length + <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (params != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span> (PostParameter entry : params) &#123;</span><br><span class="line">					parts[i++] = <span class="keyword">new</span> StringPart(entry.getName(),</span><br><span class="line">							(<span class="keyword">String</span>) entry.getValue());</span><br><span class="line">				&#125;</span><br><span class="line">				parts[parts.length - <span class="number">1</span>] = <span class="keyword">new</span> ByteArrayPart(item.getContent(),</span><br><span class="line">						item.getName(), item.getContentType());</span><br><span class="line">			&#125;</span><br><span class="line">			postMethod.setRequestEntity(<span class="keyword">new</span> MultipartRequestEntity(parts,</span><br><span class="line">					postMethod.getParams()));</span><br><span class="line">			<span class="keyword">return</span> httpRequest(postMethod);</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(ex.getMessage(), ex, -<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response multPartURL(<span class="keyword">String</span> fileParamName, <span class="keyword">String</span> url,</span><br><span class="line">			PostParameter[] params, File file, <span class="built_in">boolean</span> authenticated)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		PostMethod postMethod = <span class="keyword">new</span> PostMethod(url);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Part[] parts = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">if</span> (params == <span class="keyword">null</span>) &#123;</span><br><span class="line">				parts = <span class="keyword">new</span> Part[<span class="number">1</span>];</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				parts = <span class="keyword">new</span> Part[params.length + <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (params != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span> (PostParameter entry : params) &#123;</span><br><span class="line">					parts[i++] = <span class="keyword">new</span> StringPart(entry.getName(),</span><br><span class="line">							(<span class="keyword">String</span>) entry.getValue());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			FilePart filePart = <span class="keyword">new</span> FilePart(fileParamName, file.getName(),</span><br><span class="line">					file, <span class="keyword">new</span> MimetypesFileTypeMap().getContentType(file),</span><br><span class="line">					<span class="string">"UTF-8"</span>);</span><br><span class="line">			filePart.setTransferEncoding(<span class="string">"binary"</span>);</span><br><span class="line">			parts[parts.length - <span class="number">1</span>] = filePart;</span><br><span class="line"></span><br><span class="line">			postMethod.setRequestEntity(<span class="keyword">new</span> MultipartRequestEntity(parts,</span><br><span class="line">					postMethod.getParams()));</span><br><span class="line">			<span class="keyword">return</span> httpRequest(postMethod);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(ex.getMessage(), ex, -<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response httpRequest(HttpMethod method) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">return</span> httpRequest(method, <span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response httpRequest(HttpMethod method, Boolean WithTokenHeader)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		InetAddress ipaddr;</span><br><span class="line">		<span class="built_in">int</span> responseCode = -<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			ipaddr = InetAddress.getLocalHost();</span><br><span class="line">			List&lt;Header&gt; headers = <span class="keyword">new</span> ArrayList&lt;Header&gt;();</span><br><span class="line">			<span class="keyword">if</span> (WithTokenHeader) &#123;</span><br><span class="line">				<span class="keyword">if</span> (token == <span class="keyword">null</span>) &#123;</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Oauth2 token is not set!"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				headers.<span class="built_in">add</span>(<span class="keyword">new</span> Header(<span class="string">"Authorization"</span>, <span class="string">"OAuth2 "</span> + token));</span><br><span class="line">				headers.<span class="built_in">add</span>(<span class="keyword">new</span> Header(<span class="string">"API-RemoteIP"</span>, ipaddr.getHostAddress()));</span><br><span class="line">				client.getHostConfiguration().getParams()</span><br><span class="line">						.setParameter(<span class="string">"http.default-headers"</span>, headers);</span><br><span class="line">				<span class="keyword">for</span> (Header hd : headers) &#123;</span><br><span class="line">					<span class="built_in">log</span>(hd.getName() + <span class="string">": "</span> + hd.getValue());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			method.getParams().setParameter(HttpMethodParams.RETRY_HANDLER,</span><br><span class="line">					<span class="keyword">new</span> DefaultHttpMethodRetryHandler(<span class="number">3</span>, <span class="keyword">false</span>));</span><br><span class="line">			client.executeMethod(method);</span><br><span class="line">			Header[] resHeader = method.getResponseHeaders();</span><br><span class="line">			responseCode = method.getStatusCode();</span><br><span class="line">			<span class="built_in">log</span>(<span class="string">"Response:"</span>);</span><br><span class="line">			<span class="built_in">log</span>(<span class="string">"https StatusCode:"</span> + <span class="keyword">String</span>.valueOf(responseCode));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (Header header : resHeader) &#123;</span><br><span class="line">				<span class="built_in">log</span>(header.getName() + <span class="string">":"</span> + header.getValue());</span><br><span class="line">			&#125;</span><br><span class="line">			Response response = <span class="keyword">new</span> Response();</span><br><span class="line">			response.setResponseAsString(method.getResponseBodyAsString());</span><br><span class="line">			<span class="built_in">log</span>(response.toString() + <span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (responseCode != OK)</span><br><span class="line"></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(getCause(responseCode),</span><br><span class="line">							response.asJSONObject(), method.getStatusCode());</span><br><span class="line">				&#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> response;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(ioe.getMessage(), ioe, responseCode);</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			method.releaseConnection();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span><br><span class="line">	 * 对parameters进行encode处理</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> encodeParameters(PostParameter[] postParams) &#123;</span><br><span class="line">		StringBuffer buf = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; postParams.length; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (j != <span class="number">0</span>) &#123;</span><br><span class="line">				buf.<span class="built_in">append</span>(<span class="string">"&amp;"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				buf.<span class="built_in">append</span>(URLEncoder.encode(postParams[j].getName(), <span class="string">"UTF-8"</span>))</span><br><span class="line">						.<span class="built_in">append</span>(<span class="string">"="</span>)</span><br><span class="line">						.<span class="built_in">append</span>(URLEncoder.encode(postParams[j].getValue(),</span><br><span class="line">								<span class="string">"UTF-8"</span>));</span><br><span class="line">			&#125; <span class="keyword">catch</span> (java.io.UnsupportedEncodingException neverHappen) &#123;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> buf.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> class ByteArrayPart extends PartBase &#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="built_in">byte</span>[] mData;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">String</span> mName;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> ByteArrayPart(<span class="built_in">byte</span>[] data, <span class="keyword">String</span> name, <span class="keyword">String</span> type)</span><br><span class="line">				<span class="keyword">throws</span> IOException &#123;</span><br><span class="line">			<span class="keyword">super</span>(name, type, <span class="string">"UTF-8"</span>, <span class="string">"binary"</span>);</span><br><span class="line">			mName = name;</span><br><span class="line">			mData = data;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">void</span> sendData(OutputStream out) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">			out.write(mData);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">long</span> lengthOfData() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">			<span class="keyword">return</span> mData.length;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">void</span> sendDispositionHeader(OutputStream out)</span><br><span class="line">				<span class="keyword">throws</span> IOException &#123;</span><br><span class="line">			<span class="keyword">super</span>.sendDispositionHeader(out);</span><br><span class="line">			StringBuilder buf = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">			buf.<span class="built_in">append</span>(<span class="string">"; filename=\""</span>).<span class="built_in">append</span>(mName).<span class="built_in">append</span>(<span class="string">"\""</span>);</span><br><span class="line">			out.write(buf.toString().getBytes());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span> getCause(<span class="built_in">int</span> statusCode) &#123;</span><br><span class="line">		<span class="keyword">String</span> cause = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">switch</span> (statusCode) &#123;</span><br><span class="line">		<span class="keyword">case</span> NOT_MODIFIED:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> BAD_REQUEST:</span><br><span class="line">			cause = <span class="string">"The request was invalid.  An accompanying error message will explain why. This is the status code will be returned during rate limiting."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> NOT_AUTHORIZED:</span><br><span class="line">			cause = <span class="string">"Authentication credentials were missing or incorrect."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> FORBIDDEN:</span><br><span class="line">			cause = <span class="string">"The request is understood, but it has been refused.  An accompanying error message will explain why."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> NOT_FOUND:</span><br><span class="line">			cause = <span class="string">"The URI requested is invalid or the resource requested, such as a user, does not exists."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> NOT_ACCEPTABLE:</span><br><span class="line">			cause = <span class="string">"Returned by the Search API when an invalid format is specified in the request."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> INTERNAL_SERVER_ERROR:</span><br><span class="line">			cause = <span class="string">"Something is broken.  Please post to the group so the Weibo team can investigate."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> BAD_GATEWAY:</span><br><span class="line">			cause = <span class="string">"Weibo is down or being upgraded."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> SERVICE_UNAVAILABLE:</span><br><span class="line">			cause = <span class="string">"Service Unavailable: The Weibo servers are up, but overloaded with requests. Try again later. The search and trend methods use this to indicate when you are being rate limited."</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			cause = <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> statusCode + <span class="string">":"</span> + cause;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getToken() &#123;</span><br><span class="line">		<span class="keyword">return</span> token;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ImageItem-java">ImageItem.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageReader;</span><br><span class="line"><span class="keyword">import</span> javax.imageio.stream.MemoryCacheImageInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.model.Constants;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.WeiboException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.imageio.plugins.bmp.BMPImageReader;</span><br><span class="line"><span class="keyword">import</span> com.sun.imageio.plugins.gif.GIFImageReader;</span><br><span class="line"><span class="keyword">import</span> com.sun.imageio.plugins.jpeg.JPEGImageReader;</span><br><span class="line"><span class="keyword">import</span> com.sun.imageio.plugins.png.PNGImageReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 临时存储上传图片的内容，格式，文件信息等</span><br><span class="line"> * </span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class ImageItem &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">byte</span>[] content;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> contentType;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> ImageItem(<span class="built_in">byte</span>[] content) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">this</span>(Constants.UPLOAD_MODE, content);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> ImageItem(<span class="keyword">String</span> name, <span class="built_in">byte</span>[] content) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">String</span> imgtype = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			imgtype = getContentType(content);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(e);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (imgtype != <span class="keyword">null</span></span><br><span class="line">				&amp;&amp; (imgtype.equalsIgnoreCase(<span class="string">"image/gif"</span>)</span><br><span class="line">						|| imgtype.equalsIgnoreCase(<span class="string">"image/png"</span>) || imgtype</span><br><span class="line">							.equalsIgnoreCase(<span class="string">"image/jpeg"</span>))) &#123;</span><br><span class="line">			<span class="keyword">this</span>.content = content;</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">			<span class="keyword">this</span>.contentType = imgtype;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">					<span class="string">"Unsupported image type, Only Suport JPG ,GIF,PNG!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">byte</span>[] getContent() &#123;</span><br><span class="line">		<span class="keyword">return</span> content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getName() &#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getContentType() &#123;</span><br><span class="line">		<span class="keyword">return</span> contentType;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getContentType(<span class="built_in">byte</span>[] mapObj) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> type = <span class="string">""</span>;</span><br><span class="line">		ByteArrayInputStream bais = <span class="keyword">null</span>;</span><br><span class="line">		MemoryCacheImageInputStream mcis = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bais = <span class="keyword">new</span> ByteArrayInputStream(mapObj);</span><br><span class="line">			mcis = <span class="keyword">new</span> MemoryCacheImageInputStream(bais);</span><br><span class="line">			Iterator itr = ImageIO.getImageReaders(mcis);</span><br><span class="line">			<span class="keyword">while</span> (itr.hasNext()) &#123;</span><br><span class="line">				ImageReader reader = (ImageReader) itr.next();</span><br><span class="line">				<span class="keyword">if</span> (reader <span class="keyword">instanceof</span> GIFImageReader) &#123;</span><br><span class="line">					type = <span class="string">"image/gif"</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (reader <span class="keyword">instanceof</span> JPEGImageReader) &#123;</span><br><span class="line">					type = <span class="string">"image/jpeg"</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (reader <span class="keyword">instanceof</span> PNGImageReader) &#123;</span><br><span class="line">					type = <span class="string">"image/png"</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (reader <span class="keyword">instanceof</span> BMPImageReader) &#123;</span><br><span class="line">					type = <span class="string">"application/x-bmp"</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (bais != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					bais.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (mcis != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					mcis.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> type;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Response-java">Response.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">BufferedReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilder;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.model.Configuration;</span><br><span class="line"><span class="keyword">import</span> weibo4j.model.WeiboException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="keyword">JSONArray</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="keyword">JSONObject</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * A data class representing HTTP Response</span><br><span class="line"> * </span><br><span class="line"> * @author Yusuke Yamamoto - yusuke at mac.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class Response &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="built_in">boolean</span> DEBUG = Configuration.getDebug();</span><br><span class="line">	<span class="keyword">static</span> Logger <span class="built_in">log</span> = Logger.getLogger(Response.class.getName());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;DocumentBuilder&gt; builders = <span class="keyword">new</span> ThreadLocal&lt;DocumentBuilder&gt;() &#123;</span><br><span class="line">		@Override</span><br><span class="line">		<span class="keyword">protected</span> DocumentBuilder initialValue() &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> DocumentBuilderFactory.newInstance()</span><br><span class="line">						.newDocumentBuilder();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (ParserConfigurationException ex) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(ex);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">int</span> statusCode;</span><br><span class="line">	<span class="keyword">private</span> Document responseAsDocument = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> responseAsString = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> InputStream is;</span><br><span class="line">	<span class="keyword">private</span> HttpURLConnection con;</span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">boolean</span> streamConsumed = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response() &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Response(HttpURLConnection con) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		<span class="keyword">this</span>.con = con;</span><br><span class="line">		<span class="keyword">this</span>.statusCode = con.getResponseCode();</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == (is = con.getErrorStream())) &#123;</span><br><span class="line">			is = con.getInputStream();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != is &amp;&amp; <span class="string">"gzip"</span>.equals(con.getContentEncoding())) &#123;</span><br><span class="line">			<span class="comment">// the response is gzipped</span></span><br><span class="line">			is = <span class="keyword">new</span> GZIPInputStream(is);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// for test purpose</span></span><br><span class="line">	<span class="comment">/* package */</span>Response(<span class="keyword">String</span> content) &#123;</span><br><span class="line">		<span class="keyword">this</span>.responseAsString = content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> getStatusCode() &#123;</span><br><span class="line">		<span class="keyword">return</span> statusCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getResponseHeader(<span class="keyword">String</span> name) &#123;</span><br><span class="line">		<span class="keyword">if</span> (con != <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> con.getHeaderField(name);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Returns the response stream.&lt;br&gt;</span><br><span class="line">	 * This method cannot be called after calling asString() or asDcoument()&lt;br&gt;</span><br><span class="line">	 * It is suggested to call disconnect() after consuming the stream.</span><br><span class="line">	 * </span><br><span class="line">	 * Disconnects the internal HttpURLConnection silently.</span><br><span class="line">	 * </span><br><span class="line">	 * @return response body stream</span><br><span class="line">	 * @throws WeiboException</span><br><span class="line">	 * @see #disconnect()</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> InputStream asStream() &#123;</span><br><span class="line">		<span class="keyword">if</span> (streamConsumed) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Stream has already been consumed."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> is;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Returns the response body as string.&lt;br&gt;</span><br><span class="line">	 * Disconnects the internal HttpURLConnection silently.</span><br><span class="line">	 * </span><br><span class="line">	 * @return response body</span><br><span class="line">	 * @throws WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> asString() <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == responseAsString) &#123;</span><br><span class="line">			<span class="keyword">BufferedReader</span> br;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				InputStream stream = asStream();</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">null</span> == stream) &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				br = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(<span class="keyword">new</span> InputStreamReader(stream, <span class="string">"UTF-8"</span>));</span><br><span class="line">				StringBuffer buf = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">				<span class="keyword">String</span> <span class="built_in">line</span>;</span><br><span class="line">				<span class="keyword">while</span> (<span class="keyword">null</span> != (<span class="built_in">line</span> = br.readLine())) &#123;</span><br><span class="line">					buf.<span class="built_in">append</span>(<span class="built_in">line</span>).<span class="built_in">append</span>(<span class="string">"\n"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">this</span>.responseAsString = buf.toString();</span><br><span class="line">				<span class="keyword">if</span> (Configuration.isDalvik()) &#123;</span><br><span class="line">					<span class="keyword">this</span>.responseAsString = unescape(responseAsString);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">log</span>(responseAsString);</span><br><span class="line">				stream.close();</span><br><span class="line">				con.disconnect();</span><br><span class="line">				streamConsumed = <span class="keyword">true</span>;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (NullPointerException npe) &#123;</span><br><span class="line">				<span class="comment">// don't remember in which case npe can be thrown</span></span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(npe.getMessage(), npe);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(ioe.getMessage(), ioe);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> responseAsString;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Returns the response body as org.w3c.dom.Document.&lt;br&gt;</span><br><span class="line">	 * Disconnects the internal HttpURLConnection silently.</span><br><span class="line">	 * </span><br><span class="line">	 * @return response body as org.w3c.dom.Document</span><br><span class="line">	 * @throws WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Document asDocument() <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == responseAsDocument) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">// it should be faster to read the inputstream directly.</span></span><br><span class="line">				<span class="comment">// but makes it difficult to troubleshoot</span></span><br><span class="line">				<span class="keyword">this</span>.responseAsDocument = builders.<span class="built_in">get</span>().parse(</span><br><span class="line">						<span class="keyword">new</span> ByteArrayInputStream(asString().getBytes(<span class="string">"UTF-8"</span>)));</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SAXException saxe) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">						<span class="string">"The response body was not well-formed:\n"</span></span><br><span class="line">								+ responseAsString, saxe);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">						<span class="string">"There's something with the connection."</span>, ioe);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> responseAsDocument;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Returns the response body as sinat4j.org.json.JSONObject.&lt;br&gt;</span><br><span class="line">	 * Disconnects the internal HttpURLConnection silently.</span><br><span class="line">	 * </span><br><span class="line">	 * @return response body as sinat4j.org.json.JSONObject</span><br><span class="line">	 * @throws WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> asJSONObject() <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONObject</span>(asString());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone.getMessage() + <span class="string">":"</span></span><br><span class="line">					+ <span class="keyword">this</span>.responseAsString, jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Returns the response body as sinat4j.org.json.JSONArray.&lt;br&gt;</span><br><span class="line">	 * Disconnects the internal HttpURLConnection silently.</span><br><span class="line">	 * </span><br><span class="line">	 * @return response body as sinat4j.org.json.JSONArray</span><br><span class="line">	 * @throws WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONArray</span> asJSONArray() <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONArray</span>(asString());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone.getMessage() + <span class="string">":"</span></span><br><span class="line">					+ <span class="keyword">this</span>.responseAsString, jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> InputStreamReader asReader() &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> InputStreamReader(is, <span class="string">"UTF-8"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (java.io.UnsupportedEncodingException uee) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> InputStreamReader(is);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> disconnect() &#123;</span><br><span class="line">		con.disconnect();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Pattern escaped = Pattern.compile(<span class="string">"&amp;#([0-9]&#123;3,5&#125;);"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Unescape UTF-8 escaped characters to string.</span><br><span class="line">	 * </span><br><span class="line">	 * @author pengjianq...@gmail.com</span><br><span class="line">	 * </span><br><span class="line">	 * @param original</span><br><span class="line">	 *            The string to be unescaped.</span><br><span class="line">	 * @return The unescaped string</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> unescape(<span class="keyword">String</span> original) &#123;</span><br><span class="line">		Matcher mm = escaped.matcher(original);</span><br><span class="line">		StringBuffer unescaped = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">while</span> (mm.find()) &#123;</span><br><span class="line">			mm.appendReplacement(unescaped, Character.toString((<span class="built_in">char</span>) Integer</span><br><span class="line">					.parseInt(mm.group(<span class="number">1</span>), <span class="number">10</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">		mm.appendTail(unescaped);</span><br><span class="line">		<span class="keyword">return</span> unescaped.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != responseAsString) &#123;</span><br><span class="line">			<span class="keyword">return</span> responseAsString;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Response&#123;"</span> + <span class="string">"statusCode="</span> + statusCode + <span class="string">", response="</span></span><br><span class="line">				+ responseAsDocument + <span class="string">", responseString='"</span> + responseAsString</span><br><span class="line">				+ <span class="string">'\''</span> + <span class="string">", is="</span> + is + <span class="string">", con="</span> + con + <span class="string">'&#125;'</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="built_in">log</span>(<span class="keyword">String</span> message) &#123;</span><br><span class="line">		<span class="keyword">if</span> (DEBUG) &#123;</span><br><span class="line">			<span class="built_in">log</span>.debug(<span class="string">"["</span> + <span class="keyword">new</span> java.util.Date() + <span class="string">"]"</span> + message);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="built_in">log</span>(<span class="keyword">String</span> message, <span class="keyword">String</span> message2) &#123;</span><br><span class="line">		<span class="keyword">if</span> (DEBUG) &#123;</span><br><span class="line">			<span class="built_in">log</span>(message + message2);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getResponseAsString() &#123;</span><br><span class="line">		<span class="keyword">return</span> responseAsString;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setResponseAsString(<span class="keyword">String</span> responseAsString) &#123;</span><br><span class="line">		<span class="keyword">this</span>.responseAsString = responseAsString;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setStatusCode(<span class="built_in">int</span> statusCode) &#123;</span><br><span class="line">		<span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="weibo4j-model包">weibo4j.model包</h1><h2 id="ApiRateLimits-java">ApiRateLimits.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiRateLimits</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">8550645887134692311L</span>;</span><br><span class="line">	<span class="keyword">private</span> String api; <span class="comment">// 接口</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> limit; <span class="comment">// 接口限制</span></span><br><span class="line">	<span class="keyword">private</span> String limitTimeUnit; <span class="comment">// 限制单元</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> remainingHits; <span class="comment">// 剩余调用次数</span></span><br><span class="line"></span><br><span class="line">	ApiRateLimits(JSONObject json) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			api = json.getString(<span class="string">"api"</span>);</span><br><span class="line">			limit = json.getInt(<span class="string">"limit"</span>);</span><br><span class="line">			limitTimeUnit = json.getString(<span class="string">"limit_time_unit"</span>);</span><br><span class="line">			remainingHits = json.getLong(<span class="string">"remaining_hits"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">					jsone.getMessage() + <span class="string">":"</span> + json.toString(), jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getApi</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> api;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApi</span><span class="params">(String api)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.api = api;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> limit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLimit</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.limit = limit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLimitTimeUnit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> limitTimeUnit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLimitTimeUnit</span><span class="params">(String limitTimeUnit)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.limitTimeUnit = limitTimeUnit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getRemainingHits</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> remainingHits;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemainingHits</span><span class="params">(<span class="keyword">long</span> remainingHits)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.remainingHits = remainingHits;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"api_rate_limits [api="</span> + api + <span class="string">", limit="</span> + limit</span><br><span class="line">				+ <span class="string">", limitTimeUnit="</span> + limitTimeUnit + <span class="string">", remainingHits="</span></span><br><span class="line">				+ remainingHits + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Configuration-java">Configuration.java</h2><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.security.AccessControlException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Configuration</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Properties defaultProperty;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		init();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* package */</span><span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		defaultProperty = <span class="keyword">new</span> Properties();</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.debug"</span>, <span class="string">"true"</span>);</span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.source", Weibo.CONSUMER_KEY);</span></span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.clientVersion","");</span></span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.clientURL"</span>,</span><br><span class="line">				<span class="string">"http://open.t.sina.com.cn/-&#123;weibo4j.clientVersion&#125;.xml"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.userAgent"</span>,</span><br><span class="line">				<span class="string">"weibo4j http://open.t.sina.com.cn/ /&#123;weibo4j.clientVersion&#125;"</span>);</span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.user","");</span></span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.password","");</span></span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.useSSL"</span>, <span class="string">"false"</span>);</span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.http.proxyHost","");</span></span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.proxyHost.fallback"</span>,</span><br><span class="line">				<span class="string">"http.proxyHost"</span>);</span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.http.proxyUser","");</span></span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.http.proxyPassword","");</span></span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.http.proxyPort","");</span></span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.proxyPort.fallback"</span>,</span><br><span class="line">				<span class="string">"http.proxyPort"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.connectionTimeout"</span>, <span class="string">"20000"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.readTimeout"</span>, <span class="string">"120000"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.retryCount"</span>, <span class="string">"3"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.http.retryIntervalSecs"</span>, <span class="string">"10"</span>);</span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.oauth.consumerKey","");</span></span><br><span class="line">		<span class="comment">// defaultProperty.setProperty("weibo4j.oauth.consumerSecret","");</span></span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.async.numThreads"</span>, <span class="string">"1"</span>);</span><br><span class="line">		defaultProperty.setProperty(<span class="string">"weibo4j.clientVersion"</span>,</span><br><span class="line">				Version.getVersion());</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// Android platform should have dalvik.system.VMRuntime in the</span></span><br><span class="line">			<span class="comment">// classpath.</span></span><br><span class="line">			<span class="comment">// @see</span></span><br><span class="line">			<span class="comment">// http://developer.android.com/reference/dalvik/system/VMRuntime.html</span></span><br><span class="line">			Class.forName(<span class="string">"dalvik.system.VMRuntime"</span>);</span><br><span class="line">			defaultProperty.setProperty(<span class="string">"weibo4j.dalvik"</span>, <span class="string">"true"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException cnfe) &#123;</span><br><span class="line">			defaultProperty.setProperty(<span class="string">"weibo4j.dalvik"</span>, <span class="string">"false"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		DALVIK = getBoolean(<span class="string">"weibo4j.dalvik"</span>);</span><br><span class="line">		String t4jProps = <span class="string">"weibo4j.properties"</span>;</span><br><span class="line">		<span class="keyword">boolean</span> loaded = loadProperties(defaultProperty, <span class="string">"."</span></span><br><span class="line">				+ File.separatorChar + t4jProps)</span><br><span class="line">				|| loadProperties(</span><br><span class="line">						defaultProperty,</span><br><span class="line">						Configuration.class.getResourceAsStream(<span class="string">"/WEB-INF/"</span></span><br><span class="line">								+ t4jProps))</span><br><span class="line">				|| loadProperties(defaultProperty,</span><br><span class="line">						Configuration.class.getResourceAsStream(<span class="string">"/"</span> + t4jProps));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">loadProperties</span><span class="params">(Properties props, String path)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			File file = <span class="keyword">new</span> File(path);</span><br><span class="line">			<span class="keyword">if</span> (file.exists() &amp;&amp; file.isFile()) &#123;</span><br><span class="line">				props.load(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ignore) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">loadProperties</span><span class="params">(Properties props, InputStream is)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			props.load(is);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ignore) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> DALVIK;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isDalvik</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> DALVIK;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">useSSL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getBoolean</span><span class="params">(<span class="string">"weibo4j.http.useSSL"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getScheme</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> useSSL() ? <span class="string">"https://"</span> : <span class="string">"http://"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getCilentVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.clientVersion"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getCilentVersion</span><span class="params">(String clientVersion)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.clientVersion"</span>, clientVersion)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.source"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getSource</span><span class="params">(String source)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.source"</span>, source)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyHost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyHost"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyHost</span><span class="params">(String proxyHost)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyHost"</span>, proxyHost)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyUser"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyUser</span><span class="params">(String user)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyUser"</span>, user)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getClientURL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.clientURL"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getClientURL</span><span class="params">(String clientURL)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.clientURL"</span>, clientURL)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyPassword"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProxyPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyPassword"</span>, password)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getProxyPort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyPort"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getProxyPort</span><span class="params">(<span class="keyword">int</span> port)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.proxyPort"</span>, port)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getConnectionTimeout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.connectionTimeout"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getConnectionTimeout</span><span class="params">(<span class="keyword">int</span> connectionTimeout)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.connectionTimeout"</span>,</span><br><span class="line">				connectionTimeout)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getReadTimeout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.readTimeout"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getReadTimeout</span><span class="params">(<span class="keyword">int</span> readTimeout)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.readTimeout"</span>, readTimeout)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getRetryCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.retryCount"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getRetryCount</span><span class="params">(<span class="keyword">int</span> retryCount)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.retryCount"</span>, retryCount)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getRetryIntervalSecs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.retryIntervalSecs"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getRetryIntervalSecs</span><span class="params">(<span class="keyword">int</span> retryIntervalSecs)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.http.retryIntervalSecs"</span>,</span><br><span class="line">				retryIntervalSecs)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.user"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getUser</span><span class="params">(String userId)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.user"</span>, userId)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.password"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.password"</span>, password)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getUserAgent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.userAgent"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getUserAgent</span><span class="params">(String userAgent)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.http.userAgent"</span>, userAgent)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getOAuthConsumerKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.oauth.consumerKey"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getOAuthConsumerKey</span><span class="params">(String consumerKey)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.oauth.consumerKey"</span>, consumerKey)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getOAuthConsumerSecret</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.oauth.consumerSecret"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getOAuthConsumerSecret</span><span class="params">(String consumerSecret)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(<span class="string">"weibo4j.oauth.consumerSecret"</span>, consumerSecret)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">getBoolean</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		String value = getProperty(name);</span><br><span class="line">		<span class="function"><span class="keyword">return</span> Boolean.<span class="title">valueOf</span><span class="params">(value)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getIntProperty</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		String value = getProperty(name);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="function"><span class="keyword">return</span> Integer.<span class="title">parseInt</span><span class="params">(value)</span></span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NumberFormatException nfe) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getIntProperty</span><span class="params">(String name, <span class="keyword">int</span> fallbackValue)</span> </span>&#123;</span><br><span class="line">		String value = getProperty(name, String.valueOf(fallbackValue));</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="function"><span class="keyword">return</span> Integer.<span class="title">parseInt</span><span class="params">(value)</span></span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NumberFormatException nfe) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">long</span> <span class="title">getLongProperty</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		String value = getProperty(name);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="function"><span class="keyword">return</span> Long.<span class="title">parseLong</span><span class="params">(value)</span></span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NumberFormatException nfe) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProperty</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getProperty</span><span class="params">(name, <span class="keyword">null</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">String <span class="title">getProperty</span><span class="params">(String name, String fallbackValue)</span> </span>&#123;</span><br><span class="line">		String value;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			value = System.getProperty(name, fallbackValue);</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> == value) &#123;</span><br><span class="line">				value = defaultProperty.getProperty(name);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> == value) &#123;</span><br><span class="line">				String fallback = defaultProperty.getProperty(name</span><br><span class="line">						+ <span class="string">".fallback"</span>);</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">null</span> != fallback) &#123;</span><br><span class="line">					value = System.getProperty(fallback);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (AccessControlException ace) &#123;</span><br><span class="line">			<span class="comment">// Unsigned applet cannot access System properties</span></span><br><span class="line">			value = fallbackValue;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">replace</span><span class="params">(value)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="function">String <span class="title">replace</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == value) &#123;</span><br><span class="line">			<span class="keyword">return</span> value;</span><br><span class="line">		&#125;</span><br><span class="line">		String newValue = value;</span><br><span class="line">		<span class="keyword">int</span> openBrace = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (-<span class="number">1</span> != (openBrace = value.indexOf(<span class="string">"&#123;"</span>, openBrace))) &#123;</span><br><span class="line">			<span class="keyword">int</span> closeBrace = value.indexOf(<span class="string">"&#125;"</span>, openBrace);</span><br><span class="line">			<span class="keyword">if</span> (closeBrace &gt; (openBrace + <span class="number">1</span>)) &#123;</span><br><span class="line">				String name = value.substring(openBrace + <span class="number">1</span>, closeBrace);</span><br><span class="line">				<span class="keyword">if</span> (name.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					newValue = value.substring(<span class="number">0</span>, openBrace)</span><br><span class="line">							+ getProperty(name)</span><br><span class="line">							+ value.substring(closeBrace + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (newValue.equals(value)) &#123;</span><br><span class="line">			<span class="keyword">return</span> value;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="function"><span class="keyword">return</span> <span class="title">replace</span><span class="params">(newValue)</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">getNumberOfAsyncThreads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getIntProperty</span><span class="params">(<span class="string">"weibo4j.async.numThreads"</span>)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">boolean</span> <span class="title">getDebug</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> <span class="title">getBoolean</span><span class="params">(<span class="string">"weibo4j.debug"</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Constants-java">Constants.java</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Constants</span> &#123;</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String X_AUTH_MODE = <span class="string">"client_auth"</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String UPLOAD_MODE = <span class="string">"pic"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="MySSLSocketFactory-java">MySSLSocketFactory.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.SocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyManagementException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.X509Certificate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLContext;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.TrustManager;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.X509TrustManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.ConnectTimeoutException;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.params.HttpConnectionParams;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.protocol.ProtocolSocketFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySSLSocketFactory</span> <span class="keyword">implements</span> <span class="title">ProtocolSocketFactory</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> SSLContext sslcontext = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> SSLContext <span class="title">createSSLContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SSLContext sslcontext = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			sslcontext = SSLContext.getInstance(<span class="string">"SSL"</span>);</span><br><span class="line">			sslcontext.init(<span class="keyword">null</span>,</span><br><span class="line">					<span class="keyword">new</span> TrustManager[] &#123; <span class="keyword">new</span> TrustAnyTrustManager() &#125;,</span><br><span class="line">					<span class="keyword">new</span> java.security.SecureRandom());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (KeyManagementException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sslcontext;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> SSLContext <span class="title">getSSLContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.sslcontext == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.sslcontext = createSSLContext();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.sslcontext;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(Socket socket, String host, <span class="keyword">int</span> port,</span><br><span class="line">			<span class="keyword">boolean</span> autoClose)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> getSSLContext().getSocketFactory().createSocket(socket, host,</span><br><span class="line">				port, autoClose);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">			UnknownHostException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> getSSLContext().getSocketFactory().createSocket(host, port);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port, InetAddress clientHost,</span><br><span class="line">			<span class="keyword">int</span> clientPort)</span> <span class="keyword">throws</span> IOException, UnknownHostException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> getSSLContext().getSocketFactory().createSocket(host, port,</span><br><span class="line">				clientHost, clientPort);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Socket <span class="title">createSocket</span><span class="params">(String host, <span class="keyword">int</span> port, InetAddress localAddress,</span><br><span class="line">			<span class="keyword">int</span> localPort, HttpConnectionParams params)</span> <span class="keyword">throws</span> IOException,</span><br><span class="line">			UnknownHostException, ConnectTimeoutException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (params == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Parameters may not be null"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> timeout = params.getConnectionTimeout();</span><br><span class="line">		SocketFactory socketfactory = getSSLContext().getSocketFactory();</span><br><span class="line">		<span class="keyword">if</span> (timeout == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> socketfactory.createSocket(host, port, localAddress,</span><br><span class="line">					localPort);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			Socket socket = socketfactory.createSocket();</span><br><span class="line">			SocketAddress localaddr = <span class="keyword">new</span> InetSocketAddress(localAddress,</span><br><span class="line">					localPort);</span><br><span class="line">			SocketAddress remoteaddr = <span class="keyword">new</span> InetSocketAddress(host, port);</span><br><span class="line">			socket.bind(localaddr);</span><br><span class="line">			socket.connect(remoteaddr, timeout);</span><br><span class="line">			<span class="keyword">return</span> socket;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TrustAnyTrustManager</span> <span class="keyword">implements</span> <span class="title">X509TrustManager</span> </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkClientTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span></span><br><span class="line">				<span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkServerTrusted</span><span class="params">(X509Certificate[] chain, String authType)</span></span><br><span class="line">				<span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> X509Certificate[] &#123;&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Paging-java">Paging.java</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">package weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Paging implements java.io.Serializable &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> final <span class="keyword">long</span> serialVersionUID = -<span class="number">3285857427993796670L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> page = -<span class="number">1</span>; <span class="comment">// 页码。注意：最多返回200条分页内容。</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> count = -<span class="number">1</span>; <span class="comment">// 指定每页返回的记录条数。</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> sinceId = -<span class="number">1</span>; <span class="comment">// 若指定此参数，则只返回ID比since_id大（即比since_id发表时间晚的）的微博消息。</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> maxId = -<span class="number">1</span>; <span class="comment">// 若指定此参数，则返回ID小于或等于max_id的微博消息</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">int</span> page)</span> </span>&#123;</span><br><span class="line">		setPage(page);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">long</span> sinceId)</span> </span>&#123;</span><br><span class="line">		setSinceId(sinceId);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">int</span> page, <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>(page);</span><br><span class="line">		setCount(count);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">int</span> page, <span class="keyword">long</span> sinceId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>(page);</span><br><span class="line">		setSinceId(sinceId);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">int</span> page, <span class="keyword">int</span> count, <span class="keyword">long</span> sinceId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>(page, count);</span><br><span class="line">		setSinceId(sinceId);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Paging</span><span class="params">(<span class="keyword">int</span> page, <span class="keyword">int</span> count, <span class="keyword">long</span> sinceId, <span class="keyword">long</span> maxId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>(page, count, sinceId);</span><br><span class="line">		setMaxId(maxId);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> page;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPage</span><span class="params">(<span class="keyword">int</span> page)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (page &lt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">					<span class="string">"page should be positive integer. passed:"</span> + page);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.page = page;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> count;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (count &lt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">					<span class="string">"count should be positive integer. passed:"</span> + count);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.count = count;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Paging <span class="title">count</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">		setCount(count);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getSinceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sinceId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSinceId</span><span class="params">(<span class="keyword">int</span> sinceId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (sinceId &lt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">					<span class="string">"since_id should be positive integer. passed:"</span> + sinceId);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.sinceId = sinceId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Paging <span class="title">sinceId</span><span class="params">(<span class="keyword">int</span> sinceId)</span> </span>&#123;</span><br><span class="line">		setSinceId(sinceId);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSinceId</span><span class="params">(<span class="keyword">long</span> sinceId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (sinceId &lt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">					<span class="string">"since_id should be positive integer. passed:"</span> + sinceId);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.sinceId = sinceId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Paging <span class="title">sinceId</span><span class="params">(<span class="keyword">long</span> sinceId)</span> </span>&#123;</span><br><span class="line">		setSinceId(sinceId);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getMaxId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> maxId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMaxId</span><span class="params">(<span class="keyword">long</span> maxId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (maxId &lt; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">					<span class="string">"max_id should be positive integer. passed:"</span> + maxId);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.maxId = maxId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Paging <span class="title">maxId</span><span class="params">(<span class="keyword">long</span> maxId)</span> </span>&#123;</span><br><span class="line">		setMaxId(maxId);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PostParameter-java">PostParameter.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class PostParameter implements java.io.Serializable &#123;</span><br><span class="line">	<span class="keyword">String</span> name;</span><br><span class="line">	<span class="keyword">String</span> value;</span><br><span class="line">	<span class="keyword">private</span> File file = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">8708108746980739212</span>L;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> PostParameter(<span class="keyword">String</span> name, <span class="keyword">String</span> value) &#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.value = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> PostParameter(<span class="keyword">String</span> name, <span class="keyword">double</span> value) &#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.value = <span class="keyword">String</span>.valueOf(value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> PostParameter(<span class="keyword">String</span> name, <span class="built_in">int</span> value) &#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.value = <span class="keyword">String</span>.valueOf(value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> PostParameter(<span class="keyword">String</span> name, File file) &#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">		<span class="keyword">this</span>.file = file;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getName() &#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getValue() &#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> File getFile() &#123;</span><br><span class="line">		<span class="keyword">return</span> file;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> isFile() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span> != file;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> JPEG = <span class="string">"image/jpeg"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> GIF = <span class="string">"image/gif"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> PNG = <span class="string">"image/png"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> OCTET = <span class="string">"application/octet-stream"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * </span><br><span class="line">	 * @return content-type</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getContentType() &#123;</span><br><span class="line">		<span class="keyword">if</span> (!isFile()) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"not a file"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">String</span> contentType;</span><br><span class="line">		<span class="keyword">String</span> extensions = file.getName();</span><br><span class="line">		<span class="built_in">int</span> index = extensions.lastIndexOf(<span class="string">"."</span>);</span><br><span class="line">		<span class="keyword">if</span> (-<span class="number">1</span> == index) &#123;</span><br><span class="line">			<span class="comment">// no extension</span></span><br><span class="line">			contentType = OCTET;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			extensions = extensions.substring(extensions.lastIndexOf(<span class="string">"."</span>) + <span class="number">1</span>)</span><br><span class="line">					.toLowerCase();</span><br><span class="line">			<span class="keyword">if</span> (extensions.length() == <span class="number">3</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="string">"gif"</span>.equals(extensions)) &#123;</span><br><span class="line">					contentType = GIF;</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"png"</span>.equals(extensions)) &#123;</span><br><span class="line">					contentType = PNG;</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"jpg"</span>.equals(extensions)) &#123;</span><br><span class="line">					contentType = JPEG;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					contentType = OCTET;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (extensions.length() == <span class="number">4</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="string">"jpeg"</span>.equals(extensions)) &#123;</span><br><span class="line">					contentType = JPEG;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					contentType = OCTET;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				contentType = OCTET;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> contentType;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">boolean</span> containsFile(PostParameter[] params) &#123;</span><br><span class="line">		<span class="built_in">boolean</span> containsFile = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == params) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (PostParameter param : params) &#123;</span><br><span class="line">			<span class="keyword">if</span> (param.isFile()) &#123;</span><br><span class="line">				containsFile = <span class="keyword">true</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> containsFile;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* package */</span><span class="keyword">static</span> <span class="built_in">boolean</span> containsFile(List&lt;PostParameter&gt; params) &#123;</span><br><span class="line">		<span class="built_in">boolean</span> containsFile = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (PostParameter param : params) &#123;</span><br><span class="line">			<span class="keyword">if</span> (param.isFile()) &#123;</span><br><span class="line">				containsFile = <span class="keyword">true</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> containsFile;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> PostParameter[] getParameterArray(<span class="keyword">String</span> name, <span class="keyword">String</span> value) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> PostParameter[] &#123; <span class="keyword">new</span> PostParameter(name, value) &#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> PostParameter[] getParameterArray(<span class="keyword">String</span> name, <span class="built_in">int</span> value) &#123;</span><br><span class="line">		<span class="keyword">return</span> getParameterArray(name, <span class="keyword">String</span>.valueOf(value));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> PostParameter[] getParameterArray(<span class="keyword">String</span> name1,</span><br><span class="line">			<span class="keyword">String</span> value1, <span class="keyword">String</span> name2, <span class="keyword">String</span> value2) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> PostParameter[] &#123; <span class="keyword">new</span> PostParameter(name1, value1),</span><br><span class="line">				<span class="keyword">new</span> PostParameter(name2, value2) &#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> PostParameter[] getParameterArray(<span class="keyword">String</span> name1, <span class="built_in">int</span> value1,</span><br><span class="line">			<span class="keyword">String</span> name2, <span class="built_in">int</span> value2) &#123;</span><br><span class="line">		<span class="keyword">return</span> getParameterArray(name1, <span class="keyword">String</span>.valueOf(value1), name2,</span><br><span class="line">				<span class="keyword">String</span>.valueOf(value2));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> hashCode() &#123;</span><br><span class="line">		<span class="built_in">int</span> result = name.hashCode();</span><br><span class="line">		result = <span class="number">31</span> * result + value.hashCode();</span><br><span class="line">		result = <span class="number">31</span> * result + (file != <span class="keyword">null</span> ? file.hashCode() : <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> equals(<span class="keyword">Object</span> obj) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == obj) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> == obj) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (obj <span class="keyword">instanceof</span> PostParameter) &#123;</span><br><span class="line">			PostParameter that = (PostParameter) obj;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (file != <span class="keyword">null</span> ? !file.equals(that.file) : that.file != <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.name.equals(that.name) &amp;&amp; <span class="keyword">this</span>.value.equals(that.value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"PostParameter&#123;"</span> + <span class="string">"name='"</span> + name + <span class="string">'\''</span> + <span class="string">", value='"</span> + value</span><br><span class="line">				+ <span class="string">'\''</span> + <span class="string">", file="</span> + file + <span class="string">'&#125;'</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> compareTo(<span class="keyword">Object</span> o) &#123;</span><br><span class="line">		<span class="built_in">int</span> compared;</span><br><span class="line">		PostParameter that = (PostParameter) o;</span><br><span class="line">		compared = name.compareTo(that.name);</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == compared) &#123;</span><br><span class="line">			compared = value.compareTo(that.value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> compared;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> encodeParameters(PostParameter[] httpParams) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == httpParams) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		StringBuffer buf = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; httpParams.length; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (httpParams[j].isFile()) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"parameter ["</span></span><br><span class="line">						+ httpParams[j].name + <span class="string">"]should be text"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (j != <span class="number">0</span>) &#123;</span><br><span class="line">				buf.<span class="built_in">append</span>(<span class="string">"&amp;"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				buf.<span class="built_in">append</span>(URLEncoder.encode(httpParams[j].name, <span class="string">"UTF-8"</span>))</span><br><span class="line">						.<span class="built_in">append</span>(<span class="string">"="</span>)</span><br><span class="line">						.<span class="built_in">append</span>(URLEncoder.encode(httpParams[j].value, <span class="string">"UTF-8"</span>));</span><br><span class="line">			&#125; <span class="keyword">catch</span> (java.io.UnsupportedEncodingException neverHappen) &#123;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> buf.toString();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Source-java">Source.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Source implements java.io.Serializable &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">8972443458374235866</span>L;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> url; <span class="comment">// 来源连接</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> relationShip;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name; <span class="comment">// 来源文案名称</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Source(<span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">String</span>[] source = <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">"\""</span>, <span class="number">5</span>);</span><br><span class="line">		url = source[<span class="number">1</span>];</span><br><span class="line">		relationShip = source[<span class="number">3</span>];</span><br><span class="line">		name = source[<span class="number">4</span>].replace(<span class="string">"&gt;"</span>, <span class="string">""</span>).replace(<span class="string">"&lt;/a"</span>, <span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getUrl() &#123;</span><br><span class="line">		<span class="keyword">return</span> url;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setUrl(<span class="keyword">String</span> url) &#123;</span><br><span class="line">		<span class="keyword">this</span>.url = url;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getRelationship() &#123;</span><br><span class="line">		<span class="keyword">return</span> relationShip;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setRelationship(<span class="keyword">String</span> relationShip) &#123;</span><br><span class="line">		<span class="keyword">this</span>.relationShip = relationShip;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getName() &#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setName(<span class="keyword">String</span> name) &#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Source [url="</span> + url + <span class="string">", relationShip="</span> + relationShip</span><br><span class="line">				+ <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Status-java">Status.java</h2><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.http.Response;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONArray;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Status</span> <span class="keyword">extends</span> <span class="title">WeiboResponse</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">8795691786466526420</span>L;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> User user = <span class="keyword">null</span>; <span class="comment">// 作者信息</span></span><br><span class="line">	<span class="keyword">private</span> Date createdAt; <span class="comment">// status创建时间</span></span><br><span class="line">	<span class="keyword">private</span> String id; <span class="comment">// status id</span></span><br><span class="line">	<span class="keyword">private</span> String mid; <span class="comment">// 微博MID</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> idstr; <span class="comment">// 保留字段，请勿使用</span></span><br><span class="line">	<span class="keyword">private</span> String text; <span class="comment">// 微博内容</span></span><br><span class="line">	<span class="keyword">private</span> Source source; <span class="comment">// 微博来源</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> favorited; <span class="comment">// 是否已收藏</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> truncated;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> inReplyToStatusId; <span class="comment">// 回复ID</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> inReplyToUserId; <span class="comment">// 回复人ID</span></span><br><span class="line">	<span class="keyword">private</span> String inReplyToScreenName; <span class="comment">// 回复人昵称</span></span><br><span class="line">	<span class="keyword">private</span> String thumbnailPic; <span class="comment">// 微博内容中的图片的缩略地址</span></span><br><span class="line">	<span class="keyword">private</span> String bmiddlePic; <span class="comment">// 中型图片</span></span><br><span class="line">	<span class="keyword">private</span> String originalPic; <span class="comment">// 原始图片</span></span><br><span class="line">	<span class="keyword">private</span> Status retweetedStatus = <span class="keyword">null</span>; <span class="comment">// 转发的博文，内容为status，如果不是转发，则没有此字段</span></span><br><span class="line">	<span class="keyword">private</span> String geo; <span class="comment">// 地理信息，保存经纬度，没有时不返回此字段</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> latitude = -<span class="number">1</span>; <span class="comment">// 纬度</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> longitude = -<span class="number">1</span>; <span class="comment">// 经度</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> repostsCount; <span class="comment">// 转发数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> commentsCount; <span class="comment">// 评论数</span></span><br><span class="line">	<span class="keyword">private</span> String annotations; <span class="comment">// 元数据，没有时不返回此字段</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> mlevel;</span><br><span class="line">	<span class="keyword">private</span> Visible visible;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Status</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Status</span><span class="params">(Response res)</span> <span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(res);</span><br><span class="line">		JSONObject json = res.asJSONObject();</span><br><span class="line">		constructJson(json);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">constructJson</span><span class="params">(JSONObject json)</span> <span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			createdAt = parseDate(json.getString(<span class="string">"created_at"</span>),</span><br><span class="line">					<span class="string">"EEE MMM dd HH:mm:ss z yyyy"</span>);</span><br><span class="line">			id = json.getString(<span class="string">"id"</span>);</span><br><span class="line">			mid = json.getString(<span class="string">"mid"</span>);</span><br><span class="line">			idstr = json.getLong(<span class="string">"idstr"</span>);</span><br><span class="line">			text = json.getString(<span class="string">"text"</span>);</span><br><span class="line">			<span class="keyword">if</span> (!json.getString(<span class="string">"source"</span>).isEmpty()) &#123;</span><br><span class="line">				source = <span class="keyword">new</span> Source(json.getString(<span class="string">"source"</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			inReplyToStatusId = getLong(<span class="string">"in_reply_to_status_id"</span>, json);</span><br><span class="line">			inReplyToUserId = getLong(<span class="string">"in_reply_to_user_id"</span>, json);</span><br><span class="line">			inReplyToScreenName = json.getString(<span class="string">"in_reply_toS_screenName"</span>);</span><br><span class="line">			favorited = getBoolean(<span class="string">"favorited"</span>, json);</span><br><span class="line">			truncated = getBoolean(<span class="string">"truncated"</span>, json);</span><br><span class="line">			thumbnailPic = json.getString(<span class="string">"thumbnail_pic"</span>);</span><br><span class="line">			bmiddlePic = json.getString(<span class="string">"bmiddle_pic"</span>);</span><br><span class="line">			originalPic = json.getString(<span class="string">"original_pic"</span>);</span><br><span class="line">			repostsCount = json.getInt(<span class="string">"reposts_count"</span>);</span><br><span class="line">			commentsCount = json.getInt(<span class="string">"comments_count"</span>);</span><br><span class="line">			annotations = json.getString(<span class="string">"annotations"</span>);</span><br><span class="line">			<span class="keyword">if</span> (!json.isNull(<span class="string">"user"</span>))</span><br><span class="line">				user = <span class="keyword">new</span> User(json.getJSONObject(<span class="string">"user"</span>));</span><br><span class="line">			<span class="keyword">if</span> (!json.isNull(<span class="string">"retweeted_status"</span>)) &#123;</span><br><span class="line">				retweetedStatus = <span class="keyword">new</span> Status(</span><br><span class="line">						json.getJSONObject(<span class="string">"retweeted_status"</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			mlevel = json.getInt(<span class="string">"mlevel"</span>);</span><br><span class="line">			geo = json.getString(<span class="string">"geo"</span>);</span><br><span class="line">			<span class="keyword">if</span> (geo != <span class="keyword">null</span> &amp;&amp; !<span class="string">""</span>.equals(geo) &amp;&amp; !<span class="string">"null"</span>.equals(geo)) &#123;</span><br><span class="line">				getGeoInfo(geo);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!json.isNull(<span class="string">"visible"</span>)) &#123;</span><br><span class="line">				visible = <span class="keyword">new</span> Visible(json.getJSONObject(<span class="string">"visible"</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException je) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(je.getMessage() + <span class="string">":"</span> + json.toString(),</span><br><span class="line">					je);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">getGeoInfo</span><span class="params">(String geo)</span> </span>&#123;</span><br><span class="line">		StringBuffer value = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">char</span> c : geo.toCharArray()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (c &gt; <span class="number">45</span> &amp;&amp; c &lt; <span class="number">58</span>) &#123;</span><br><span class="line">				value.append(c);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="number">44</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (value.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					latitude = Double.parseDouble(value.toString());</span><br><span class="line">					value.delete(<span class="number">0</span>, value.length());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		longitude = Double.parseDouble(value.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Status</span><span class="params">(JSONObject json)</span> <span class="keyword">throws</span> WeiboException, JSONException </span>&#123;</span><br><span class="line">		constructJson(json);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Status</span><span class="params">(String str)</span> <span class="keyword">throws</span> WeiboException, JSONException </span>&#123;</span><br><span class="line">		<span class="comment">// StatusStream uses this constructor</span></span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		JSONObject json = <span class="keyword">new</span> JSONObject(str);</span><br><span class="line">		constructJson(json);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user = user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">long</span> <span class="title">getIdstr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> idstr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setIdstr</span><span class="params">(<span class="keyword">long</span> idstr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.idstr = idstr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Date <span class="title">getCreatedAt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> createdAt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setCreatedAt</span><span class="params">(Date createdAt)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.createdAt = createdAt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getText</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> text;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setText</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.text = text;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Source <span class="title">getSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> source;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setSource</span><span class="params">(Source source)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.source = source;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isFavorited</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> favorited;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setFavorited</span><span class="params">(<span class="keyword">boolean</span> favorited)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.favorited = favorited;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">long</span> <span class="title">getInReplyToStatusId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> inReplyToStatusId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setInReplyToStatusId</span><span class="params">(<span class="keyword">long</span> inReplyToStatusId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.inReplyToStatusId = inReplyToStatusId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">long</span> <span class="title">getInReplyToUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> inReplyToUserId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setInReplyToUserId</span><span class="params">(<span class="keyword">long</span> inReplyToUserId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.inReplyToUserId = inReplyToUserId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getInReplyToScreenName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> inReplyToScreenName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setInReplyToScreenName</span><span class="params">(String inReplyToScreenName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.inReplyToScreenName = inReplyToScreenName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getThumbnailPic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> thumbnailPic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setThumbnailPic</span><span class="params">(String thumbnailPic)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.thumbnailPic = thumbnailPic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getBmiddlePic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> bmiddlePic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setBmiddlePic</span><span class="params">(String bmiddlePic)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.bmiddlePic = bmiddlePic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getOriginalPic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> originalPic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setOriginalPic</span><span class="params">(String originalPic)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.originalPic = originalPic;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Status <span class="title">getRetweetedStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> retweetedStatus;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setRetweetedStatus</span><span class="params">(Status retweetedStatus)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.retweetedStatus = retweetedStatus;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getGeo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> geo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setGeo</span><span class="params">(String geo)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.geo = geo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">double</span> <span class="title">getLatitude</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> latitude;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setLatitude</span><span class="params">(<span class="keyword">double</span> latitude)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.latitude = latitude;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">double</span> <span class="title">getLongitude</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> longitude;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setLongitude</span><span class="params">(<span class="keyword">double</span> longitude)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.longitude = longitude;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getRepostsCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> repostsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setRepostsCount</span><span class="params">(<span class="keyword">int</span> repostsCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.repostsCount = repostsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getCommentsCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> commentsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setCommentsCount</span><span class="params">(<span class="keyword">int</span> commentsCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.commentsCount = commentsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getMid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setMid</span><span class="params">(String mid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mid = mid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getAnnotations</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> annotations;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setAnnotations</span><span class="params">(String annotations)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.annotations = annotations;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getMlevel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mlevel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setMlevel</span><span class="params">(<span class="keyword">int</span> mlevel)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mlevel = mlevel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Visible <span class="title">getVisible</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> visible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setVisible</span><span class="params">(Visible visible)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.visible = visible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isTruncated</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> truncated;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setTruncated</span><span class="params">(<span class="keyword">boolean</span> truncated)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.truncated = truncated;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function">StatusWapper <span class="title">constructWapperStatus</span><span class="params">(Response res)</span></span><br><span class="line">			<span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		JSONObject jsonStatus = res.asJSONObject(); <span class="comment">// asJSONArray();</span></span><br><span class="line">		JSONArray statuses = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (!jsonStatus.isNull(<span class="string">"statuses"</span>)) &#123;</span><br><span class="line">				statuses = jsonStatus.getJSONArray(<span class="string">"statuses"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!jsonStatus.isNull(<span class="string">"reposts"</span>)) &#123;</span><br><span class="line">				statuses = jsonStatus.getJSONArray(<span class="string">"reposts"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> size = statuses.length();</span><br><span class="line">			List&lt;Status&gt; status = <span class="keyword">new</span> ArrayList&lt;Status&gt;(size);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">				status.add(<span class="keyword">new</span> Status(statuses.getJSONObject(i)));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">long</span> previousCursor = jsonStatus.getLong(<span class="string">"previous_curosr"</span>);</span><br><span class="line">			<span class="keyword">long</span> nextCursor = jsonStatus.getLong(<span class="string">"next_cursor"</span>);</span><br><span class="line">			<span class="keyword">long</span> totalNumber = jsonStatus.getLong(<span class="string">"total_number"</span>);</span><br><span class="line">			String hasvisible = jsonStatus.getString(<span class="string">"hasvisible"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> StatusWapper(status, previousCursor, nextCursor,</span><br><span class="line">					totalNumber, hasvisible);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> prime = <span class="number">31</span>;</span><br><span class="line">		<span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">		result = prime * result + ((id == <span class="keyword">null</span>) ? <span class="number">0</span> : id.hashCode());</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> == obj)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (getClass() != obj.getClass())</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		Status other = (Status) obj;</span><br><span class="line">		<span class="keyword">if</span> (id == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.id != <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!id.equals(other.id))</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Status [user="</span> + user + <span class="string">", idstr="</span> + idstr + <span class="string">", createdAt="</span></span><br><span class="line">				+ createdAt + <span class="string">", id="</span> + id + <span class="string">", text="</span> + text + <span class="string">", source="</span></span><br><span class="line">				+ source + <span class="string">", favorited="</span> + favorited + <span class="string">", truncated="</span></span><br><span class="line">				+ truncated + <span class="string">", inReplyToStatusId="</span> + inReplyToStatusId</span><br><span class="line">				+ <span class="string">", inReplyToUserId="</span> + inReplyToUserId</span><br><span class="line">				+ <span class="string">", inReplyToScreenName="</span> + inReplyToScreenName</span><br><span class="line">				+ <span class="string">", thumbnailPic="</span> + thumbnailPic + <span class="string">", bmiddlePic="</span></span><br><span class="line">				+ bmiddlePic + <span class="string">", originalPic="</span> + originalPic</span><br><span class="line">				+ <span class="string">", retweetedStatus="</span> + retweetedStatus + <span class="string">", geo="</span> + geo</span><br><span class="line">				+ <span class="string">", latitude="</span> + latitude + <span class="string">", longitude="</span> + longitude</span><br><span class="line">				+ <span class="string">", repostsCount="</span> + repostsCount + <span class="string">", commentsCount="</span></span><br><span class="line">				+ commentsCount + <span class="string">", mid="</span> + mid + <span class="string">", annotations="</span></span><br><span class="line">				+ annotations + <span class="string">", mlevel="</span> + mlevel + <span class="string">", visible="</span> + visible</span><br><span class="line">				+ <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="StatusWapper-java">StatusWapper.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StatusWapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;Status&gt; statuses;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> previousCursor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> nextCursor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> totalNumber;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String hasvisible;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">StatusWapper</span><span class="params">(List&lt;Status&gt; statuses, <span class="keyword">long</span> previousCursor,</span><br><span class="line">			<span class="keyword">long</span> nextCursor, <span class="keyword">long</span> totalNumber, String hasvisible)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.statuses = statuses;</span><br><span class="line">		<span class="keyword">this</span>.previousCursor = previousCursor;</span><br><span class="line">		<span class="keyword">this</span>.nextCursor = nextCursor;</span><br><span class="line">		<span class="keyword">this</span>.totalNumber = totalNumber;</span><br><span class="line">		<span class="keyword">this</span>.hasvisible = hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Status&gt; <span class="title">getStatuses</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> statuses;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatuses</span><span class="params">(List&lt;Status&gt; statuses)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.statuses = statuses;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getPreviousCursor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> previousCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPreviousCursor</span><span class="params">(<span class="keyword">long</span> previousCursor)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.previousCursor = previousCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getNextCursor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> nextCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextCursor</span><span class="params">(<span class="keyword">long</span> nextCursor)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.nextCursor = nextCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getTotalNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> totalNumber;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotalNumber</span><span class="params">(<span class="keyword">long</span> totalNumber)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.totalNumber = totalNumber;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getHasvisible</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasvisible</span><span class="params">(String hasvisible)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.hasvisible = hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="User-java">User.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.http.Response;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONArray;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">WeiboResponse</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">332738032648843482L</span>;</span><br><span class="line">	<span class="keyword">private</span> String id; <span class="comment">// 用户UID</span></span><br><span class="line">	<span class="keyword">private</span> String screenName; <span class="comment">// 微博昵称</span></span><br><span class="line">	<span class="keyword">private</span> String name; <span class="comment">// 友好显示名称，如Bill Gates,名称中间的空格正常显示(此特性暂不支持)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> province; <span class="comment">// 省份编码（参考省份编码表）</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> city; <span class="comment">// 城市编码（参考城市编码表）</span></span><br><span class="line">	<span class="keyword">private</span> String location; <span class="comment">// 地址</span></span><br><span class="line">	<span class="keyword">private</span> String description; <span class="comment">// 个人描述</span></span><br><span class="line">	<span class="keyword">private</span> String url; <span class="comment">// 用户博客地址</span></span><br><span class="line">	<span class="keyword">private</span> String profileImageUrl; <span class="comment">// 自定义图像</span></span><br><span class="line">	<span class="keyword">private</span> String userDomain; <span class="comment">// 用户个性化URL</span></span><br><span class="line">	<span class="keyword">private</span> String gender; <span class="comment">// 性别,m--男，f--女,n--未知</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> followersCount; <span class="comment">// 粉丝数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> friendsCount; <span class="comment">// 关注数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> statusesCount; <span class="comment">// 微博数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> favouritesCount; <span class="comment">// 收藏数</span></span><br><span class="line">	<span class="keyword">private</span> Date createdAt; <span class="comment">// 创建时间</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> following; <span class="comment">// 保留字段,是否已关注(此特性暂不支持)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> verified; <span class="comment">// 加V标示，是否微博认证用户</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> verifiedType; <span class="comment">// 认证类型</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> allowAllActMsg; <span class="comment">// 是否允许所有人给我发私信</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> allowAllComment; <span class="comment">// 是否允许所有人对我的微博进行评论</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> followMe; <span class="comment">// 此用户是否关注我</span></span><br><span class="line">	<span class="keyword">private</span> String avatarLarge; <span class="comment">// 大头像地址</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> onlineStatus; <span class="comment">// 用户在线状态</span></span><br><span class="line">	<span class="keyword">private</span> Status status = <span class="keyword">null</span>; <span class="comment">// 用户最新一条微博</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> biFollowersCount; <span class="comment">// 互粉数</span></span><br><span class="line">	<span class="keyword">private</span> String remark; <span class="comment">// 备注信息，在查询用户关系时提供此字段。</span></span><br><span class="line">	<span class="keyword">private</span> String lang; <span class="comment">// 用户语言版本</span></span><br><span class="line">	<span class="keyword">private</span> String verifiedReason; <span class="comment">// 认证原因</span></span><br><span class="line">	<span class="keyword">private</span> String weihao; <span class="comment">// 微號</span></span><br><span class="line">	<span class="keyword">private</span> String statusId;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getVerified_reason</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> verifiedReason;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVerified_reason</span><span class="params">(String verifiedReason)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.verifiedReason = verifiedReason;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScreenName</span><span class="params">(String screenName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.screenName = screenName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProvince</span><span class="params">(<span class="keyword">int</span> province)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.province = province;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(<span class="keyword">int</span> city)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.city = city;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocation</span><span class="params">(String location)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.location = location;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.description = description;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.url = url;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProfileImageUrl</span><span class="params">(String profileImageUrl)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.profileImageUrl = profileImageUrl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDomain</span><span class="params">(String userDomain)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userDomain = userDomain;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.gender = gender;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFollowersCount</span><span class="params">(<span class="keyword">int</span> followersCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.followersCount = followersCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFriendsCount</span><span class="params">(<span class="keyword">int</span> friendsCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.friendsCount = friendsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatusesCount</span><span class="params">(<span class="keyword">int</span> statusesCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.statusesCount = statusesCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFavouritesCount</span><span class="params">(<span class="keyword">int</span> favouritesCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.favouritesCount = favouritesCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreatedAt</span><span class="params">(Date createdAt)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.createdAt = createdAt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFollowing</span><span class="params">(<span class="keyword">boolean</span> following)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.following = following;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVerified</span><span class="params">(<span class="keyword">boolean</span> verified)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.verified = verified;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVerifiedType</span><span class="params">(<span class="keyword">int</span> verifiedType)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.verifiedType = verifiedType;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAllowAllActMsg</span><span class="params">(<span class="keyword">boolean</span> allowAllActMsg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.allowAllActMsg = allowAllActMsg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAllowAllComment</span><span class="params">(<span class="keyword">boolean</span> allowAllComment)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.allowAllComment = allowAllComment;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFollowMe</span><span class="params">(<span class="keyword">boolean</span> followMe)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.followMe = followMe;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAvatarLarge</span><span class="params">(String avatarLarge)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.avatarLarge = avatarLarge;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnlineStatus</span><span class="params">(<span class="keyword">int</span> onlineStatus)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.onlineStatus = onlineStatus;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">(Status status)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.status = status;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBiFollowersCount</span><span class="params">(<span class="keyword">int</span> biFollowersCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.biFollowersCount = biFollowersCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemark</span><span class="params">(String remark)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.remark = remark;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLang</span><span class="params">(String lang)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lang = lang;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getWeihao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> weihao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWeihao</span><span class="params">(String weihao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.weihao = weihao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getVerifiedReason</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> verifiedReason;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVerifiedReason</span><span class="params">(String verifiedReason)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.verifiedReason = verifiedReason;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getStatusId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> statusId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatusId</span><span class="params">(String statusId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.statusId = statusId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> url;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getProfileImageUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> profileImageUrl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVerifiedType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> verifiedType;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAllowAllActMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> allowAllActMsg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAllowAllComment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> allowAllComment;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFollowMe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> followMe;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAvatarLarge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> avatarLarge;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOnlineStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> onlineStatus;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBiFollowersCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> biFollowersCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* package */</span><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(JSONObject json)</span> <span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		init(json);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(JSONObject json)</span> <span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (json != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				id = json.getString(<span class="string">"id"</span>);</span><br><span class="line">				screenName = json.getString(<span class="string">"screen_name"</span>);</span><br><span class="line">				name = json.getString(<span class="string">"name"</span>);</span><br><span class="line">				province = json.getInt(<span class="string">"province"</span>);</span><br><span class="line">				city = json.getInt(<span class="string">"city"</span>);</span><br><span class="line">				location = json.getString(<span class="string">"location"</span>);</span><br><span class="line">				description = json.getString(<span class="string">"description"</span>);</span><br><span class="line">				url = json.getString(<span class="string">"url"</span>);</span><br><span class="line">				profileImageUrl = json.getString(<span class="string">"profile_image_url"</span>);</span><br><span class="line">				userDomain = json.getString(<span class="string">"domain"</span>);</span><br><span class="line">				gender = json.getString(<span class="string">"gender"</span>);</span><br><span class="line">				followersCount = json.getInt(<span class="string">"followers_count"</span>);</span><br><span class="line">				friendsCount = json.getInt(<span class="string">"friends_count"</span>);</span><br><span class="line">				favouritesCount = json.getInt(<span class="string">"favourites_count"</span>);</span><br><span class="line">				statusesCount = json.getInt(<span class="string">"statuses_count"</span>);</span><br><span class="line">				createdAt = parseDate(json.getString(<span class="string">"created_at"</span>),</span><br><span class="line">						<span class="string">"EEE MMM dd HH:mm:ss z yyyy"</span>);</span><br><span class="line">				following = getBoolean(<span class="string">"following"</span>, json);</span><br><span class="line">				verified = getBoolean(<span class="string">"verified"</span>, json);</span><br><span class="line">				verifiedType = json.getInt(<span class="string">"verified_type"</span>);</span><br><span class="line">				verifiedReason = json.getString(<span class="string">"verified_reason"</span>);</span><br><span class="line">				allowAllActMsg = json.getBoolean(<span class="string">"allow_all_act_msg"</span>);</span><br><span class="line">				allowAllComment = json.getBoolean(<span class="string">"allow_all_comment"</span>);</span><br><span class="line">				followMe = json.getBoolean(<span class="string">"follow_me"</span>);</span><br><span class="line">				avatarLarge = json.getString(<span class="string">"avatar_large"</span>);</span><br><span class="line">				onlineStatus = json.getInt(<span class="string">"online_status"</span>);</span><br><span class="line">				statusId = json.getString(<span class="string">"status_id"</span>);</span><br><span class="line">				biFollowersCount = json.getInt(<span class="string">"bi_followers_count"</span>);</span><br><span class="line">				<span class="keyword">if</span> (!json.getString(<span class="string">"remark"</span>).isEmpty()) &#123;</span><br><span class="line">					remark = json.getString(<span class="string">"remark"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				lang = json.getString(<span class="string">"lang"</span>);</span><br><span class="line">				weihao = json.getString(<span class="string">"weihao"</span>);</span><br><span class="line">				<span class="keyword">if</span> (!json.isNull(<span class="string">"status"</span>)) &#123;</span><br><span class="line">					status = <span class="keyword">new</span> Status(json.getJSONObject(<span class="string">"status"</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone.getMessage() + <span class="string">":"</span></span><br><span class="line">						+ json.toString(), jsone);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String[] constructIds(Response res) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			JSONArray list = res.asJSONObject().getJSONArray(<span class="string">"ids"</span>);</span><br><span class="line">			String temp = list.toString().substring(<span class="number">1</span>,</span><br><span class="line">					list.toString().length() - <span class="number">1</span>);</span><br><span class="line">			String[] ids = temp.split(<span class="string">","</span>);</span><br><span class="line">			<span class="keyword">return</span> ids;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone.getMessage() + <span class="string">":"</span></span><br><span class="line">					+ jsone.toString(), jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> res</span><br><span class="line">	 * <span class="doctag">@return</span></span><br><span class="line">	 * <span class="doctag">@throws</span> WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserWapper <span class="title">constructWapperUsers</span><span class="params">(Response res)</span></span><br><span class="line">			<span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		JSONObject jsonUsers = res.asJSONObject(); <span class="comment">// asJSONArray();</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			JSONArray user = jsonUsers.getJSONArray(<span class="string">"users"</span>);</span><br><span class="line">			<span class="keyword">int</span> size = user.length();</span><br><span class="line">			List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;User&gt;(size);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">				users.add(<span class="keyword">new</span> User(user.getJSONObject(i)));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">long</span> previousCursor = jsonUsers.getLong(<span class="string">"previous_curosr"</span>);</span><br><span class="line">			<span class="keyword">long</span> nextCursor = jsonUsers.getLong(<span class="string">"next_cursor"</span>);</span><br><span class="line">			<span class="keyword">long</span> totalNumber = jsonUsers.getLong(<span class="string">"total_number"</span>);</span><br><span class="line">			String hasvisible = jsonUsers.getString(<span class="string">"hasvisible"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> UserWapper(users, previousCursor, nextCursor,</span><br><span class="line">					totalNumber, hasvisible);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> res</span><br><span class="line">	 * <span class="doctag">@return</span></span><br><span class="line">	 * <span class="doctag">@throws</span> WeiboException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> List&lt;User&gt; <span class="title">constructResult</span><span class="params">(Response res)</span> <span class="keyword">throws</span> WeiboException </span>&#123;</span><br><span class="line">		JSONArray list = res.asJSONArray();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> size = list.length();</span><br><span class="line">			List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;User&gt;(size);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">				users.add(<span class="keyword">new</span> User(list.getJSONObject(i)));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> users;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getScreenName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> screenName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getProvince</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> province;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> city;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLocation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> location;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> description;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> URL <span class="title">getProfileImageURL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> URL(profileImageUrl);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (MalformedURLException ex) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> URL <span class="title">getURL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> URL(url);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (MalformedURLException ex) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUserDomain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userDomain;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> gender;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFollowersCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> followersCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFriendsCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> friendsCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStatusesCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> statusesCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFavouritesCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> favouritesCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getCreatedAt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> createdAt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFollowing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> following;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isVerified</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> verified;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getverifiedType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> verifiedType;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isallowAllActMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> allowAllActMsg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isallowAllComment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> allowAllComment;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isfollowMe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> followMe;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getavatarLarge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> avatarLarge;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getonlineStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> onlineStatus;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Status <span class="title">getStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> status;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getbiFollowersCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> biFollowersCount;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRemark</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> remark;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLang</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lang;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> prime = <span class="number">31</span>;</span><br><span class="line">		<span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">		result = prime * result + ((id == <span class="keyword">null</span>) ? <span class="number">0</span> : id.hashCode());</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> == obj)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (getClass() != obj.getClass())</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		User other = (User) obj;</span><br><span class="line">		<span class="keyword">if</span> (id == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (other.id != <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!id.equals(other.id))</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"User ["</span> + <span class="string">"id="</span> + id + <span class="string">", screenName="</span> + screenName + <span class="string">", name="</span></span><br><span class="line">				+ name + <span class="string">", province="</span> + province + <span class="string">", city="</span> + city</span><br><span class="line">				+ <span class="string">", location="</span> + location + <span class="string">", description="</span> + description</span><br><span class="line">				+ <span class="string">", url="</span> + url + <span class="string">", profileImageUrl="</span> + profileImageUrl</span><br><span class="line">				+ <span class="string">", userDomain="</span> + userDomain + <span class="string">", gender="</span> + gender</span><br><span class="line">				+ <span class="string">", followersCount="</span> + followersCount + <span class="string">", friendsCount="</span></span><br><span class="line">				+ friendsCount + <span class="string">", statusesCount="</span> + statusesCount</span><br><span class="line">				+ <span class="string">", favouritesCount="</span> + favouritesCount + <span class="string">", createdAt="</span></span><br><span class="line">				+ createdAt + <span class="string">", following="</span> + following + <span class="string">", verified="</span></span><br><span class="line">				+ verified + <span class="string">", verifiedType="</span> + verifiedType</span><br><span class="line">				+ <span class="string">", allowAllActMsg="</span> + allowAllActMsg + <span class="string">", allowAllComment="</span></span><br><span class="line">				+ allowAllComment + <span class="string">", followMe="</span> + followMe + <span class="string">", avatarLarge="</span></span><br><span class="line">				+ avatarLarge + <span class="string">", onlineStatus="</span> + onlineStatus + <span class="string">", status="</span></span><br><span class="line">				+ status + <span class="string">", biFollowersCount="</span> + biFollowersCount</span><br><span class="line">				+ <span class="string">", remark="</span> + remark + <span class="string">", lang="</span> + lang + <span class="string">", verifiedReason="</span></span><br><span class="line">				+ verifiedReason + <span class="string">", weihao="</span> + weihao + <span class="string">", statusId="</span></span><br><span class="line">				+ statusId + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UserTrend-java">UserTrend.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.http.Response;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="keyword">JSONArray</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="keyword">JSONObject</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 话题</span><br><span class="line"> * </span><br><span class="line"> * @author SinaWeibo</span><br><span class="line"> * @since weibo4j-V2 1.0.0</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class UserTrend extends WeiboResponse &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> num;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> hotword = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">String</span> trendId = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1925956704460743946</span>L;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> UserTrend() &#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> UserTrend(Response res) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">super</span>(res);</span><br><span class="line">		<span class="keyword">JSONObject</span> json = res.asJSONObject();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			num = json.getString(<span class="string">"num"</span>);</span><br><span class="line">			hotword = json.getString(<span class="string">"hotword"</span>);</span><br><span class="line">			trendId = json.getString(<span class="string">"trend_id"</span>);</span><br><span class="line">			<span class="keyword">if</span> (json.getString(<span class="string">"topicid"</span>) != <span class="keyword">null</span>)</span><br><span class="line">				trendId = json.getString(<span class="string">"topicid"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException je) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(je.getMessage() + <span class="string">":"</span> + json.toString(),</span><br><span class="line">					je);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> UserTrend(<span class="keyword">JSONObject</span> json) <span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			num = json.getString(<span class="string">"num"</span>);</span><br><span class="line">			hotword = json.getString(<span class="string">"hotword"</span>);</span><br><span class="line">			trendId = json.getString(<span class="string">"trend_id"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException je) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(je.getMessage() + <span class="string">":"</span> + json.toString(),</span><br><span class="line">					je);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> List&lt;UserTrend&gt; constructTrendList(Response res)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">JSONArray</span> list = res.asJSONArray();</span><br><span class="line">			<span class="built_in">int</span> <span class="built_in">size</span> = list.length();</span><br><span class="line">			List&lt;UserTrend&gt; trends = <span class="keyword">new</span> ArrayList&lt;UserTrend&gt;(<span class="built_in">size</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">size</span>; i++) &#123;</span><br><span class="line">				trends.<span class="built_in">add</span>(<span class="keyword">new</span> UserTrend(list.getJSONObject(i)));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> trends;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException jsone) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(jsone);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (WeiboException te) &#123;</span><br><span class="line">			<span class="keyword">throw</span> te;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getNum() &#123;</span><br><span class="line">		<span class="keyword">return</span> num;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setNum(<span class="keyword">String</span> num) &#123;</span><br><span class="line">		<span class="keyword">this</span>.num = num;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getHotword() &#123;</span><br><span class="line">		<span class="keyword">return</span> hotword;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> setHotword(<span class="keyword">String</span> hotword) &#123;</span><br><span class="line">		<span class="keyword">this</span>.hotword = hotword;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> gettrendId() &#123;</span><br><span class="line">		<span class="keyword">return</span> trendId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> settrendId(<span class="keyword">String</span> trendId) &#123;</span><br><span class="line">		<span class="keyword">this</span>.trendId = trendId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Trend [num="</span> + num + <span class="string">", hotword="</span> + hotword + <span class="string">", trendId="</span></span><br><span class="line">				+ trendId + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UserWapper-java">UserWapper.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">这里写代码片</span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 对User对象列表进行的包装，以支持cursor相关信息传递</span><br><span class="line"> * </span><br><span class="line"> * <span class="doctag">@author</span> sinaWeibo</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserWapper</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">3119107701303920284L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 用户对象列表</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 向前翻页的cursor</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> previousCursor;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 向后翻页的cursor</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> nextCursor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> totalNumber;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String hasvisible;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UserWapper</span><span class="params">(List&lt;User&gt; users, <span class="keyword">long</span> previousCursor, <span class="keyword">long</span> nextCursor,</span><br><span class="line">			<span class="keyword">long</span> totalNumber, String hasvisible)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.users = users;</span><br><span class="line">		<span class="keyword">this</span>.previousCursor = previousCursor;</span><br><span class="line">		<span class="keyword">this</span>.nextCursor = nextCursor;</span><br><span class="line">		<span class="keyword">this</span>.totalNumber = totalNumber;</span><br><span class="line">		<span class="keyword">this</span>.hasvisible = hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> users;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(List&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.users = users;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getPreviousCursor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> previousCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPreviousCursor</span><span class="params">(<span class="keyword">long</span> previousCursor)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.previousCursor = previousCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getNextCursor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> nextCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextCursor</span><span class="params">(<span class="keyword">long</span> nextCursor)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.nextCursor = nextCursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getTotalNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> totalNumber;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotalNumber</span><span class="params">(<span class="keyword">long</span> totalNumber)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.totalNumber = totalNumber;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getHasvisible</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasvisible</span><span class="params">(String hasvisible)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.hasvisible = hasvisible;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Version-java">Version.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Version &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">String</span> VERSION = <span class="string">"1.0.0"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">String</span> TITLE = <span class="string">"weibo4jV2"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getVersion() &#123;</span><br><span class="line">		<span class="keyword">return</span> VERSION;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">		System.out.<span class="built_in">println</span>(TITLE + <span class="string">" "</span> + VERSION);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Visible-java">Visible.java</h2><figure class="highlight nimrod"><table><tr><td class="code"><pre><span class="line">package weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="type">JSONException</span>;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="type">JSONObject</span>;</span><br><span class="line"></span><br><span class="line">public class <span class="type">Visible</span> &#123;</span><br><span class="line">	private <span class="type">int</span> <span class="keyword">type</span>;</span><br><span class="line">	private <span class="type">int</span> list_id;</span><br><span class="line"></span><br><span class="line">	public <span class="type">Visible</span>(<span class="type">JSONObject</span> json) throws <span class="type">JSONException</span> &#123;</span><br><span class="line">		this.<span class="keyword">type</span> = json.getInt(<span class="string">"type"</span>);</span><br><span class="line">		this.list_id = json.getInt(<span class="string">"list_id"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">int</span> getType() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">type</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">void</span> setType(<span class="type">int</span> <span class="keyword">type</span>) &#123;</span><br><span class="line">		this.<span class="keyword">type</span> = <span class="keyword">type</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">int</span> getList_id() &#123;</span><br><span class="line">		<span class="keyword">return</span> list_id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">void</span> setList_id(<span class="type">int</span> list_id) &#123;</span><br><span class="line">		this.list_id = list_id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public <span class="type">int</span> hashCode() &#123;</span><br><span class="line">		final <span class="type">int</span> prime = <span class="number">31</span>;</span><br><span class="line">		<span class="type">int</span> <span class="literal">result</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="literal">result</span> = prime * <span class="literal">result</span> + list_id;</span><br><span class="line">		<span class="literal">result</span> = prime * <span class="literal">result</span> + <span class="keyword">type</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public boolean equals(<span class="type">Object</span> obj) &#123;</span><br><span class="line">		<span class="keyword">if</span> (this == obj)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (obj == null)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (getClass() != obj.getClass())</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="type">Visible</span> other = (<span class="type">Visible</span>) obj;</span><br><span class="line">		<span class="keyword">if</span> (list_id != other.list_id)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">type</span> != other.<span class="keyword">type</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@<span class="type">Override</span></span><br><span class="line">	public <span class="type">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Visible [type="</span> + <span class="keyword">type</span> + <span class="string">", list_id="</span> + list_id + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="WeiboException-java">WeiboException.java</h2><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONObject;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeiboException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> statusCode = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> errorCode = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> String request;</span><br><span class="line">	<span class="keyword">private</span> String <span class="keyword">error</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">2623309261327598087</span>L;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(msg);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(Exception cause)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(cause);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(String msg, <span class="keyword">int</span> statusCode)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(msg);</span><br><span class="line">		<span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(String msg, JSONObject json, <span class="keyword">int</span> statusCode)</span></span><br><span class="line">			<span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(msg + <span class="string">"\n error:"</span> + json.getString(<span class="string">"error"</span>) + <span class="string">" error_code:"</span></span><br><span class="line">				+ json.getInt(<span class="string">"error_code"</span>) + json.getString(<span class="string">"request"</span>));</span><br><span class="line">		<span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line">		<span class="keyword">this</span>.errorCode = json.getInt(<span class="string">"error_code"</span>);</span><br><span class="line">		<span class="keyword">this</span>.<span class="keyword">error</span> = json.getString(<span class="string">"error"</span>);</span><br><span class="line">		<span class="keyword">this</span>.request = json.getString(<span class="string">"request"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(String msg, Exception cause)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(msg, cause);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WeiboException</span><span class="params">(String msg, Exception cause, <span class="keyword">int</span> statusCode)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(msg, cause);</span><br><span class="line">		<span class="keyword">this</span>.statusCode = statusCode;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getStatusCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.statusCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getErrorCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> errorCode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getRequest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> request;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">getError</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">error</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="WeiboResponse-java">WeiboResponse.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> weibo4j.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Element;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Node;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.NodeList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> weibo4j.http.HTMLEntity;</span><br><span class="line"><span class="keyword">import</span> weibo4j.http.Response;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> weibo4j.org.json.<span class="keyword">JSONObject</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.<span class="built_in">text</span>.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.<span class="built_in">text</span>.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class WeiboResponse implements java.io.Serializable &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Map&lt;<span class="keyword">String</span>, SimpleDateFormat&gt; formatMap = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, SimpleDateFormat&gt;();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">3519962197957449562</span>L;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="built_in">int</span> rateLimitLimit = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="built_in">int</span> rateLimitRemaining = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">long</span> rateLimitReset = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">boolean</span> IS_DALVIK = Configuration.isDalvik();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> WeiboResponse() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> WeiboResponse(Response res) &#123;</span><br><span class="line">		<span class="keyword">String</span> limit = res.getResponseHeader(<span class="string">"X-RateLimit-Limit"</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != limit) &#123;</span><br><span class="line">			rateLimitLimit = Integer.parseInt(limit);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">String</span> remaining = res.getResponseHeader(<span class="string">"X-RateLimit-Remaining"</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != remaining) &#123;</span><br><span class="line">			rateLimitRemaining = Integer.parseInt(remaining);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">String</span> reset = res.getResponseHeader(<span class="string">"X-RateLimit-Reset"</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != reset) &#123;</span><br><span class="line">			rateLimitReset = Long.parseLong(reset);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">void</span> ensureRootNodeNameIs(<span class="keyword">String</span> rootName, Element elem)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (!rootName.equals(elem.getNodeName())) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">					<span class="string">"Unexpected root node name:"</span></span><br><span class="line">							+ elem.getNodeName()</span><br><span class="line">							+ <span class="string">". Expected:"</span></span><br><span class="line">							+ rootName</span><br><span class="line">							+ <span class="string">". Check the availability of the Weibo API at http://open.t.sina.com.cn/."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">void</span> ensureRootNodeNameIs(<span class="keyword">String</span>[] rootNames, Element elem)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">String</span> actualRootName = elem.getNodeName();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">String</span> rootName : rootNames) &#123;</span><br><span class="line">			<span class="keyword">if</span> (rootName.equals(actualRootName)) &#123;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">String</span> expected = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; rootNames.length; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i != <span class="number">0</span>) &#123;</span><br><span class="line">				expected += <span class="string">" or "</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			expected += rootNames[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">				<span class="string">"Unexpected root node name:"</span></span><br><span class="line">						+ elem.getNodeName()</span><br><span class="line">						+ <span class="string">". Expected:"</span></span><br><span class="line">						+ expected</span><br><span class="line">						+ <span class="string">". Check the availability of the Weibo API at http://open.t.sina.com.cn/."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">void</span> ensureRootNodeNameIs(<span class="keyword">String</span> rootName, Document doc)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		Element elem = doc.getDocumentElement();</span><br><span class="line">		<span class="keyword">if</span> (!rootName.equals(elem.getNodeName())) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(</span><br><span class="line">					<span class="string">"Unexpected root node name:"</span></span><br><span class="line">							+ elem.getNodeName()</span><br><span class="line">							+ <span class="string">". Expected:"</span></span><br><span class="line">							+ rootName</span><br><span class="line">							+ <span class="string">". Check the availability of the Weibo API at http://open.t.sina.com.cn/"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="built_in">boolean</span> isRootNodeNilClasses(Document doc) &#123;</span><br><span class="line">		<span class="keyword">String</span> root = doc.getDocumentElement().getNodeName();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"nil-classes"</span>.equals(root) || <span class="string">"nilclasses"</span>.equals(root);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">String</span> getChildText(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem) &#123;</span><br><span class="line">		<span class="keyword">return</span> HTMLEntity.unescape(getTextContent(<span class="built_in">str</span>, elem));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">String</span> getTextContent(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem) &#123;</span><br><span class="line">		NodeList nodelist = elem.getElementsByTagName(<span class="built_in">str</span>);</span><br><span class="line">		<span class="keyword">if</span> (nodelist.getLength() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			Node node = nodelist.item(<span class="number">0</span>).getFirstChild();</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">null</span> != node) &#123;</span><br><span class="line">				<span class="keyword">String</span> nodeValue = node.getNodeValue();</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">null</span> != nodeValue ? nodeValue : <span class="string">""</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* modify by sycheng add "".equals(str) */</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="built_in">int</span> getChildInt(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem) &#123;</span><br><span class="line">		<span class="keyword">String</span> str2 = getTextContent(<span class="built_in">str</span>, elem);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == str2 || <span class="string">""</span>.equals(str2) || <span class="string">"null"</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> Integer.valueOf(str2);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">long</span> getChildLong(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem) &#123;</span><br><span class="line">		<span class="keyword">String</span> str2 = getTextContent(<span class="built_in">str</span>, elem);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == str2 || <span class="string">""</span>.equals(str2) || <span class="string">"null"</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> Long.valueOf(str2);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">String</span> getString(<span class="keyword">String</span> name, <span class="keyword">JSONObject</span> json,</span><br><span class="line">			<span class="built_in">boolean</span> decode) &#123;</span><br><span class="line">		<span class="keyword">String</span> returnValue = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			returnValue = json.getString(name);</span><br><span class="line">			<span class="keyword">if</span> (decode) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					returnValue = URLDecoder.decode(returnValue, <span class="string">"UTF-8"</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (UnsupportedEncodingException ignore) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (JSONException ignore) &#123;</span><br><span class="line">			<span class="comment">// refresh_url could be missing</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> returnValue;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="built_in">boolean</span> getChildBoolean(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem) &#123;</span><br><span class="line">		<span class="keyword">String</span> value = getTextContent(<span class="built_in">str</span>, elem);</span><br><span class="line">		<span class="keyword">return</span> Boolean.valueOf(value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> Date getChildDate(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">return</span> getChildDate(<span class="built_in">str</span>, elem, <span class="string">"EEE MMM d HH:mm:ss z yyyy"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> Date getChildDate(<span class="keyword">String</span> <span class="built_in">str</span>, Element elem, <span class="keyword">String</span> format)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">return</span> parseDate(getChildText(<span class="built_in">str</span>, elem), format);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> Date parseDate(<span class="keyword">String</span> <span class="built_in">str</span>, <span class="keyword">String</span> format)</span><br><span class="line">			<span class="keyword">throws</span> WeiboException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">str</span> == <span class="keyword">null</span> || <span class="string">""</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		SimpleDateFormat sdf = formatMap.<span class="built_in">get</span>(format);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == sdf) &#123;</span><br><span class="line">			sdf = <span class="keyword">new</span> SimpleDateFormat(format, Locale.ENGLISH);</span><br><span class="line">			sdf.setTimeZone(TimeZone.getTimeZone(<span class="string">"GMT"</span>));</span><br><span class="line">			formatMap.put(format, sdf);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (sdf) &#123;</span><br><span class="line">				<span class="comment">// SimpleDateFormat is not thread safe</span></span><br><span class="line">				<span class="keyword">return</span> sdf.parse(<span class="built_in">str</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParseException pe) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> WeiboException(<span class="string">"Unexpected format("</span> + <span class="built_in">str</span></span><br><span class="line">					+ <span class="string">") returned from sina.com.cn"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="built_in">int</span> getInt(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">JSONObject</span> json)</span><br><span class="line">			<span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span> = json.getString(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == <span class="built_in">str</span> || <span class="string">""</span>.equals(<span class="built_in">str</span>) || <span class="string">"null"</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Integer.parseInt(<span class="built_in">str</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">long</span> getLong(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">JSONObject</span> json)</span><br><span class="line">			<span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span> = json.getString(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == <span class="built_in">str</span> || <span class="string">""</span>.equals(<span class="built_in">str</span>) || <span class="string">"null"</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Long.parseLong(<span class="built_in">str</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">static</span> <span class="built_in">boolean</span> getBoolean(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">JSONObject</span> json)</span><br><span class="line">			<span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">String</span> <span class="built_in">str</span> = json.getString(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == <span class="built_in">str</span> || <span class="string">""</span>.equals(<span class="built_in">str</span>) || <span class="string">"null"</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Boolean.valueOf(<span class="built_in">str</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> getRateLimitLimit() &#123;</span><br><span class="line">		<span class="keyword">return</span> rateLimitLimit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> getRateLimitRemaining() &#123;</span><br><span class="line">		<span class="keyword">return</span> rateLimitRemaining;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> getRateLimitReset() &#123;</span><br><span class="line">		<span class="keyword">return</span> rateLimitReset;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="weibo4j-org-json包">weibo4j.org.json包</h1><h2 id="CDL-java">CDL.java</h2><figure class="highlight zephir"><table><tr><td class="code"><pre><span class="line">package weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CDL</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next value. The value can be wrapped in quotes. The value can be</span><br><span class="line">	 * empty.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            A JSONTokener of the source text.</span><br><span class="line">	 * <span class="doctag">@return</span> The value string, or null if empty.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             if the quoted string is badly formed.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String getValue(JSONTokener x) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			c = x.next();</span><br><span class="line">		&#125; <span class="keyword">while</span> (c == <span class="string">' '</span> || c == <span class="string">'\t'</span>);</span><br><span class="line">		<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'"'</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'\''</span>:</span><br><span class="line">			<span class="keyword">return</span> x.nextString(c);</span><br><span class="line">		<span class="keyword">case</span> <span class="string">','</span>:</span><br><span class="line">			x.back();</span><br><span class="line">			<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			x.back();</span><br><span class="line">			<span class="keyword">return</span> x.nextTo(<span class="string">','</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray of strings from a row of comma delimited values.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            A JSONTokener of the source text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray of strings.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONArray rowToJSONArray(JSONTokener x) throws JSONException &#123;</span><br><span class="line">		JSONArray ja = <span class="keyword">new</span> JSONArray();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			String value = getValue(x);</span><br><span class="line">			<span class="keyword">if</span> (value == <span class="keyword">null</span> || (ja.length() == <span class="number">0</span> &amp;&amp; value.length() == <span class="number">0</span>)) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			ja.put(value);</span><br><span class="line">			<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">				<span class="keyword">char</span> c = x.next();</span><br><span class="line">				<span class="keyword">if</span> (c == <span class="string">','</span>) &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (c != <span class="string">' '</span>) &#123;</span><br><span class="line">					<span class="keyword">if</span> (c == <span class="string">'\n'</span> || c == <span class="string">'\r'</span> || c == <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="keyword">return</span> ja;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">throw</span> x.syntaxError(<span class="string">"Bad character '"</span> + c + <span class="string">"' ("</span> + (<span class="keyword">int</span>) c</span><br><span class="line">							+ <span class="string">")."</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONObject from a row of comma delimited text, using a parallel</span><br><span class="line">	 * JSONArray of strings to provides the names of the elements.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> names</span><br><span class="line">	 *            A JSONArray of names. This is commonly obtained from the first</span><br><span class="line">	 *            row of a comma delimited text file using the rowToJSONArray</span><br><span class="line">	 *            method.</span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            A JSONTokener of the source text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONObject combining the names and values.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONObject rowToJSONObject(JSONArray names, JSONTokener x)</span><br><span class="line">			throws JSONException &#123;</span><br><span class="line">		JSONArray ja = rowToJSONArray(x);</span><br><span class="line">		<span class="keyword">return</span> ja != <span class="keyword">null</span> ? ja.toJSONObject(names) : <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray of JSONObjects from a comma delimited text string,</span><br><span class="line">	 * using the first row as a source of names.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> string</span><br><span class="line">	 *            The comma delimited text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONArray toJSONArray(String string) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> toJSONArray(<span class="keyword">new</span> JSONTokener(string));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray of JSONObjects from a comma delimited text string,</span><br><span class="line">	 * using the first row as a source of names.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            The JSONTokener containing the comma delimited text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONArray toJSONArray(JSONTokener x) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> toJSONArray(rowToJSONArray(x), x);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray of JSONObjects from a comma delimited text string</span><br><span class="line">	 * using a supplied JSONArray as the source of element names.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> names</span><br><span class="line">	 *            A JSONArray of strings.</span><br><span class="line">	 * <span class="doctag">@param</span> string</span><br><span class="line">	 *            The comma delimited text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONArray toJSONArray(JSONArray names, String string)</span><br><span class="line">			throws JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> toJSONArray(names, <span class="keyword">new</span> JSONTokener(string));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray of JSONObjects from a comma delimited text string</span><br><span class="line">	 * using a supplied JSONArray as the source of element names.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> names</span><br><span class="line">	 *            A JSONArray of strings.</span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            A JSONTokener of the source text.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> JSONArray toJSONArray(JSONArray names, JSONTokener x)</span><br><span class="line">			throws JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (names == <span class="keyword">null</span> || names.length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		JSONArray ja = <span class="keyword">new</span> JSONArray();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			JSONObject jo = rowToJSONObject(names, x);</span><br><span class="line">			<span class="keyword">if</span> (jo == <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			ja.put(jo);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (ja.length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ja;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a comma delimited text row from a JSONArray. Values containing</span><br><span class="line">	 * the comma character will be quoted.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> ja</span><br><span class="line">	 *            A JSONArray of strings.</span><br><span class="line">	 * <span class="doctag">@return</span> A string ending in NEWLINE.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String rowToString(JSONArray ja) &#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ja.length(); i += <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				sb.append(<span class="string">','</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			Object o = ja.opt(i);</span><br><span class="line">			<span class="keyword">if</span> (o != <span class="keyword">null</span>) &#123;</span><br><span class="line">				String s = o.toString();</span><br><span class="line">				<span class="keyword">if</span> (s.indexOf(<span class="string">','</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">if</span> (s.indexOf(<span class="string">'"'</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">						sb.append(<span class="string">'\''</span>);</span><br><span class="line">						sb.append(s);</span><br><span class="line">						sb.append(<span class="string">'\''</span>);</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						sb.append(<span class="string">'"'</span>);</span><br><span class="line">						sb.append(s);</span><br><span class="line">						sb.append(<span class="string">'"'</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					sb.append(s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sb.append(<span class="string">'\n'</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a comma delimited text from a JSONArray of JSONObjects. The first</span><br><span class="line">	 * row will be a list of names obtained by inspecting the first JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> ja</span><br><span class="line">	 *            A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@return</span> A comma delimited text.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String toString(JSONArray ja) throws JSONException &#123;</span><br><span class="line">		JSONObject jo = ja.optJSONObject(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span> (jo != <span class="keyword">null</span>) &#123;</span><br><span class="line">			JSONArray names = jo.names();</span><br><span class="line">			<span class="keyword">if</span> (names != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> rowToString(names) + toString(names, ja);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a comma delimited text from a JSONArray of JSONObjects using a</span><br><span class="line">	 * provided list of names. The list of names is not included in the output.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> names</span><br><span class="line">	 *            A JSONArray of strings.</span><br><span class="line">	 * <span class="doctag">@param</span> ja</span><br><span class="line">	 *            A JSONArray of JSONObjects.</span><br><span class="line">	 * <span class="doctag">@return</span> A comma delimited text.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String toString(JSONArray names, JSONArray ja)</span><br><span class="line">			throws JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (names == <span class="keyword">null</span> || names.length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ja.length(); i += <span class="number">1</span>) &#123;</span><br><span class="line">			JSONObject jo = ja.optJSONObject(i);</span><br><span class="line">			<span class="keyword">if</span> (jo != <span class="keyword">null</span>) &#123;</span><br><span class="line">				sb.append(rowToString(jo.toJSONArray(names)));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Cookie-java">Cookie.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Cookie &#123;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> escape(<span class="keyword">String</span> string) &#123;</span><br><span class="line">		<span class="built_in">char</span> c;</span><br><span class="line">		<span class="keyword">String</span> s = string.<span class="built_in">trim</span>();</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="built_in">int</span> len = s.length();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">1</span>) &#123;</span><br><span class="line">			c = s.charAt(i);</span><br><span class="line">			<span class="keyword">if</span> (c &lt; <span class="string">' '</span> || c == <span class="string">'+'</span> || c == <span class="string">'%'</span> || c == <span class="string">'='</span> || c == <span class="string">';'</span>) &#123;</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">'%'</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(Character.forDigit((<span class="built_in">char</span>) ((c &gt;&gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0f</span>), <span class="number">16</span>));</span><br><span class="line">				sb.<span class="built_in">append</span>(Character.forDigit((<span class="built_in">char</span>) (c &amp; <span class="number">0x0f</span>), <span class="number">16</span>));</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				sb.<span class="built_in">append</span>(c);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert a cookie specification string into a JSONObject. The string will</span><br><span class="line">	 * contain a name value pair separated by '='. The name and the value will</span><br><span class="line">	 * be unescaped, possibly converting '+' and '%' sequences. The cookie</span><br><span class="line">	 * properties may follow, separated by ';', also represented as name=value</span><br><span class="line">	 * (except the secure property, which does not have a value). The name will</span><br><span class="line">	 * be stored under the key "name", and the value will be stored under the</span><br><span class="line">	 * key "value". This method does not do checking or validation of the</span><br><span class="line">	 * parameters. It only converts the cookie string into a JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param string</span><br><span class="line">	 *            The cookie specification string.</span><br><span class="line">	 * @return A JSONObject containing "name", "value", and possibly other</span><br><span class="line">	 *         members.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">JSONObject</span> toJSONObject(<span class="keyword">String</span> string) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">String</span> n;</span><br><span class="line">		<span class="keyword">JSONObject</span> o = <span class="keyword">new</span> <span class="keyword">JSONObject</span>();</span><br><span class="line">		<span class="keyword">Object</span> v;</span><br><span class="line">		JSONTokener x = <span class="keyword">new</span> JSONTokener(string);</span><br><span class="line">		o.put(<span class="string">"name"</span>, x.nextTo(<span class="string">'='</span>));</span><br><span class="line">		x.next(<span class="string">'='</span>);</span><br><span class="line">		o.put(<span class="string">"value"</span>, x.nextTo(<span class="string">';'</span>));</span><br><span class="line">		x.next();</span><br><span class="line">		<span class="keyword">while</span> (x.more()) &#123;</span><br><span class="line">			n = unescape(x.nextTo(<span class="string">"=;"</span>));</span><br><span class="line">			<span class="keyword">if</span> (x.next() != <span class="string">'='</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (n.equals(<span class="string">"secure"</span>)) &#123;</span><br><span class="line">					v = Boolean.TRUE;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">throw</span> x.syntaxError(<span class="string">"Missing '=' in cookie parameter."</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				v = unescape(x.nextTo(<span class="string">';'</span>));</span><br><span class="line">				x.next();</span><br><span class="line">			&#125;</span><br><span class="line">			o.put(n, v);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert a JSONObject into a cookie specification string. The JSONObject</span><br><span class="line">	 * must contain "name" and "value" members. If the JSONObject contains</span><br><span class="line">	 * "expires", "domain", "path", or "secure" members, they will be appended</span><br><span class="line">	 * to the cookie specification string. All other members are ignored.</span><br><span class="line">	 * </span><br><span class="line">	 * @param o</span><br><span class="line">	 *            A JSONObject</span><br><span class="line">	 * @return A cookie specification string</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> toString(<span class="keyword">JSONObject</span> o) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">		sb.<span class="built_in">append</span>(escape(o.getString(<span class="string">"name"</span>)));</span><br><span class="line">		sb.<span class="built_in">append</span>(<span class="string">"="</span>);</span><br><span class="line">		sb.<span class="built_in">append</span>(escape(o.getString(<span class="string">"value"</span>)));</span><br><span class="line">		<span class="keyword">if</span> (o.has(<span class="string">"expires"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">";expires="</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"expires"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (o.has(<span class="string">"domain"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">";domain="</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(escape(o.getString(<span class="string">"domain"</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (o.has(<span class="string">"path"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">";path="</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(escape(o.getString(<span class="string">"path"</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (o.optBoolean(<span class="string">"secure"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">";secure"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert &lt;code&gt;%&lt;/code&gt;&lt;i&gt;hh&lt;/i&gt; sequences to single characters, and</span><br><span class="line">	 * convert plus to space.</span><br><span class="line">	 * </span><br><span class="line">	 * @param s</span><br><span class="line">	 *            A string that may contain &lt;code&gt;+&lt;/code&gt;</span><br><span class="line">	 *            &amp;nbsp;&lt;small&gt;(plus)&lt;/small&gt; and &lt;code&gt;%&lt;/code&gt;&lt;i&gt;hh&lt;/i&gt;</span><br><span class="line">	 *            sequences.</span><br><span class="line">	 * @return The unescaped string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> unescape(<span class="keyword">String</span> s) &#123;</span><br><span class="line">		<span class="built_in">int</span> len = s.length();</span><br><span class="line">		StringBuffer b = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">			<span class="built_in">char</span> c = s.charAt(i);</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="string">'+'</span>) &#123;</span><br><span class="line">				c = <span class="string">' '</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'%'</span> &amp;&amp; i + <span class="number">2</span> &lt; len) &#123;</span><br><span class="line">				<span class="built_in">int</span> d = JSONTokener.dehexchar(s.charAt(i + <span class="number">1</span>));</span><br><span class="line">				<span class="built_in">int</span> e = JSONTokener.dehexchar(s.charAt(i + <span class="number">2</span>));</span><br><span class="line">				<span class="keyword">if</span> (d &gt;= <span class="number">0</span> &amp;&amp; e &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">					c = (<span class="built_in">char</span>) (d * <span class="number">16</span> + e);</span><br><span class="line">					i += <span class="number">2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			b.<span class="built_in">append</span>(c);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="CookieList-java">CookieList.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class CookieList &#123;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">JSONObject</span> toJSONObject(<span class="keyword">String</span> string) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">JSONObject</span> o = <span class="keyword">new</span> <span class="keyword">JSONObject</span>();</span><br><span class="line">		JSONTokener x = <span class="keyword">new</span> JSONTokener(string);</span><br><span class="line">		<span class="keyword">while</span> (x.more()) &#123;</span><br><span class="line">			<span class="keyword">String</span> name = Cookie.unescape(x.nextTo(<span class="string">'='</span>));</span><br><span class="line">			x.next(<span class="string">'='</span>);</span><br><span class="line">			o.put(name, Cookie.unescape(x.nextTo(<span class="string">';'</span>)));</span><br><span class="line">			x.next();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert a JSONObject into a cookie list. A cookie list is a sequence of</span><br><span class="line">	 * name/value pairs. The names are separated from the values by '='. The</span><br><span class="line">	 * pairs are separated by ';'. The characters '%', '+', '=', and ';' in the</span><br><span class="line">	 * names and values are replaced by "%hh".</span><br><span class="line">	 * </span><br><span class="line">	 * @param o</span><br><span class="line">	 *            A JSONObject</span><br><span class="line">	 * @return A cookie list string</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> toString(<span class="keyword">JSONObject</span> o) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="built_in">boolean</span> b = <span class="keyword">false</span>;</span><br><span class="line">		Iterator keys = o.keys();</span><br><span class="line">		<span class="keyword">String</span> s;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">			s = keys.next().toString();</span><br><span class="line">			<span class="keyword">if</span> (!o.isNull(s)) &#123;</span><br><span class="line">				<span class="keyword">if</span> (b) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">';'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				sb.<span class="built_in">append</span>(Cookie.escape(s));</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"="</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(Cookie.escape(o.getString(s)));</span><br><span class="line">				b = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HTTP-java">HTTP.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Convert an HTTP header to a JSONObject and back.</span><br><span class="line"> * </span><br><span class="line"> * @author JSON.org</span><br><span class="line"> * @version 2008-09-18</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class HTTP &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Carriage return/line feed. */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> CRLF = <span class="string">"\r\n"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert an HTTP header string into a JSONObject. It can be a request</span><br><span class="line">	 * header or a response header. A request header will contain</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 * &#123;</span><br><span class="line">	 *    Method: "POST" (for example),</span><br><span class="line">	 *    "Request-URI": "/" (for example),</span><br><span class="line">	 *    "HTTP-Version": "HTTP/1.1" (for example)</span><br><span class="line">	 * &#125;</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * A response header will contain</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 * &#123;</span><br><span class="line">	 *    "HTTP-Version": "HTTP/1.1" (for example),</span><br><span class="line">	 *    "Status-Code": "200" (for example),</span><br><span class="line">	 *    "Reason-Phrase": "OK" (for example)</span><br><span class="line">	 * &#125;</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * In addition, the other parameters in the header will be captured, using</span><br><span class="line">	 * the HTTP field names as JSON names, so that</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 *    Date: Sun, 26 May 2002 18:06:04 GMT</span><br><span class="line">	 *    Cookie: Q=q2=PPEAsg--; B=677gi6ouf29bn&amp;b=2&amp;f=s</span><br><span class="line">	 *    Cache-Control: no-cache</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * become</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 * &#123;...</span><br><span class="line">	 *    Date: "Sun, 26 May 2002 18:06:04 GMT",</span><br><span class="line">	 *    Cookie: "Q=q2=PPEAsg--; B=677gi6ouf29bn&amp;b=2&amp;f=s",</span><br><span class="line">	 *    "Cache-Control": "no-cache",</span><br><span class="line">	 * ...&#125;</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * It does no further checking or conversion. It does not parse dates. It</span><br><span class="line">	 * does not do '%' transforms on URLs.</span><br><span class="line">	 * </span><br><span class="line">	 * @param string</span><br><span class="line">	 *            An HTTP header string.</span><br><span class="line">	 * @return A JSONObject containing the elements and attributes of the XML</span><br><span class="line">	 *         string.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">JSONObject</span> toJSONObject(<span class="keyword">String</span> string) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">JSONObject</span> o = <span class="keyword">new</span> <span class="keyword">JSONObject</span>();</span><br><span class="line">		HTTPTokener x = <span class="keyword">new</span> HTTPTokener(string);</span><br><span class="line">		<span class="keyword">String</span> t;</span><br><span class="line"></span><br><span class="line">		t = x.nextToken();</span><br><span class="line">		<span class="keyword">if</span> (t.toUpperCase().startsWith(<span class="string">"HTTP"</span>)) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Response</span></span><br><span class="line"></span><br><span class="line">			o.put(<span class="string">"HTTP-Version"</span>, t);</span><br><span class="line">			o.put(<span class="string">"Status-Code"</span>, x.nextToken());</span><br><span class="line">			o.put(<span class="string">"Reason-Phrase"</span>, x.nextTo(<span class="string">'\0'</span>));</span><br><span class="line">			x.next();</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Request</span></span><br><span class="line"></span><br><span class="line">			o.put(<span class="string">"Method"</span>, t);</span><br><span class="line">			o.put(<span class="string">"Request-URI"</span>, x.nextToken());</span><br><span class="line">			o.put(<span class="string">"HTTP-Version"</span>, x.nextToken());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Fields</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (x.more()) &#123;</span><br><span class="line">			<span class="keyword">String</span> name = x.nextTo(<span class="string">':'</span>);</span><br><span class="line">			x.next(<span class="string">':'</span>);</span><br><span class="line">			o.put(name, x.nextTo(<span class="string">'\0'</span>));</span><br><span class="line">			x.next();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Convert a JSONObject into an HTTP header. A request header must contain</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 * &#123;</span><br><span class="line">	 *    Method: "POST" (for example),</span><br><span class="line">	 *    "Request-URI": "/" (for example),</span><br><span class="line">	 *    "HTTP-Version": "HTTP/1.1" (for example)</span><br><span class="line">	 * &#125;</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * A response header must contain</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;pre&gt;</span><br><span class="line">	 * &#123;</span><br><span class="line">	 *    "HTTP-Version": "HTTP/1.1" (for example),</span><br><span class="line">	 *    "Status-Code": "200" (for example),</span><br><span class="line">	 *    "Reason-Phrase": "OK" (for example)</span><br><span class="line">	 * &#125;</span><br><span class="line">	 * &lt;/pre&gt;</span><br><span class="line">	 * </span><br><span class="line">	 * Any other members of the JSONObject will be output as HTTP fields. The</span><br><span class="line">	 * result will end with two CRLF pairs.</span><br><span class="line">	 * </span><br><span class="line">	 * @param o</span><br><span class="line">	 *            A JSONObject</span><br><span class="line">	 * @return An HTTP header string.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the object does not contain enough information.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> toString(<span class="keyword">JSONObject</span> o) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		Iterator keys = o.keys();</span><br><span class="line">		<span class="keyword">String</span> s;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">if</span> (o.has(<span class="string">"Status-Code"</span>) &amp;&amp; o.has(<span class="string">"Reason-Phrase"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"HTTP-Version"</span>));</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"Status-Code"</span>));</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"Reason-Phrase"</span>));</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o.has(<span class="string">"Method"</span>) &amp;&amp; o.has(<span class="string">"Request-URI"</span>)) &#123;</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"Method"</span>));</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">'"'</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"Request-URI"</span>));</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">'"'</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(o.getString(<span class="string">"HTTP-Version"</span>));</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Not enough material for an HTTP header."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		sb.<span class="built_in">append</span>(CRLF);</span><br><span class="line">		<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">			s = keys.next().toString();</span><br><span class="line">			<span class="keyword">if</span> (!s.equals(<span class="string">"HTTP-Version"</span>) &amp;&amp; !s.equals(<span class="string">"Status-Code"</span>)</span><br><span class="line">					&amp;&amp; !s.equals(<span class="string">"Reason-Phrase"</span>) &amp;&amp; !s.equals(<span class="string">"Method"</span>)</span><br><span class="line">					&amp;&amp; !s.equals(<span class="string">"Request-URI"</span>) &amp;&amp; !o.isNull(s)) &#123;</span><br><span class="line">				sb.<span class="built_in">append</span>(s);</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">": "</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(o.getString(s));</span><br><span class="line">				sb.<span class="built_in">append</span>(CRLF);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sb.<span class="built_in">append</span>(CRLF);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HTTPTokener-java">HTTPTokener.java</h2><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HTTPTokener</span> <span class="keyword">extends</span> <span class="title">JSONTokener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct an XMLTokener from a string.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> s</span><br><span class="line">	 *            A source string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HTTPTokener</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next token or string. This is used in parsing HTTP headers.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 * <span class="doctag">@return</span> A String.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">nextToken</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="keyword">char</span> q;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		do &#123;</span><br><span class="line">			c = next();</span><br><span class="line">		&#125; <span class="keyword">while</span> (Character.isWhitespace(c));</span><br><span class="line">		<span class="keyword">if</span> (c == <span class="string">'"'</span> || c == <span class="string">'\''</span>) &#123;</span><br><span class="line">			q = c;</span><br><span class="line">			<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">				c = next();</span><br><span class="line">				<span class="keyword">if</span> (c &lt; <span class="string">' '</span>) &#123;</span><br><span class="line">					<span class="keyword">throw</span> syntaxError(<span class="string">"Unterminated string."</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (c == q) &#123;</span><br><span class="line">					<span class="function"><span class="keyword">return</span> sb.<span class="title">toString</span><span class="params">()</span></span>;</span><br><span class="line">				&#125;</span><br><span class="line">				sb.append(c);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="number">0</span> || Character.isWhitespace(c)) &#123;</span><br><span class="line">				<span class="function"><span class="keyword">return</span> sb.<span class="title">toString</span><span class="params">()</span></span>;</span><br><span class="line">			&#125;</span><br><span class="line">			sb.append(c);</span><br><span class="line">			c = next();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONArray-java">JSONArray.java</h2><figure class="highlight zephir"><table><tr><td class="code"><pre><span class="line">package weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.Writer;</span><br><span class="line">import java.lang.reflect.<span class="keyword">Array</span>;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Collection;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JSONArray</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * The arrayList where the JSONArray's properties are kept.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> ArrayList myArrayList;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct an empty JSONArray.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray() &#123;</span><br><span class="line">		this.myArrayList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from a JSONTokener.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> x</span><br><span class="line">	 *            A JSONTokener</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is a syntax error.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray(JSONTokener x) throws JSONException &#123;</span><br><span class="line">		this();</span><br><span class="line">		<span class="keyword">char</span> c = x.nextClean();</span><br><span class="line">		<span class="keyword">char</span> q;</span><br><span class="line">		<span class="keyword">if</span> (c == <span class="string">'['</span>) &#123;</span><br><span class="line">			q = <span class="string">']'</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'('</span>) &#123;</span><br><span class="line">			q = <span class="string">')'</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> x.syntaxError(<span class="string">"A JSONArray text must start with '['"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (x.nextClean() == <span class="string">']'</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		x.back();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			<span class="keyword">if</span> (x.nextClean() == <span class="string">','</span>) &#123;</span><br><span class="line">				x.back();</span><br><span class="line">				this.myArrayList.add(<span class="keyword">null</span>);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				x.back();</span><br><span class="line">				this.myArrayList.add(x.nextValue());</span><br><span class="line">			&#125;</span><br><span class="line">			c = x.nextClean();</span><br><span class="line">			<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">';'</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">','</span>:</span><br><span class="line">				<span class="keyword">if</span> (x.nextClean() == <span class="string">']'</span>) &#123;</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				x.back();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">']'</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">				<span class="keyword">if</span> (q != c) &#123;</span><br><span class="line">					<span class="keyword">throw</span> x.syntaxError(<span class="string">"Expected a '"</span> + <span class="keyword">new</span> Character(q) + <span class="string">"'"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">throw</span> x.syntaxError(<span class="string">"Expected a ',' or ']'"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from a source JSON text.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> source</span><br><span class="line">	 *            A string that begins with &lt;code&gt;[&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *            bracket)&lt;/small&gt; and ends with &lt;code&gt;]&lt;/code&gt;</span><br><span class="line">	 *            &amp;nbsp;&lt;small&gt;(right bracket)&lt;/small&gt;.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is a syntax error.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray(String source) throws JSONException &#123;</span><br><span class="line">		this(<span class="keyword">new</span> JSONTokener(source));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from a Collection.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> collection</span><br><span class="line">	 *            A Collection.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray(Collection collection) &#123;</span><br><span class="line">		this.myArrayList = (collection == <span class="keyword">null</span>) ? <span class="keyword">new</span> ArrayList()</span><br><span class="line">				: <span class="keyword">new</span> ArrayList(collection);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from a collection of beans. The collection should</span><br><span class="line">	 * have Java Beans.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If not an array.</span><br><span class="line">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> JSONArray(Collection collection, <span class="keyword">boolean</span> includeSuperClass) &#123;</span><br><span class="line">		this.myArrayList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">		<span class="keyword">if</span> (collection != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (Iterator iter = collection.iterator(); iter.hasNext();) &#123;</span><br><span class="line">				this.myArrayList.add(<span class="keyword">new</span> JSONObject(iter.next(),</span><br><span class="line">						includeSuperClass));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from an array</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If not an array.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray(Object <span class="keyword">array</span>) throws JSONException &#123;</span><br><span class="line">		this();</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">array</span>.getClass().isArray()) &#123;</span><br><span class="line">			<span class="keyword">int</span> length = <span class="keyword">Array</span>.getLength(<span class="keyword">array</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i += <span class="number">1</span>) &#123;</span><br><span class="line">				this.put(<span class="keyword">Array</span>.get(<span class="keyword">array</span>, i));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(</span><br><span class="line">					<span class="string">"JSONArray initial value should be a string or collection or array."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONArray from an array with a bean. The array should have</span><br><span class="line">	 * Java Beans.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If not an array.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray(Object <span class="keyword">array</span>, <span class="keyword">boolean</span> includeSuperClass)</span><br><span class="line">			throws JSONException &#123;</span><br><span class="line">		this();</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">array</span>.getClass().isArray()) &#123;</span><br><span class="line">			<span class="keyword">int</span> length = <span class="keyword">Array</span>.getLength(<span class="keyword">array</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i += <span class="number">1</span>) &#123;</span><br><span class="line">				this.put(<span class="keyword">new</span> JSONObject(<span class="keyword">Array</span>.get(<span class="keyword">array</span>, i), includeSuperClass));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(</span><br><span class="line">					<span class="string">"JSONArray initial value should be a string or collection or array."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the object value associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> An object value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is no value for the index.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Object get(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = opt(index);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] not found."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the boolean value associated with an index. The string values "true"</span><br><span class="line">	 * and "false" are converted to boolean.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The truth.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is no value for the index or if the value is not</span><br><span class="line">	 *             convertable to boolean.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> getBoolean(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">if</span> (o.equals(<span class="keyword">Boolean</span>.<span class="keyword">FALSE</span>)</span><br><span class="line">				|| (o <span class="keyword">instanceof</span> String &amp;&amp; ((String) o)</span><br><span class="line">						.equalsIgnoreCase(<span class="string">"false"</span>))) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o.equals(<span class="keyword">Boolean</span>.<span class="keyword">TRUE</span>)</span><br><span class="line">				|| (o <span class="keyword">instanceof</span> String &amp;&amp; ((String) o)</span><br><span class="line">						.equalsIgnoreCase(<span class="string">"true"</span>))) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] is not a Boolean."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the double value associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the key is not found or if the value cannot be converted</span><br><span class="line">	 *             to a number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> getDouble(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).doubleValue() : <span class="keyword">Double</span></span><br><span class="line">					.valueOf((String) o).doubleValue();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] is not a number."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the int value associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the key is not found or if the value cannot be converted</span><br><span class="line">	 *             to a number. if the value cannot be converted to a number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> getInt(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).intValue()</span><br><span class="line">				: (<span class="keyword">int</span>) getDouble(index);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the JSONArray associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is no value for the index. or if the value is not a</span><br><span class="line">	 *             JSONArray</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray getJSONArray(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">if</span> (o <span class="keyword">instanceof</span> JSONArray) &#123;</span><br><span class="line">			<span class="keyword">return</span> (JSONArray) o;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] is not a JSONArray."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the JSONObject associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            subscript</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONObject value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is no value for the index or if the value is not a</span><br><span class="line">	 *             JSONObject</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONObject getJSONObject(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">if</span> (o <span class="keyword">instanceof</span> JSONObject) &#123;</span><br><span class="line">			<span class="keyword">return</span> (JSONObject) o;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] is not a JSONObject."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the long value associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the key is not found or if the value cannot be converted</span><br><span class="line">	 *             to a number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> getLong(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		Object o = get(index);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).longValue()</span><br><span class="line">				: (<span class="keyword">long</span>) getDouble(index);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the string associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> A string value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If there is no value for the index.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String getString(<span class="keyword">int</span> index) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> get(index).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Determine if the value is null.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> true if the value at the index is null, or if there is no value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isNull(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> JSONObject.<span class="keyword">NULL</span>.equals(opt(index));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a string from the contents of this JSONArray. The</span><br><span class="line">	 * &lt;code&gt;separator&lt;/code&gt; string is inserted between each element. Warning:</span><br><span class="line">	 * This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> separator</span><br><span class="line">	 *            A string that will be inserted between the elements.</span><br><span class="line">	 * <span class="doctag">@return</span> a string.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the array contains an invalid number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String join(String separator) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">int</span> len = length();</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				sb.append(separator);</span><br><span class="line">			&#125;</span><br><span class="line">			sb.append(JSONObject.valueToString(this.myArrayList.get(i)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the number of elements in the JSONArray, included nulls.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> The length (or size).</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> length() &#123;</span><br><span class="line">		<span class="keyword">return</span> this.myArrayList.size();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional object value associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> An object value, or null if there is no object at that index.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Object opt(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> (index &lt; <span class="number">0</span> || index &gt;= length()) ? <span class="keyword">null</span> : this.myArrayList</span><br><span class="line">				.get(index);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional boolean value associated with an index. It returns false</span><br><span class="line">	 * if there is no value at that index, or if the value is not Boolean.TRUE</span><br><span class="line">	 * or the String "true".</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The truth.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> optBoolean(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> optBoolean(index, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional boolean value associated with an index. It returns the</span><br><span class="line">	 * defaultValue if there is no value at that index or if it is not a Boolean</span><br><span class="line">	 * or the String "true" or "false" (case insensitive).</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@param</span> defaultValue</span><br><span class="line">	 *            A boolean default.</span><br><span class="line">	 * <span class="doctag">@return</span> The truth.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> optBoolean(<span class="keyword">int</span> index, <span class="keyword">boolean</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getBoolean(index);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional double value associated with an index. NaN is returned</span><br><span class="line">	 * if there is no value for the index, or if the value is not a number and</span><br><span class="line">	 * cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> optDouble(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> optDouble(index, <span class="keyword">Double</span>.NaN);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional double value associated with an index. The defaultValue</span><br><span class="line">	 * is returned if there is no value for the index, or if the value is not a</span><br><span class="line">	 * number and cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            subscript</span><br><span class="line">	 * <span class="doctag">@param</span> defaultValue</span><br><span class="line">	 *            The default value.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> optDouble(<span class="keyword">int</span> index, <span class="keyword">double</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getDouble(index);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional int value associated with an index. Zero is returned if</span><br><span class="line">	 * there is no value for the index, or if the value is not a number and</span><br><span class="line">	 * cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> optInt(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> optInt(index, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional int value associated with an index. The defaultValue is</span><br><span class="line">	 * returned if there is no value for the index, or if the value is not a</span><br><span class="line">	 * number and cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@param</span> defaultValue</span><br><span class="line">	 *            The default value.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> optInt(<span class="keyword">int</span> index, <span class="keyword">int</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getInt(index);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional JSONArray associated with an index.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            subscript</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONArray value, or null if the index has no value, or if the</span><br><span class="line">	 *         value is not a JSONArray.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray optJSONArray(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		Object o = opt(index);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> JSONArray ? (JSONArray) o : <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional JSONObject associated with an index. Null is returned if</span><br><span class="line">	 * the key is not found, or null if the index has no value, or if the value</span><br><span class="line">	 * is not a JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONObject value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONObject optJSONObject(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		Object o = opt(index);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> JSONObject ? (JSONObject) o : <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional long value associated with an index. Zero is returned if</span><br><span class="line">	 * there is no value for the index, or if the value is not a number and</span><br><span class="line">	 * cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> optLong(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> optLong(index, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional long value associated with an index. The defaultValue is</span><br><span class="line">	 * returned if there is no value for the index, or if the value is not a</span><br><span class="line">	 * number and cannot be converted to a number.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@param</span> defaultValue</span><br><span class="line">	 *            The default value.</span><br><span class="line">	 * <span class="doctag">@return</span> The value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> optLong(<span class="keyword">int</span> index, <span class="keyword">long</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getLong(index);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional string value associated with an index. It returns an</span><br><span class="line">	 * empty string if there is no value at that index. If the value is not a</span><br><span class="line">	 * string and is not null, then it is coverted to a string.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@return</span> A String value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String optString(<span class="keyword">int</span> index) &#123;</span><br><span class="line">		<span class="keyword">return</span> optString(index, <span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the optional string associated with an index. The defaultValue is</span><br><span class="line">	 * returned if the key is not found.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The index must be between 0 and length() - 1.</span><br><span class="line">	 * <span class="doctag">@param</span> defaultValue</span><br><span class="line">	 *            The default value.</span><br><span class="line">	 * <span class="doctag">@return</span> A String value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String optString(<span class="keyword">int</span> index, String defaultValue) &#123;</span><br><span class="line">		Object o = opt(index);</span><br><span class="line">		<span class="keyword">return</span> o != <span class="keyword">null</span> ? o.toString() : defaultValue;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a boolean value. This increases the array's length by one.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A boolean value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">boolean</span> value) &#123;</span><br><span class="line">		put(value ? <span class="keyword">Boolean</span>.<span class="keyword">TRUE</span> : <span class="keyword">Boolean</span>.<span class="keyword">FALSE</span>);</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a value in the JSONArray, where the value will be a JSONArray which</span><br><span class="line">	 * is produced from a Collection.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A Collection value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(Collection value) &#123;</span><br><span class="line">		put(<span class="keyword">new</span> JSONArray(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a double value. This increases the array's length by one.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A double value.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             if the value is not finite.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">double</span> value) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">Double</span> d = <span class="keyword">new</span> <span class="keyword">Double</span>(value);</span><br><span class="line">		JSONObject.testValidity(d);</span><br><span class="line">		put(d);</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append an int value. This increases the array's length by one.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            An int value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> value) &#123;</span><br><span class="line">		put(<span class="keyword">new</span> Integer(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append an long value. This increases the array's length by one.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A long value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">long</span> value) &#123;</span><br><span class="line">		put(<span class="keyword">new</span> <span class="keyword">Long</span>(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a value in the JSONArray, where the value will be a JSONObject which</span><br><span class="line">	 * is produced from a Map.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A Map value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(Map value) &#123;</span><br><span class="line">		put(<span class="keyword">new</span> JSONObject(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append an object value. This increases the array's length by one.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            An object value. The value should be a Boolean, Double,</span><br><span class="line">	 *            Integer, JSONArray, JSONObject, Long, or String, or the</span><br><span class="line">	 *            JSONObject.NULL object.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(Object value) &#123;</span><br><span class="line">		this.myArrayList.add(value);</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put or replace a boolean value in the JSONArray. If the index is greater</span><br><span class="line">	 * than the length of the JSONArray, then null elements will be added as</span><br><span class="line">	 * necessary to pad it out.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A boolean value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, <span class="keyword">boolean</span> value) throws JSONException &#123;</span><br><span class="line">		put(index, value ? <span class="keyword">Boolean</span>.<span class="keyword">TRUE</span> : <span class="keyword">Boolean</span>.<span class="keyword">FALSE</span>);</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a value in the JSONArray, where the value will be a JSONArray which</span><br><span class="line">	 * is produced from a Collection.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A Collection value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative or if the value is not finite.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, Collection value) throws JSONException &#123;</span><br><span class="line">		put(index, <span class="keyword">new</span> JSONArray(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put or replace a double value. If the index is greater than the length of</span><br><span class="line">	 * the JSONArray, then null elements will be added as necessary to pad it</span><br><span class="line">	 * out.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A double value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative or if the value is not finite.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, <span class="keyword">double</span> value) throws JSONException &#123;</span><br><span class="line">		put(index, <span class="keyword">new</span> <span class="keyword">Double</span>(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put or replace an int value. If the index is greater than the length of</span><br><span class="line">	 * the JSONArray, then null elements will be added as necessary to pad it</span><br><span class="line">	 * out.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            An int value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, <span class="keyword">int</span> value) throws JSONException &#123;</span><br><span class="line">		put(index, <span class="keyword">new</span> Integer(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put or replace a long value. If the index is greater than the length of</span><br><span class="line">	 * the JSONArray, then null elements will be added as necessary to pad it</span><br><span class="line">	 * out.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            A long value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, <span class="keyword">long</span> value) throws JSONException &#123;</span><br><span class="line">		put(index, <span class="keyword">new</span> <span class="keyword">Long</span>(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a value in the JSONArray, where the value will be a JSONObject which</span><br><span class="line">	 * is produced from a Map.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            The Map value.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative or if the the value is an invalid</span><br><span class="line">	 *             number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, Map value) throws JSONException &#123;</span><br><span class="line">		put(index, <span class="keyword">new</span> JSONObject(value));</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put or replace an object value in the JSONArray. If the index is greater</span><br><span class="line">	 * than the length of the JSONArray, then null elements will be added as</span><br><span class="line">	 * necessary to pad it out.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> index</span><br><span class="line">	 *            The subscript.</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 *            The value to put into the array. The value should be a</span><br><span class="line">	 *            Boolean, Double, Integer, JSONArray, JSONObject, Long, or</span><br><span class="line">	 *            String, or the JSONObject.NULL object.</span><br><span class="line">	 * <span class="doctag">@return</span> this.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the index is negative or if the the value is an invalid</span><br><span class="line">	 *             number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONArray put(<span class="keyword">int</span> index, Object value) throws JSONException &#123;</span><br><span class="line">		JSONObject.testValidity(value);</span><br><span class="line">		<span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONArray["</span> + index + <span class="string">"] not found."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (index &lt; length()) &#123;</span><br><span class="line">			this.myArrayList.set(index, value);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">while</span> (index != length()) &#123;</span><br><span class="line">				put(JSONObject.<span class="keyword">NULL</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			put(value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> this;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONObject by combining a JSONArray of names with the values of</span><br><span class="line">	 * this JSONArray.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> names</span><br><span class="line">	 *            A JSONArray containing a list of key strings. These will be</span><br><span class="line">	 *            paired with the values.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONObject, or null if there are no names or if this JSONArray</span><br><span class="line">	 *         has no values.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If any of the names are null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> JSONObject toJSONObject(JSONArray names) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (names == <span class="keyword">null</span> || names.length() == <span class="number">0</span> || length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		JSONObject jo = <span class="keyword">new</span> JSONObject();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; names.length(); i += <span class="number">1</span>) &#123;</span><br><span class="line">			jo.put(names.getString(i), this.opt(i));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> jo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a JSON text of this JSONArray. For compactness, no unnecessary</span><br><span class="line">	 * whitespace is added. If it is not possible to produce a syntactically</span><br><span class="line">	 * correct JSON text then null will be returned instead. This could occur if</span><br><span class="line">	 * the array contains an invalid number.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         array.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String toString() &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">'['</span> + join(<span class="string">","</span>) + <span class="string">']'</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a prettyprinted JSON text of this JSONArray. Warning: This method</span><br><span class="line">	 * assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> indentFactor</span><br><span class="line">	 *            The number of spaces to add to each level of indentation.</span><br><span class="line">	 * <span class="doctag">@return</span> a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         object, beginning with &lt;code&gt;[&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         bracket)&lt;/small&gt; and ending with &lt;code&gt;]&lt;/code&gt;</span><br><span class="line">	 *         &amp;nbsp;&lt;small&gt;(right bracket)&lt;/small&gt;.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> String toString(<span class="keyword">int</span> indentFactor) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> toString(indentFactor, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a prettyprinted JSON text of this JSONArray. Warning: This method</span><br><span class="line">	 * assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> indentFactor</span><br><span class="line">	 *            The number of spaces to add to each level of indentation.</span><br><span class="line">	 * <span class="doctag">@param</span> indent</span><br><span class="line">	 *            The indention of the top level.</span><br><span class="line">	 * <span class="doctag">@return</span> a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         array.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	String toString(<span class="keyword">int</span> indentFactor, <span class="keyword">int</span> indent) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">int</span> len = length();</span><br><span class="line">		<span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"[]"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"["</span>);</span><br><span class="line">		<span class="keyword">if</span> (len == <span class="number">1</span>) &#123;</span><br><span class="line">			sb.append(JSONObject.valueToString(this.myArrayList.get(<span class="number">0</span>),</span><br><span class="line">					indentFactor, indent));</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> newindent = indent + indentFactor;</span><br><span class="line">			sb.append(<span class="string">'\n'</span>);</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					sb.append(<span class="string">",\n"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; newindent; j += <span class="number">1</span>) &#123;</span><br><span class="line">					sb.append(<span class="string">' '</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				sb.append(JSONObject.valueToString(this.myArrayList.get(i),</span><br><span class="line">						indentFactor, newindent));</span><br><span class="line">			&#125;</span><br><span class="line">			sb.append(<span class="string">'\n'</span>);</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; indent; i += <span class="number">1</span>) &#123;</span><br><span class="line">				sb.append(<span class="string">' '</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sb.append(<span class="string">']'</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Write the contents of the JSONArray as JSON text to a writer. For</span><br><span class="line">	 * compactness, no whitespace is added.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> The writer.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Writer write(Writer writer) throws JSONException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">boolean</span> b = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">int</span> len = length();</span><br><span class="line"></span><br><span class="line">			writer.write(<span class="string">'['</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (b) &#123;</span><br><span class="line">					writer.write(<span class="string">','</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				Object v = this.myArrayList.get(i);</span><br><span class="line">				<span class="keyword">if</span> (v <span class="keyword">instanceof</span> JSONObject) &#123;</span><br><span class="line">					((JSONObject) v).write(writer);</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (v <span class="keyword">instanceof</span> JSONArray) &#123;</span><br><span class="line">					((JSONArray) v).write(writer);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					writer.write(JSONObject.valueToString(v));</span><br><span class="line">				&#125;</span><br><span class="line">				b = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			writer.write(<span class="string">']'</span>);</span><br><span class="line">			<span class="keyword">return</span> writer;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONException-java">JSONException.java</h2><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">JSONException</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Exception</span> &#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Throwable</span> cause;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Constructs a JSONException with an explanatory message.</span><br><span class="line">	 * </span><br><span class="line">	 * @param message</span><br><span class="line">	 *            Detail about the reason for the exception.</span><br><span class="line">	 */</span></span><br><span class="line">	public <span class="type">JSONException</span>(<span class="type">String</span> message) &#123;</span><br><span class="line">		<span class="keyword">super</span>(message);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">JSONException</span>(<span class="type">Throwable</span> t) &#123;</span><br><span class="line">		<span class="keyword">super</span>(t.getMessage());</span><br><span class="line">		<span class="keyword">this</span>.cause = t;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="type">Throwable</span> getCause() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.cause;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONObject-java">JSONObject.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class <span class="keyword">JSONObject</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * JSONObject.NULL is equivalent to the value that JavaScript calls null,</span><br><span class="line">	 * whilst Java's null is equivalent to the value that JavaScript calls</span><br><span class="line">	 * undefined.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> class Null &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * There is only intended to be a single instance of the NULL object, so</span><br><span class="line">		 * the clone method returns itself.</span><br><span class="line">		 * </span><br><span class="line">		 * @return NULL.</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">Object</span> clone() &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * A Null object is equal to the null value and to itself.</span><br><span class="line">		 * </span><br><span class="line">		 * @param object</span><br><span class="line">		 *            An object to test for nullness.</span><br><span class="line">		 * @return true if the object parameter is the JSONObject.NULL object or</span><br><span class="line">		 *         null.</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">public</span> <span class="built_in">boolean</span> equals(<span class="keyword">Object</span> object) &#123;</span><br><span class="line">			<span class="keyword">return</span> object == <span class="keyword">null</span> || object == <span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * Get the "null" string value.</span><br><span class="line">		 * </span><br><span class="line">		 * @return The string "null".</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"null"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * The map where the JSONObject's properties are kept.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> Map <span class="built_in">map</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * It is sometimes more convenient and less ambiguous to have a</span><br><span class="line">	 * &lt;code&gt;NULL&lt;/code&gt; object than to use Java's &lt;code&gt;null&lt;/code&gt; value.</span><br><span class="line">	 * &lt;code&gt;JSONObject.NULL.equals(null)&lt;/code&gt; returns &lt;code&gt;true&lt;/code&gt;.</span><br><span class="line">	 * &lt;code&gt;JSONObject.NULL.toString()&lt;/code&gt; returns &lt;code&gt;"null"&lt;/code&gt;.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">Object</span> NULL = <span class="keyword">new</span> Null();</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct an empty JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>() &#123;</span><br><span class="line">		<span class="keyword">this</span>.<span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from a subset of another JSONObject. An array of</span><br><span class="line">	 * strings is used to identify the keys that should be copied. Missing keys</span><br><span class="line">	 * are ignored.</span><br><span class="line">	 * </span><br><span class="line">	 * @param jo</span><br><span class="line">	 *            A JSONObject.</span><br><span class="line">	 * @param names</span><br><span class="line">	 *            An array of strings.</span><br><span class="line">	 * @exception JSONException</span><br><span class="line">	 *                If a value is a non-finite number or if a name is</span><br><span class="line">	 *                duplicated.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(<span class="keyword">JSONObject</span> jo, <span class="keyword">String</span>[] names) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">this</span>();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; names.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">			putOnce(names[i], jo.opt(names[i]));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from a JSONTokener.</span><br><span class="line">	 * </span><br><span class="line">	 * @param x</span><br><span class="line">	 *            A JSONTokener object containing the source string.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If there is a syntax error in the source string or a</span><br><span class="line">	 *             duplicated key.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(JSONTokener x) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">this</span>();</span><br><span class="line">		<span class="built_in">char</span> c;</span><br><span class="line">		<span class="keyword">String</span> <span class="variable">key</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (x.nextClean() != <span class="string">'&#123;'</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> x.syntaxError(<span class="string">"A JSONObject text must begin with '&#123;'"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			c = x.nextClean();</span><br><span class="line">			<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">throw</span> x.syntaxError(<span class="string">"A JSONObject text must end with '&#125;'"</span>);</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'&#125;'</span>:</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				x.back();</span><br><span class="line">				<span class="variable">key</span> = x.nextValue().toString();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/*</span><br><span class="line">			 * The key is followed by ':'. We will also tolerate '=' or '=&gt;'.</span><br><span class="line">			 */</span></span><br><span class="line"></span><br><span class="line">			c = x.nextClean();</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="string">'='</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (x.next() != <span class="string">'&gt;'</span>) &#123;</span><br><span class="line">					x.back();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (c != <span class="string">':'</span>) &#123;</span><br><span class="line">				<span class="keyword">throw</span> x.syntaxError(<span class="string">"Expected a ':' after a key"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			putOnce(<span class="variable">key</span>, x.nextValue());</span><br><span class="line"></span><br><span class="line">			<span class="comment">/*</span><br><span class="line">			 * Pairs are separated by ','. We will also tolerate ';'.</span><br><span class="line">			 */</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">switch</span> (x.nextClean()) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">';'</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">','</span>:</span><br><span class="line">				<span class="keyword">if</span> (x.nextClean() == <span class="string">'&#125;'</span>) &#123;</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				x.back();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'&#125;'</span>:</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">throw</span> x.syntaxError(<span class="string">"Expected a ',' or '&#125;'"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from a Map.</span><br><span class="line">	 * </span><br><span class="line">	 * @param map</span><br><span class="line">	 *            A map object that can be used to initialize the contents of</span><br><span class="line">	 *            the JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(Map <span class="built_in">map</span>) &#123;</span><br><span class="line">		<span class="keyword">this</span>.<span class="built_in">map</span> = (<span class="built_in">map</span> == <span class="keyword">null</span>) ? <span class="keyword">new</span> <span class="keyword">HashMap</span>() : <span class="built_in">map</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from a Map.</span><br><span class="line">	 * </span><br><span class="line">	 * Note: Use this constructor when the map contains &lt;key,bean&gt;.</span><br><span class="line">	 * </span><br><span class="line">	 * @param map</span><br><span class="line">	 *            - A map with Key-Bean data.</span><br><span class="line">	 * @param includeSuperClass</span><br><span class="line">	 *            - Tell whether to include the super class properties.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(Map <span class="built_in">map</span>, <span class="built_in">boolean</span> includeSuperClass) &#123;</span><br><span class="line">		<span class="keyword">this</span>.<span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>();</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">map</span> != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (Iterator i = <span class="built_in">map</span>.entrySet().iterator(); i.hasNext();) &#123;</span><br><span class="line">				Map.Entry e = (Map.Entry) i.next();</span><br><span class="line">				<span class="keyword">this</span>.<span class="built_in">map</span>.put(e.getKey(), <span class="keyword">new</span> <span class="keyword">JSONObject</span>(e.getValue(),</span><br><span class="line">						includeSuperClass));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from an Object using bean getters. It reflects on</span><br><span class="line">	 * all of the public methods of the object. For each of the methods with no</span><br><span class="line">	 * parameters and a name starting with &lt;code&gt;"get"&lt;/code&gt; or</span><br><span class="line">	 * &lt;code&gt;"is"&lt;/code&gt; followed by an uppercase letter, the method is invoked,</span><br><span class="line">	 * and a key and the value returned from the getter method are put into the</span><br><span class="line">	 * new JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * The key is formed by removing the &lt;code&gt;"get"&lt;/code&gt; or &lt;code&gt;"is"&lt;/code&gt;</span><br><span class="line">	 * prefix. If the second remaining character is not upper case, then the</span><br><span class="line">	 * first character is converted to lower case.</span><br><span class="line">	 * </span><br><span class="line">	 * For example, if an object has a method named &lt;code&gt;"getName"&lt;/code&gt;, and</span><br><span class="line">	 * if the result of calling &lt;code&gt;object.getName()&lt;/code&gt; is</span><br><span class="line">	 * &lt;code&gt;"Larry Fine"&lt;/code&gt;, then the JSONObject will contain</span><br><span class="line">	 * &lt;code&gt;"name": "Larry Fine"&lt;/code&gt;.</span><br><span class="line">	 * </span><br><span class="line">	 * @param bean</span><br><span class="line">	 *            An object that has getter methods that should be used to make</span><br><span class="line">	 *            a JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(<span class="keyword">Object</span> bean) &#123;</span><br><span class="line">		<span class="keyword">this</span>();</span><br><span class="line">		populateInternalMap(bean, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct JSONObject from the given bean. This will also create</span><br><span class="line">	 * JSONObject for all internal object (List, Map, Inner Objects) of the</span><br><span class="line">	 * provided bean.</span><br><span class="line">	 * </span><br><span class="line">	 * -- See Documentation of JSONObject(Object bean) also.</span><br><span class="line">	 * </span><br><span class="line">	 * @param bean</span><br><span class="line">	 *            An object that has getter methods that should be used to make</span><br><span class="line">	 *            a JSONObject.</span><br><span class="line">	 * @param includeSuperClass</span><br><span class="line">	 *            - Tell whether to include the super class properties.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(<span class="keyword">Object</span> bean, <span class="built_in">boolean</span> includeSuperClass) &#123;</span><br><span class="line">		<span class="keyword">this</span>();</span><br><span class="line">		populateInternalMap(bean, includeSuperClass);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> populateInternalMap(<span class="keyword">Object</span> bean, <span class="built_in">boolean</span> includeSuperClass) &#123;</span><br><span class="line">		Class klass = bean.getClass();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// If klass.getSuperClass is System class then includeSuperClass =</span></span><br><span class="line">		<span class="comment">// false;</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (klass.getClassLoader() == <span class="keyword">null</span>) &#123;</span><br><span class="line">			includeSuperClass = <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Method[] methods = (includeSuperClass) ? klass.getMethods() : klass</span><br><span class="line">				.getDeclaredMethods();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; methods.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Method method = methods[i];</span><br><span class="line">				<span class="keyword">String</span> name = method.getName();</span><br><span class="line">				<span class="keyword">String</span> <span class="variable">key</span> = <span class="string">""</span>;</span><br><span class="line">				<span class="keyword">if</span> (name.startsWith(<span class="string">"get"</span>)) &#123;</span><br><span class="line">					<span class="variable">key</span> = name.substring(<span class="number">3</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (name.startsWith(<span class="string">"is"</span>)) &#123;</span><br><span class="line">					<span class="variable">key</span> = name.substring(<span class="number">2</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (<span class="variable">key</span>.length() &gt; <span class="number">0</span> &amp;&amp; Character.isUpperCase(<span class="variable">key</span>.charAt(<span class="number">0</span>))</span><br><span class="line">						&amp;&amp; method.getParameterTypes().length == <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">if</span> (<span class="variable">key</span>.length() == <span class="number">1</span>) &#123;</span><br><span class="line">						<span class="variable">key</span> = <span class="variable">key</span>.toLowerCase();</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!Character.isUpperCase(<span class="variable">key</span>.charAt(<span class="number">1</span>))) &#123;</span><br><span class="line">						<span class="variable">key</span> = <span class="variable">key</span>.substring(<span class="number">0</span>, <span class="number">1</span>).toLowerCase()</span><br><span class="line">								+ <span class="variable">key</span>.substring(<span class="number">1</span>);</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">Object</span> result = method.invoke(bean, (<span class="keyword">Object</span>[]) <span class="keyword">null</span>);</span><br><span class="line">					<span class="keyword">if</span> (result == <span class="keyword">null</span>) &#123;</span><br><span class="line">						<span class="built_in">map</span>.put(<span class="variable">key</span>, NULL);</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (result.getClass().isArray()) &#123;</span><br><span class="line">						<span class="built_in">map</span>.put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONArray</span>(result, includeSuperClass));</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (result <span class="keyword">instanceof</span> Collection) &#123; <span class="comment">// List or Set</span></span><br><span class="line">						<span class="built_in">map</span>.put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONArray</span>((Collection) result,</span><br><span class="line">								includeSuperClass));</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (result <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">						<span class="built_in">map</span>.put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONObject</span>((Map) result,</span><br><span class="line">								includeSuperClass));</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (isStandardProperty(result.getClass())) &#123; <span class="comment">// Primitives,</span></span><br><span class="line">																		<span class="comment">// String</span></span><br><span class="line">																		<span class="comment">// and</span></span><br><span class="line">																		<span class="comment">// Wrapper</span></span><br><span class="line">						<span class="built_in">map</span>.put(<span class="variable">key</span>, result);</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="keyword">if</span> (result.getClass().getPackage().getName()</span><br><span class="line">								.startsWith(<span class="string">"java"</span>)</span><br><span class="line">								|| result.getClass().getClassLoader() == <span class="keyword">null</span>) &#123;</span><br><span class="line">							<span class="built_in">map</span>.put(<span class="variable">key</span>, result.toString());</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123; <span class="comment">// User defined Objects</span></span><br><span class="line">							<span class="built_in">map</span>.put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONObject</span>(result,</span><br><span class="line">									includeSuperClass));</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="built_in">boolean</span> isStandardProperty(Class clazz) &#123;</span><br><span class="line">		<span class="keyword">return</span> clazz.isPrimitive() || clazz.isAssignableFrom(Byte.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Short.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Integer.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Long.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Float.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Double.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Character.class)</span><br><span class="line">				|| clazz.isAssignableFrom(<span class="keyword">String</span>.class)</span><br><span class="line">				|| clazz.isAssignableFrom(Boolean.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from an Object, using reflection to find the</span><br><span class="line">	 * public members. The resulting JSONObject's keys will be the strings from</span><br><span class="line">	 * the names array, and the values will be the field values associated with</span><br><span class="line">	 * those keys in the object. If a key is not found or not visible, then it</span><br><span class="line">	 * will not be copied into the new JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param object</span><br><span class="line">	 *            An object that has fields that should be used to make a</span><br><span class="line">	 *            JSONObject.</span><br><span class="line">	 * @param names</span><br><span class="line">	 *            An array of strings, the names of the fields to be obtained</span><br><span class="line">	 *            from the object.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(<span class="keyword">Object</span> object, <span class="keyword">String</span> names[]) &#123;</span><br><span class="line">		<span class="keyword">this</span>();</span><br><span class="line">		Class c = object.getClass();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; names.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">String</span> name = names[i];</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				putOpt(name, c.getField(name).<span class="built_in">get</span>(object));</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="comment">/* forget about it */</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONObject from a source JSON text string. This is the most</span><br><span class="line">	 * commonly used JSONObject constructor.</span><br><span class="line">	 * </span><br><span class="line">	 * @param source</span><br><span class="line">	 *            A string beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *            brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;</span><br><span class="line">	 *            &amp;nbsp;&lt;small&gt;(right brace)&lt;/small&gt;.</span><br><span class="line">	 * @exception JSONException</span><br><span class="line">	 *                If there is a syntax error in the source string or a</span><br><span class="line">	 *                duplicated key.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span>(<span class="keyword">String</span> source) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">this</span>(<span class="keyword">new</span> JSONTokener(source));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Accumulate values under a key. It is similar to the put method except</span><br><span class="line">	 * that if there is already an object stored under the key then a JSONArray</span><br><span class="line">	 * is stored under the key to hold all of the accumulated values. If there</span><br><span class="line">	 * is already a JSONArray, then the new value is appended to it. In</span><br><span class="line">	 * contrast, the put method replaces the previous value.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            An object to be accumulated under the key.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the value is an invalid number or if the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> accumulate(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		testValidity(value);</span><br><span class="line">		<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">			put(<span class="variable">key</span>, value <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span> ? <span class="keyword">new</span> <span class="keyword">JSONArray</span>().put(value)</span><br><span class="line">					: value);</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">			((<span class="keyword">JSONArray</span>) o).put(value);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONArray</span>().put(o).put(value));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append values to the array under a key. If the key does not exist in the</span><br><span class="line">	 * JSONObject, then the key is put in the JSONObject with its value being a</span><br><span class="line">	 * JSONArray containing the value parameter. If the key was already</span><br><span class="line">	 * associated with a JSONArray, then the value parameter is appended to it.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            An object to be accumulated under the key.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the key is null or if the current value associated with</span><br><span class="line">	 *             the key is not a JSONArray.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> <span class="built_in">append</span>(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		testValidity(value);</span><br><span class="line">		<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">			put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONArray</span>().put(value));</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">			put(<span class="variable">key</span>, ((<span class="keyword">JSONArray</span>) o).put(value));</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONObject["</span> + <span class="variable">key</span></span><br><span class="line">					+ <span class="string">"] is not a JSONArray."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a string from a double. The string "null" will be returned if the</span><br><span class="line">	 * number is not finite.</span><br><span class="line">	 * </span><br><span class="line">	 * @param d</span><br><span class="line">	 *            A double.</span><br><span class="line">	 * @return A String.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">String</span> doubleToString(<span class="keyword">double</span> d) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Double.isInfinite(d) || Double.isNaN(d)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"null"</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Shave off trailing zeros and decimal point, if possible.</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> s = Double.toString(d);</span><br><span class="line">		<span class="keyword">if</span> (s.indexOf(<span class="string">'.'</span>) &gt; <span class="number">0</span> &amp;&amp; s.indexOf(<span class="string">'e'</span>) &lt; <span class="number">0</span> &amp;&amp; s.indexOf(<span class="string">'E'</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">while</span> (s.endsWith(<span class="string">"0"</span>)) &#123;</span><br><span class="line">				s = s.substring(<span class="number">0</span>, s.length() - <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (s.endsWith(<span class="string">"."</span>)) &#123;</span><br><span class="line">				s = s.substring(<span class="number">0</span>, s.length() - <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the value object associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The object associated with the key.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="comment">/* modify by sycheng allow return null */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">Object</span> <span class="built_in">get</span>(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * if (o == null) &#123; throw new JSONException("JSONObject[" + quote(key) +</span><br><span class="line">		 * "] not found."); &#125; return o;</span><br><span class="line">		 */</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the boolean value associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The truth.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the value is not a Boolean or the String "true" or</span><br><span class="line">	 *             "false".</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> getBoolean(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (o.equals(Boolean.FALSE)</span><br><span class="line">				|| (o <span class="keyword">instanceof</span> <span class="keyword">String</span> &amp;&amp; ((<span class="keyword">String</span>) o)</span><br><span class="line">						.equalsIgnoreCase(<span class="string">"false"</span>))) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o.equals(Boolean.TRUE)</span><br><span class="line">				|| (o <span class="keyword">instanceof</span> <span class="keyword">String</span> &amp;&amp; ((<span class="keyword">String</span>) o)</span><br><span class="line">						.equalsIgnoreCase(<span class="string">"true"</span>))) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONObject["</span> + quote(<span class="variable">key</span>)</span><br><span class="line">				+ <span class="string">"] is not a Boolean."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the double value associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The numeric value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found or if the value is not a Number</span><br><span class="line">	 *             object and cannot be converted to a number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> getDouble(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (o <span class="keyword">instanceof</span> Number) &#123;</span><br><span class="line">				<span class="keyword">return</span> ((Number) o).doubleValue();</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o.toString().length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> Double.valueOf((o.toString()));</span><br><span class="line">			&#125; <span class="keyword">else</span></span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONObject["</span> + quote(<span class="variable">key</span>)</span><br><span class="line">					+ <span class="string">"] is not a number."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the int value associated with a key. If the number value is too large</span><br><span class="line">	 * for an int, it will be clipped.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The integer value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found or if the value cannot be converted</span><br><span class="line">	 *             to an integer.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> getInt(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).intValue()</span><br><span class="line">				: (<span class="built_in">int</span>) getDouble(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the JSONArray value associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A JSONArray which is the value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found or if the value is not a JSONArray.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONArray</span> getJSONArray(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> (<span class="keyword">JSONArray</span>) o;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONObject["</span> + quote(<span class="variable">key</span>)</span><br><span class="line">				+ <span class="string">"] is not a JSONArray."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the JSONObject value associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A JSONObject which is the value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found or if the value is not a JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> getJSONObject(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">JSONObject</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> (<span class="keyword">JSONObject</span>) o;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"JSONObject["</span> + quote(<span class="variable">key</span>)</span><br><span class="line">				+ <span class="string">"] is not a JSONObject."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the long value associated with a key. If the number value is too long</span><br><span class="line">	 * for a long, it will be clipped.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The long value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found or if the value cannot be converted</span><br><span class="line">	 *             to a long.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> getLong(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">String</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (o.toString().length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> Long.valueOf((o.toString()));</span><br><span class="line">			&#125; <span class="keyword">else</span></span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).longValue()</span><br><span class="line">				: (<span class="keyword">long</span>) getDouble(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an array of field names from a JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @return An array of field names, or null if there are no names.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span>[] getNames(<span class="keyword">JSONObject</span> jo) &#123;</span><br><span class="line">		<span class="built_in">int</span> length = jo.length();</span><br><span class="line">		<span class="keyword">if</span> (length == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		Iterator i = jo.keys();</span><br><span class="line">		<span class="keyword">String</span>[] names = <span class="keyword">new</span> <span class="keyword">String</span>[length];</span><br><span class="line">		<span class="built_in">int</span> j = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (i.hasNext()) &#123;</span><br><span class="line">			names[j] = (<span class="keyword">String</span>) i.next();</span><br><span class="line">			j += <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> names;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an array of field names from an Object.</span><br><span class="line">	 * </span><br><span class="line">	 * @return An array of field names, or null if there are no names.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span>[] getNames(<span class="keyword">Object</span> object) &#123;</span><br><span class="line">		<span class="keyword">if</span> (object == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		Class klass = object.getClass();</span><br><span class="line">		Field[] fields = klass.getFields();</span><br><span class="line">		<span class="built_in">int</span> length = fields.length;</span><br><span class="line">		<span class="keyword">if</span> (length == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">String</span>[] names = <span class="keyword">new</span> <span class="keyword">String</span>[length];</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; length; i += <span class="number">1</span>) &#123;</span><br><span class="line">			names[i] = fields[i].getName();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> names;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the string associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A string which is the value.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is not found.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> getString(<span class="keyword">String</span> <span class="variable">key</span>) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = <span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="keyword">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">return</span> o.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Determine if the JSONObject contains a specific key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return true if the key exists in the JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> has(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.<span class="built_in">map</span>.containsKey(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Determine if the value associated with the key is null or if there is no</span><br><span class="line">	 * value.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return true if there is no value associated with the key or if the value</span><br><span class="line">	 *         is the JSONObject.NULL object.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> isNull(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">JSONObject</span>.NULL.equals(opt(<span class="variable">key</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an enumeration of the keys of the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @return An iterator of the keys.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Iterator keys() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.<span class="built_in">map</span>.keySet().iterator();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the number of keys stored in the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @return The number of keys in the JSONObject.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> length() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">size</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray containing the names of the elements of this</span><br><span class="line">	 * JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @return A JSONArray containing the key strings, or null if the JSONObject</span><br><span class="line">	 *         is empty.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONArray</span> names() &#123;</span><br><span class="line">		<span class="keyword">JSONArray</span> ja = <span class="keyword">new</span> <span class="keyword">JSONArray</span>();</span><br><span class="line">		Iterator keys = keys();</span><br><span class="line">		<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">			ja.put(keys.next());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ja.length() == <span class="number">0</span> ? <span class="keyword">null</span> : ja;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a string from a Number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param n</span><br><span class="line">	 *            A Number</span><br><span class="line">	 * @return A String.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If n is a non-finite number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">String</span> numberToString(Number n) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (n == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Null pointer"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		testValidity(n);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Shave off trailing zeros and decimal point, if possible.</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">String</span> s = n.toString();</span><br><span class="line">		<span class="keyword">if</span> (s.indexOf(<span class="string">'.'</span>) &gt; <span class="number">0</span> &amp;&amp; s.indexOf(<span class="string">'e'</span>) &lt; <span class="number">0</span> &amp;&amp; s.indexOf(<span class="string">'E'</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">while</span> (s.endsWith(<span class="string">"0"</span>)) &#123;</span><br><span class="line">				s = s.substring(<span class="number">0</span>, s.length() - <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (s.endsWith(<span class="string">"."</span>)) &#123;</span><br><span class="line">				s = s.substring(<span class="number">0</span>, s.length() - <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional value associated with a key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return An object which is the value, or null if there is no value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">Object</span> opt(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">key</span> == <span class="keyword">null</span> ? <span class="keyword">null</span> : <span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">get</span>(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional boolean associated with a key. It returns false if there</span><br><span class="line">	 * is no such key, or if the value is not Boolean.TRUE or the String "true".</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return The truth.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> optBoolean(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> optBoolean(<span class="variable">key</span>, <span class="keyword">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional boolean associated with a key. It returns the</span><br><span class="line">	 * defaultValue if there is no such key, or if it is not a Boolean or the</span><br><span class="line">	 * String "true" or "false" (case insensitive).</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param defaultValue</span><br><span class="line">	 *            The default.</span><br><span class="line">	 * @return The truth.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">boolean</span> optBoolean(<span class="keyword">String</span> <span class="variable">key</span>, <span class="built_in">boolean</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getBoolean(<span class="variable">key</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/value pair in the JSONObject, where the value will be a</span><br><span class="line">	 * JSONArray which is produced from a Collection.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            A Collection value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, Collection value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONArray</span>(value));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional double associated with a key, or NaN if there is no such</span><br><span class="line">	 * key or if its value is not a number. If the value is a string, an attempt</span><br><span class="line">	 * will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A string which is the key.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> optDouble(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> optDouble(<span class="variable">key</span>, Double.NaN);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional double associated with a key, or the defaultValue if</span><br><span class="line">	 * there is no such key or if its value is not a number. If the value is a</span><br><span class="line">	 * string, an attempt will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param defaultValue</span><br><span class="line">	 *            The default.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">double</span> optDouble(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">double</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">			<span class="keyword">return</span> o <span class="keyword">instanceof</span> Number ? ((Number) o).doubleValue()</span><br><span class="line">					: <span class="keyword">new</span> Double((<span class="keyword">String</span>) o).doubleValue();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional int value associated with a key, or zero if there is no</span><br><span class="line">	 * such key or if the value is not a number. If the value is a string, an</span><br><span class="line">	 * attempt will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> optInt(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> optInt(<span class="variable">key</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional int value associated with a key, or the default if there</span><br><span class="line">	 * is no such key or if the value is not a number. If the value is a string,</span><br><span class="line">	 * an attempt will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param defaultValue</span><br><span class="line">	 *            The default.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">int</span> optInt(<span class="keyword">String</span> <span class="variable">key</span>, <span class="built_in">int</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getInt(<span class="variable">key</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional JSONArray associated with a key. It returns null if there</span><br><span class="line">	 * is no such key, or if its value is not a JSONArray.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A JSONArray which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONArray</span> optJSONArray(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span> ? (<span class="keyword">JSONArray</span>) o : <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional JSONObject associated with a key. It returns null if</span><br><span class="line">	 * there is no such key, or if its value is not a JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A JSONObject which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> optJSONObject(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">return</span> o <span class="keyword">instanceof</span> <span class="keyword">JSONObject</span> ? (<span class="keyword">JSONObject</span>) o : <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional long value associated with a key, or zero if there is no</span><br><span class="line">	 * such key or if the value is not a number. If the value is a string, an</span><br><span class="line">	 * attempt will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> optLong(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> optLong(<span class="variable">key</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional long value associated with a key, or the default if there</span><br><span class="line">	 * is no such key or if the value is not a number. If the value is a string,</span><br><span class="line">	 * an attempt will be made to evaluate it as a number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param defaultValue</span><br><span class="line">	 *            The default.</span><br><span class="line">	 * @return An object which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> optLong(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">long</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> getLong(<span class="variable">key</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">return</span> defaultValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional string associated with a key. It returns an empty string</span><br><span class="line">	 * if there is no such key. If the value is not a string and is not null,</span><br><span class="line">	 * then it is coverted to a string.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @return A string which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> optString(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> optString(<span class="variable">key</span>, <span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an optional string associated with a key. It returns the defaultValue</span><br><span class="line">	 * if there is no such key.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param defaultValue</span><br><span class="line">	 *            The default.</span><br><span class="line">	 * @return A string which is the value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> optString(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">String</span> defaultValue) &#123;</span><br><span class="line">		<span class="keyword">Object</span> o = opt(<span class="variable">key</span>);</span><br><span class="line">		<span class="keyword">return</span> o != <span class="keyword">null</span> ? o.toString() : defaultValue;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/boolean pair in the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            A boolean which is the value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, <span class="built_in">boolean</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, value ? Boolean.TRUE : Boolean.FALSE);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/double pair in the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            A double which is the value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the key is null or if the number is invalid.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">double</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, <span class="keyword">new</span> Double(value));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/int pair in the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            An int which is the value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, <span class="built_in">int</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, <span class="keyword">new</span> Integer(value));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/long pair in the JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            A long which is the value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">long</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, <span class="keyword">new</span> Long(value));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/value pair in the JSONObject, where the value will be a</span><br><span class="line">	 * JSONObject which is produced from a Map.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            A Map value.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, Map value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		put(<span class="variable">key</span>, <span class="keyword">new</span> <span class="keyword">JSONObject</span>(value));</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/value pair in the JSONObject. If the value is null, then the</span><br><span class="line">	 * key will be removed from the JSONObject if it is present.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            An object which is the value. It should be of one of these</span><br><span class="line">	 *            types: Boolean, Double, Integer, JSONArray, JSONObject, Long,</span><br><span class="line">	 *            String, or the JSONObject.NULL object.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the value is non-finite number or if the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> put(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">key</span> == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Null key."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value != <span class="keyword">null</span>) &#123;</span><br><span class="line">			testValidity(value);</span><br><span class="line">			<span class="keyword">this</span>.<span class="built_in">map</span>.put(<span class="variable">key</span>, value);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			remove(<span class="variable">key</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/value pair in the JSONObject, but only if the key and the value</span><br><span class="line">	 * are both non-null, and only if there is not already a member with that</span><br><span class="line">	 * name.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 * @param value</span><br><span class="line">	 * @return his.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             if the key is a duplicate</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> putOnce(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">key</span> != <span class="keyword">null</span> &amp;&amp; value != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (opt(<span class="variable">key</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Duplicate key \""</span> + <span class="variable">key</span> + <span class="string">"\""</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			put(<span class="variable">key</span>, value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Put a key/value pair in the JSONObject, but only if the key and the value</span><br><span class="line">	 * are both non-null.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * @param value</span><br><span class="line">	 *            An object which is the value. It should be of one of these</span><br><span class="line">	 *            types: Boolean, Double, Integer, JSONArray, JSONObject, Long,</span><br><span class="line">	 *            String, or the JSONObject.NULL object.</span><br><span class="line">	 * @return this.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the value is a non-finite number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONObject</span> putOpt(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">key</span> != <span class="keyword">null</span> &amp;&amp; value != <span class="keyword">null</span>) &#123;</span><br><span class="line">			put(<span class="variable">key</span>, value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a string in double quotes with backslash sequences in all the</span><br><span class="line">	 * right places. A backslash will be inserted within &lt;/, allowing JSON text</span><br><span class="line">	 * to be delivered in HTML. In JSON text, a string cannot contain a control</span><br><span class="line">	 * character or an unescaped quote or backslash.</span><br><span class="line">	 * </span><br><span class="line">	 * @param string</span><br><span class="line">	 *            A String</span><br><span class="line">	 * @return A String correctly formatted for insertion in a JSON text.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> quote(<span class="keyword">String</span> string) &#123;</span><br><span class="line">		<span class="keyword">if</span> (string == <span class="keyword">null</span> || string.length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"\"\""</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">char</span> b;</span><br><span class="line">		<span class="built_in">char</span> c = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">int</span> i;</span><br><span class="line">		<span class="built_in">int</span> len = string.length();</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(len + <span class="number">4</span>);</span><br><span class="line">		<span class="keyword">String</span> t;</span><br><span class="line"></span><br><span class="line">		sb.<span class="built_in">append</span>(<span class="string">'"'</span>);</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">1</span>) &#123;</span><br><span class="line">			b = c;</span><br><span class="line">			c = string.charAt(i);</span><br><span class="line">			<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\\'</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'"'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">'\\'</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(c);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">				<span class="keyword">if</span> (b == <span class="string">'&lt;'</span>) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">'\\'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				sb.<span class="built_in">append</span>(c);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\b'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"\\b"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\t'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"\\t"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\n'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"\\n"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\f'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"\\f"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\r'</span>:</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">"\\r"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">if</span> (c &lt; <span class="string">' '</span> || (c &gt;= <span class="string">'\u0080'</span> &amp;&amp; c &lt; <span class="string">'\u00a0'</span>)</span><br><span class="line">						|| (c &gt;= <span class="string">'\u2000'</span> &amp;&amp; c &lt; <span class="string">'\u2100'</span>)) &#123;</span><br><span class="line">					t = <span class="string">"000"</span> + Integer.toHexString(c);</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">"\\u"</span> + t.substring(t.length() - <span class="number">4</span>));</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(c);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sb.<span class="built_in">append</span>(<span class="string">'"'</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Remove a name and its value, if present.</span><br><span class="line">	 * </span><br><span class="line">	 * @param key</span><br><span class="line">	 *            The name to be removed.</span><br><span class="line">	 * @return The value that was associated with the name, or null if there was</span><br><span class="line">	 *         no value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">Object</span> remove(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.<span class="built_in">map</span>.remove(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get an enumeration of the keys of the JSONObject. The keys will be sorted</span><br><span class="line">	 * alphabetically.</span><br><span class="line">	 * </span><br><span class="line">	 * @return An iterator of the keys.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Iterator sortedKeys() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> TreeSet(<span class="keyword">this</span>.<span class="built_in">map</span>.keySet()).iterator();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Try to convert a string into a number, boolean, or null. If the string</span><br><span class="line">	 * can't be converted, return the string.</span><br><span class="line">	 * </span><br><span class="line">	 * @param s</span><br><span class="line">	 *            A String.</span><br><span class="line">	 * @return A simple JSON value.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">Object</span> stringToValue(<span class="keyword">String</span> s) &#123;</span><br><span class="line">		<span class="keyword">if</span> (s.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> s;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (s.equalsIgnoreCase(<span class="string">"true"</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> Boolean.TRUE;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (s.equalsIgnoreCase(<span class="string">"false"</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> Boolean.FALSE;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (s.equalsIgnoreCase(<span class="string">"null"</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">JSONObject</span>.NULL;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * If it might be a number, try converting it. We support the 0- and 0x-</span><br><span class="line">		 * conventions. If a number cannot be produced, then the value will just</span><br><span class="line">		 * be a string. Note that the 0-, 0x-, plus, and implied string</span><br><span class="line">		 * conventions are non-standard. A JSON parser is free to accept</span><br><span class="line">		 * non-JSON forms as long as it accepts all correct JSON forms.</span><br><span class="line">		 */</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">char</span> b = s.charAt(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span> ((b &gt;= <span class="string">'0'</span> &amp;&amp; b &lt;= <span class="string">'9'</span>) || b == <span class="string">'.'</span> || b == <span class="string">'-'</span> || b == <span class="string">'+'</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (b == <span class="string">'0'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (s.length() &gt; <span class="number">2</span></span><br><span class="line">						&amp;&amp; (s.charAt(<span class="number">1</span>) == <span class="string">'x'</span> || s.charAt(<span class="number">1</span>) == <span class="string">'X'</span>)) &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">new</span> Integer(Integer.parseInt(s.substring(<span class="number">2</span>), <span class="number">16</span>));</span><br><span class="line">					&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">						<span class="comment">/* Ignore the error */</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">new</span> Integer(Integer.parseInt(s, <span class="number">8</span>));</span><br><span class="line">					&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">						<span class="comment">/* Ignore the error */</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">new</span> Integer(s);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">new</span> Long(s);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception f) &#123;</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">new</span> Double(s);</span><br><span class="line">					&#125; <span class="keyword">catch</span> (Exception g) &#123;</span><br><span class="line">						<span class="comment">/* Ignore the error */</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Throw an exception if the object is an NaN or infinite number.</span><br><span class="line">	 * </span><br><span class="line">	 * @param o</span><br><span class="line">	 *            The object to test.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If o is a non-finite number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">void</span> testValidity(<span class="keyword">Object</span> o) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (o != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (o <span class="keyword">instanceof</span> Double) &#123;</span><br><span class="line">				<span class="keyword">if</span> (((Double) o).isInfinite() || ((Double) o).isNaN()) &#123;</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(</span><br><span class="line">							<span class="string">"JSON does not allow non-finite numbers."</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Float) &#123;</span><br><span class="line">				<span class="keyword">if</span> (((Float) o).isInfinite() || ((Float) o).isNaN()) &#123;</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(</span><br><span class="line">							<span class="string">"JSON does not allow non-finite numbers."</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Produce a JSONArray containing the values of the members of this</span><br><span class="line">	 * JSONObject.</span><br><span class="line">	 * </span><br><span class="line">	 * @param names</span><br><span class="line">	 *            A JSONArray containing a list of key strings. This determines</span><br><span class="line">	 *            the sequence of the values in the result.</span><br><span class="line">	 * @return A JSONArray of values.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If any of the values are non-finite numbers.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">JSONArray</span> toJSONArray(<span class="keyword">JSONArray</span> names) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (names == <span class="keyword">null</span> || names.length() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">JSONArray</span> ja = <span class="keyword">new</span> <span class="keyword">JSONArray</span>();</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; names.length(); i += <span class="number">1</span>) &#123;</span><br><span class="line">			ja.put(<span class="keyword">this</span>.opt(names.getString(i)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ja;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a JSON text of this JSONObject. For compactness, no whitespace is</span><br><span class="line">	 * added. If this would not result in a syntactically correct JSON text,</span><br><span class="line">	 * then null will be returned instead.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @return a printable, displayable, portable, transmittable representation</span><br><span class="line">	 *         of the object, beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(right</span><br><span class="line">	 *         brace)&lt;/small&gt;.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Iterator keys = keys();</span><br><span class="line">			StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"&#123;"</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (sb.length() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">','</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">Object</span> o = keys.next();</span><br><span class="line">				sb.<span class="built_in">append</span>(quote(o.toString()));</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">':'</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(valueToString(<span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">get</span>(o)));</span><br><span class="line">			&#125;</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">'&#125;'</span>);</span><br><span class="line">			<span class="keyword">return</span> sb.toString();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a prettyprinted JSON text of this JSONObject.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @param indentFactor</span><br><span class="line">	 *            The number of spaces to add to each level of indentation.</span><br><span class="line">	 * @return a printable, displayable, portable, transmittable representation</span><br><span class="line">	 *         of the object, beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(right</span><br><span class="line">	 *         brace)&lt;/small&gt;.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the object contains an invalid number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">String</span> toString(<span class="built_in">int</span> indentFactor) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">return</span> toString(indentFactor, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a prettyprinted JSON text of this JSONObject.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @param indentFactor</span><br><span class="line">	 *            The number of spaces to add to each level of indentation.</span><br><span class="line">	 * @param indent</span><br><span class="line">	 *            The indentation of the top level.</span><br><span class="line">	 * @return a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         object, beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(right</span><br><span class="line">	 *         brace)&lt;/small&gt;.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the object contains an invalid number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">String</span> toString(<span class="built_in">int</span> indentFactor, <span class="built_in">int</span> indent) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="built_in">int</span> j;</span><br><span class="line">		<span class="built_in">int</span> n = length();</span><br><span class="line">		<span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"&#123;&#125;"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		Iterator keys = sortedKeys();</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"&#123;"</span>);</span><br><span class="line">		<span class="built_in">int</span> newindent = indent + indentFactor;</span><br><span class="line">		<span class="keyword">Object</span> o;</span><br><span class="line">		<span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">			o = keys.next();</span><br><span class="line">			sb.<span class="built_in">append</span>(quote(o.toString()));</span><br><span class="line">			sb.<span class="built_in">append</span>(<span class="string">": "</span>);</span><br><span class="line">			sb.<span class="built_in">append</span>(valueToString(<span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">get</span>(o), indentFactor, indent));</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">				o = keys.next();</span><br><span class="line">				<span class="keyword">if</span> (sb.length() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">",\n"</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">'\n'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; newindent; j += <span class="number">1</span>) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				sb.<span class="built_in">append</span>(quote(o.toString()));</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">": "</span>);</span><br><span class="line">				sb.<span class="built_in">append</span>(valueToString(<span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">get</span>(o), indentFactor,</span><br><span class="line">						newindent));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (sb.length() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">				sb.<span class="built_in">append</span>(<span class="string">'\n'</span>);</span><br><span class="line">				<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; indent; j += <span class="number">1</span>) &#123;</span><br><span class="line">					sb.<span class="built_in">append</span>(<span class="string">' '</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sb.<span class="built_in">append</span>(<span class="string">'&#125;'</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a JSON text of an Object value. If the object has an</span><br><span class="line">	 * value.toJSONString() method, then that method will be used to produce the</span><br><span class="line">	 * JSON text. The method is required to produce a strictly conforming text.</span><br><span class="line">	 * If the object does not contain a toJSONString method (which is the most</span><br><span class="line">	 * common case), then a text will be produced by other means. If the value</span><br><span class="line">	 * is an array or Collection, then a JSONArray will be made from it and its</span><br><span class="line">	 * toJSONString method will be called. If the value is a MAP, then a</span><br><span class="line">	 * JSONObject will be made from it and its toJSONString method will be</span><br><span class="line">	 * called. Otherwise, the value's toString method will be called, and the</span><br><span class="line">	 * result will be quoted.</span><br><span class="line">	 * </span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @param value</span><br><span class="line">	 *            The value to be serialized.</span><br><span class="line">	 * @return a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         object, beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(right</span><br><span class="line">	 *         brace)&lt;/small&gt;.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the value is or contains an invalid number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">String</span> valueToString(<span class="keyword">Object</span> value) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (value == <span class="keyword">null</span> || value.equals(<span class="keyword">null</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"null"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> JSONString) &#123;</span><br><span class="line">			<span class="keyword">Object</span> o;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				o = ((JSONString) value).toJSONString();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">String</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> (<span class="keyword">String</span>) o;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Bad value from toJSONString: "</span> + o);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Number) &#123;</span><br><span class="line">			<span class="keyword">return</span> numberToString((Number) value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Boolean || value <span class="keyword">instanceof</span> <span class="keyword">JSONObject</span></span><br><span class="line">				|| value <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> value.toString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONObject</span>((Map) value).toString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Collection) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONArray</span>((Collection) value).toString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value.getClass().isArray()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONArray</span>(value).toString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> quote(value.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a prettyprinted JSON text of an object value.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @param value</span><br><span class="line">	 *            The value to be serialized.</span><br><span class="line">	 * @param indentFactor</span><br><span class="line">	 *            The number of spaces to add to each level of indentation.</span><br><span class="line">	 * @param indent</span><br><span class="line">	 *            The indentation of the top level.</span><br><span class="line">	 * @return a printable, displayable, transmittable representation of the</span><br><span class="line">	 *         object, beginning with &lt;code&gt;&#123;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(left</span><br><span class="line">	 *         brace)&lt;/small&gt; and ending with &lt;code&gt;&#125;&lt;/code&gt;&amp;nbsp;&lt;small&gt;(right</span><br><span class="line">	 *         brace)&lt;/small&gt;.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 *             If the object contains an invalid number.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">String</span> valueToString(<span class="keyword">Object</span> value, <span class="built_in">int</span> indentFactor, <span class="built_in">int</span> indent)</span><br><span class="line">			<span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">if</span> (value == <span class="keyword">null</span> || value.equals(<span class="keyword">null</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"null"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (value <span class="keyword">instanceof</span> JSONString) &#123;</span><br><span class="line">				<span class="keyword">Object</span> o = ((JSONString) value).toJSONString();</span><br><span class="line">				<span class="keyword">if</span> (o <span class="keyword">instanceof</span> <span class="keyword">String</span>) &#123;</span><br><span class="line">					<span class="keyword">return</span> (<span class="keyword">String</span>) o;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">/* forget about it */</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Number) &#123;</span><br><span class="line">			<span class="keyword">return</span> numberToString((Number) value);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Boolean) &#123;</span><br><span class="line">			<span class="keyword">return</span> value.toString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="keyword">JSONObject</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> ((<span class="keyword">JSONObject</span>) value).toString(indentFactor, indent);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> ((<span class="keyword">JSONArray</span>) value).toString(indentFactor, indent);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONObject</span>((Map) value).toString(indentFactor, indent);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value <span class="keyword">instanceof</span> Collection) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONArray</span>((Collection) value).toString(indentFactor,</span><br><span class="line">					indent);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (value.getClass().isArray()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">JSONArray</span>(value).toString(indentFactor, indent);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> quote(value.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Write the contents of the JSONObject as JSON text to a writer. For</span><br><span class="line">	 * compactness, no whitespace is added.</span><br><span class="line">	 * &lt;p&gt;</span><br><span class="line">	 * Warning: This method assumes that the data structure is acyclical.</span><br><span class="line">	 * </span><br><span class="line">	 * @return The writer.</span><br><span class="line">	 * @throws JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> Writer write(Writer writer) <span class="keyword">throws</span> JSONException &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="built_in">boolean</span> b = <span class="keyword">false</span>;</span><br><span class="line">			Iterator keys = keys();</span><br><span class="line">			writer.write(<span class="string">'&#123;'</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (keys.hasNext()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (b) &#123;</span><br><span class="line">					writer.write(<span class="string">','</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">Object</span> k = keys.next();</span><br><span class="line">				writer.write(quote(k.toString()));</span><br><span class="line">				writer.write(<span class="string">':'</span>);</span><br><span class="line">				<span class="keyword">Object</span> v = <span class="keyword">this</span>.<span class="built_in">map</span>.<span class="built_in">get</span>(k);</span><br><span class="line">				<span class="keyword">if</span> (v <span class="keyword">instanceof</span> <span class="keyword">JSONObject</span>) &#123;</span><br><span class="line">					((<span class="keyword">JSONObject</span>) v).write(writer);</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (v <span class="keyword">instanceof</span> <span class="keyword">JSONArray</span>) &#123;</span><br><span class="line">					((<span class="keyword">JSONArray</span>) v).write(writer);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					writer.write(valueToString(v));</span><br><span class="line">				&#125;</span><br><span class="line">				b = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			writer.write(<span class="string">'&#125;'</span>);</span><br><span class="line">			<span class="keyword">return</span> writer;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONString-java">JSONString.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JSONString</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toJSONString</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONStringer-java">JSONStringer.java</h2><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">StringWriter</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">JSONStringer</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">JSONWriter</span> &#123;</span></span><br><span class="line">	</span><br><span class="line">	public <span class="type">JSONStringer</span>() &#123;</span><br><span class="line">		<span class="keyword">super</span>(<span class="keyword">new</span> <span class="type">StringWriter</span>());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	public <span class="type">String</span> toString() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.mode == 'd' ? <span class="keyword">this</span>.writer.toString() : <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONTokener-java">JSONTokener.java</h2><figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.Reader;</span><br><span class="line"><span class="keyword">import</span> java.io.StringReader;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JSONTokener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">	<span class="keyword">private</span> Reader reader;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">char</span> lastChar;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> useLastChar;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONTokener from a string.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> reader</span><br><span class="line">	 *            A reader.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">JSONTokener</span><span class="params">(Reader reader)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.reader = reader.markSupported() ? reader : <span class="keyword">new</span> BufferedReader(</span><br><span class="line">				reader);</span><br><span class="line">		<span class="keyword">this</span>.useLastChar = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">this</span>.index = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Construct a JSONTokener from a string.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> s</span><br><span class="line">	 *            A source string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">JSONTokener</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>(<span class="keyword">new</span> StringReader(s));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Back up one character. This provides a sort of lookahead capability, so</span><br><span class="line">	 * that you can test for a digit or letter before attempting to parse the</span><br><span class="line">	 * next number or identifier.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">back</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (useLastChar || index &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Stepping back two steps is not supported"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		index -= <span class="number">1</span>;</span><br><span class="line">		useLastChar = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the hex value of a character (base16).</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> c</span><br><span class="line">	 *            A character between '0' and '9' or between 'A' and 'F' or</span><br><span class="line">	 *            between 'a' and 'f'.</span><br><span class="line">	 * <span class="doctag">@return</span> An int between 0 and 15, or -1 if c was not a hex digit.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">dehexchar</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> c - <span class="string">'0'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (c &gt;= <span class="string">'A'</span> &amp;&amp; c &lt;= <span class="string">'F'</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> c - (<span class="string">'A'</span> - <span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'f'</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> c - (<span class="string">'a'</span> - <span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Determine if the source string still contains characters that next() can</span><br><span class="line">	 * consume.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> true if not yet at the end of the source.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">more</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> nextChar = next();</span><br><span class="line">		<span class="keyword">if</span> (nextChar == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		back();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next character in the source string.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> The next character, or 0 if past the end of the source string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">char</span> <span class="title">next</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.useLastChar) &#123;</span><br><span class="line">			<span class="keyword">this</span>.useLastChar = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.lastChar != <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">this</span>.index += <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.lastChar;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> c;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			c = <span class="keyword">this</span>.reader.read();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException exc) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(exc);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (c &lt;= <span class="number">0</span>) &#123; <span class="comment">// End of stream</span></span><br><span class="line">			<span class="keyword">this</span>.lastChar = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.index += <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">this</span>.lastChar = (<span class="keyword">char</span>) c;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.lastChar;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Consume the next character, and check that it matches a specified</span><br><span class="line">	 * character.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> c</span><br><span class="line">	 *            The character to match.</span><br><span class="line">	 * <span class="doctag">@return</span> The character.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             if the character does not match.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">char</span> <span class="title">next</span><span class="params">(<span class="keyword">char</span> c)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> n = next();</span><br><span class="line">		<span class="keyword">if</span> (n != c) &#123;</span><br><span class="line">			<span class="keyword">throw</span> syntaxError(<span class="string">"Expected '"</span> + c + <span class="string">"' and instead saw '"</span> + n</span><br><span class="line">					+ <span class="string">"'"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next n characters.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> n</span><br><span class="line">	 *            The number of characters to take.</span><br><span class="line">	 * <span class="doctag">@return</span> A string of n characters.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             Substring bounds error if there are not n characters</span><br><span class="line">	 *             remaining in the source string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">next</span><span class="params">(<span class="keyword">int</span> n)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">char</span>[] buffer = <span class="keyword">new</span> <span class="keyword">char</span>[n];</span><br><span class="line">		<span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.useLastChar) &#123;</span><br><span class="line">			<span class="keyword">this</span>.useLastChar = <span class="keyword">false</span>;</span><br><span class="line">			buffer[<span class="number">0</span>] = <span class="keyword">this</span>.lastChar;</span><br><span class="line">			pos = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> len;</span><br><span class="line">			<span class="keyword">while</span> ((pos &lt; n)</span><br><span class="line">					&amp;&amp; ((len = reader.read(buffer, pos, n - pos)) != -<span class="number">1</span>)) &#123;</span><br><span class="line">				pos += len;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException exc) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(exc);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.index += pos;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (pos &lt; n) &#123;</span><br><span class="line">			<span class="keyword">throw</span> syntaxError(<span class="string">"Substring bounds error"</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">this</span>.lastChar = buffer[n - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> String(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next char in the string, skipping whitespace.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 * <span class="doctag">@return</span> A character, or 0 if there are no more characters.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">char</span> <span class="title">nextClean</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			<span class="keyword">char</span> c = next();</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="number">0</span> || c &gt; <span class="string">' '</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> c;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Return the characters up to the next close quote character. Backslash</span><br><span class="line">	 * processing is done. The formal JSON format does not allow strings in</span><br><span class="line">	 * single quotes, but an implementation is allowed to accept them.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> quote</span><br><span class="line">	 *            The quoting character, either &lt;code&gt;"&lt;/code&gt;</span><br><span class="line">	 *            &amp;nbsp;&lt;small&gt;(double quote)&lt;/small&gt; or &lt;code&gt;'&lt;/code&gt;</span><br><span class="line">	 *            &amp;nbsp;&lt;small&gt;(single quote)&lt;/small&gt;.</span><br><span class="line">	 * <span class="doctag">@return</span> A String.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             Unterminated string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">nextString</span><span class="params">(<span class="keyword">char</span> quote)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			c = next();</span><br><span class="line">			<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">case</span> '\n':</span><br><span class="line">			<span class="keyword">case</span> '\r':</span><br><span class="line">				<span class="keyword">throw</span> syntaxError(<span class="string">"Unterminated string"</span>);</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'\\'</span>:</span><br><span class="line">				c = next();</span><br><span class="line">				<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'b'</span>:</span><br><span class="line">					sb.append('\b');</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'t'</span>:</span><br><span class="line">					sb.append('\t');</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'n'</span>:</span><br><span class="line">					sb.append('\n');</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'f'</span>:</span><br><span class="line">					sb.append('\f');</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'r'</span>:</span><br><span class="line">					sb.append('\r');</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'u'</span>:</span><br><span class="line">					sb.append((<span class="keyword">char</span>) Integer.parseInt(next(4), 16));</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'x'</span>:</span><br><span class="line">					sb.append((<span class="keyword">char</span>) Integer.parseInt(next(2), 16));</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">default</span>:</span><br><span class="line">					sb.append(c);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">if</span> (c == quote) &#123;</span><br><span class="line">					<span class="function"><span class="keyword">return</span> sb.<span class="title">toString</span><span class="params">()</span></span>;</span><br><span class="line">				&#125;</span><br><span class="line">				sb.append(c);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the text up but not including the specified character or the end of</span><br><span class="line">	 * line, whichever comes first.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> d</span><br><span class="line">	 *            A delimiter character.</span><br><span class="line">	 * <span class="doctag">@return</span> A string.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">nextTo</span><span class="params">(<span class="keyword">char</span> d)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			<span class="keyword">char</span> c = next();</span><br><span class="line">			<span class="keyword">if</span> (c == d || c == <span class="number">0</span> || c == <span class="string">'\n'</span> || c == <span class="string">'\r'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (c != <span class="number">0</span>) &#123;</span><br><span class="line">					back();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> sb.toString().trim();</span><br><span class="line">			&#125;</span><br><span class="line">			sb.append(c);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the text up but not including one of the specified delimiter</span><br><span class="line">	 * characters or the end of line, whichever comes first.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> delimiters</span><br><span class="line">	 *            A set of delimiter characters.</span><br><span class="line">	 * <span class="doctag">@return</span> A string, trimmed.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">nextTo</span><span class="params">(String delimiters)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">			c = next();</span><br><span class="line">			<span class="keyword">if</span> (delimiters.indexOf(c) &gt;= <span class="number">0</span> || c == <span class="number">0</span> || c == <span class="string">'\n'</span> || c == <span class="string">'\r'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (c != <span class="number">0</span>) &#123;</span><br><span class="line">					back();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> sb.toString().trim();</span><br><span class="line">			&#125;</span><br><span class="line">			sb.append(c);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the next value. The value can be a Boolean, Double, Integer,</span><br><span class="line">	 * JSONArray, JSONObject, Long, or String, or the JSONObject.NULL object.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If syntax error.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> An object.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">Object <span class="title">nextValue</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> c = nextClean();</span><br><span class="line">		String s;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'"'</span>:</span><br><span class="line">		<span class="keyword">case</span> '\'':</span><br><span class="line">			<span class="keyword">return</span> nextString(c);</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'&#123;'</span>:</span><br><span class="line">			back();</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> JSONObject(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'['</span>:</span><br><span class="line">		<span class="keyword">case</span> '(':</span><br><span class="line">			back();</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> JSONArray(<span class="keyword">this</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * Handle unquoted text. This could be the values true, false, or null,</span><br><span class="line">		 * or it can be a number. An implementation (such as this one) is</span><br><span class="line">		 * allowed to also accept non-standard forms.</span><br><span class="line">		 * </span><br><span class="line">		 * Accumulate characters until we reach the end of the text or a</span><br><span class="line">		 * formatting character.</span><br><span class="line">		 */</span></span><br><span class="line"></span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		<span class="keyword">while</span> (c &gt;= <span class="string">' '</span> &amp;&amp; <span class="string">",:]&#125;/\\\"[&#123;;=#"</span>.indexOf(c) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			sb.append(c);</span><br><span class="line">			c = next();</span><br><span class="line">		&#125;</span><br><span class="line">		back();</span><br><span class="line"></span><br><span class="line">		s = sb.toString().trim();</span><br><span class="line">		<span class="keyword">if</span> (s.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">			<span class="keyword">throw</span> syntaxError(<span class="string">"Missing value"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">return</span> JSONObject.<span class="title">stringToValue</span><span class="params">(s)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Skip characters until the next character is the requested character. If</span><br><span class="line">	 * the requested character is not found, no characters are skipped.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> to</span><br><span class="line">	 *            A character to skip to.</span><br><span class="line">	 * <span class="doctag">@return</span> The requested character, or zero if the requested character is</span><br><span class="line">	 *         not found.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">char</span> <span class="title">skipTo</span><span class="params">(<span class="keyword">char</span> to)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> startIndex = <span class="keyword">this</span>.index;</span><br><span class="line">			reader.mark(Integer.MAX_VALUE);</span><br><span class="line">			do &#123;</span><br><span class="line">				c = next();</span><br><span class="line">				<span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">					reader.reset();</span><br><span class="line">					<span class="keyword">this</span>.index = startIndex;</span><br><span class="line">					<span class="keyword">return</span> c;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">while</span> (c != to);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException exc) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(exc);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		back();</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a JSONException to signal a syntax error.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> message</span><br><span class="line">	 *            The error message.</span><br><span class="line">	 * <span class="doctag">@return</span> A JSONException object, suitable for throwing</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">JSONException <span class="title">syntaxError</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> JSONException(message + toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a printable string of this JSONTokener.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> " at character [this.index]"</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function">String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">" at character "</span> + index;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="JSONWriter-java">JSONWriter.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.org.json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JSONWriter</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> maxdepth = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> comma;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">char</span> mode;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> JSONObject stack[];</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> top;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * The writer that will receive the output.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">protected</span> Writer writer;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Make a fresh JSONWriter. It can be used to build one JSON text.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">JSONWriter</span><span class="params">(Writer w)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.comma = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">this</span>.mode = <span class="string">'i'</span>;</span><br><span class="line">		<span class="keyword">this</span>.stack = <span class="keyword">new</span> JSONObject[maxdepth];</span><br><span class="line">		<span class="keyword">this</span>.top = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>.writer = w;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a value.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> s</span><br><span class="line">	 *            A string value.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the value is out of sequence.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> JSONWriter <span class="title">append</span><span class="params">(String s)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (s == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Null pointer"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'o'</span> || <span class="keyword">this</span>.mode == <span class="string">'a'</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">this</span>.comma &amp;&amp; <span class="keyword">this</span>.mode == <span class="string">'a'</span>) &#123;</span><br><span class="line">					<span class="keyword">this</span>.writer.write(<span class="string">','</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">this</span>.writer.write(s);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'o'</span>) &#123;</span><br><span class="line">				<span class="keyword">this</span>.mode = <span class="string">'k'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.comma = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Value out of sequence."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Begin appending a new array. All values until the balancing</span><br><span class="line">	 * &lt;code&gt;endArray&lt;/code&gt; will be appended to this array. The</span><br><span class="line">	 * &lt;code&gt;endArray&lt;/code&gt; method must be called to mark the array's end.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the nesting is too deep, or if the object is started in</span><br><span class="line">	 *             the wrong place (for example as a key or after the end of the</span><br><span class="line">	 *             outermost array or object).</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">array</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'i'</span> || <span class="keyword">this</span>.mode == <span class="string">'o'</span> || <span class="keyword">this</span>.mode == <span class="string">'a'</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.push(<span class="keyword">null</span>);</span><br><span class="line">			<span class="keyword">this</span>.append(<span class="string">"["</span>);</span><br><span class="line">			<span class="keyword">this</span>.comma = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Misplaced array."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * End something.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> m</span><br><span class="line">	 *            Mode</span><br><span class="line">	 * <span class="doctag">@param</span> c</span><br><span class="line">	 *            Closing character</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If unbalanced.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> JSONWriter <span class="title">end</span><span class="params">(<span class="keyword">char</span> m, <span class="keyword">char</span> c)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode != m) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(m == <span class="string">'o'</span> ? <span class="string">"Misplaced endObject."</span></span><br><span class="line">					: <span class="string">"Misplaced endArray."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.pop(m);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">this</span>.writer.write(c);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.comma = <span class="keyword">true</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * End an array. This method most be called to balance calls to</span><br><span class="line">	 * &lt;code&gt;array&lt;/code&gt;.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If incorrectly nested.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">endArray</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.end(<span class="string">'a'</span>, <span class="string">']'</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * End an object. This method most be called to balance calls to</span><br><span class="line">	 * &lt;code&gt;object&lt;/code&gt;.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If incorrectly nested.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">endObject</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.end(<span class="string">'k'</span>, <span class="string">'&#125;'</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a key. The key will be associated with the next value. In an</span><br><span class="line">	 * object, every value must be preceded by a key.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> s</span><br><span class="line">	 *            A key string.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the key is out of place. For example, keys do not belong</span><br><span class="line">	 *             in arrays or if the key is null.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">key</span><span class="params">(String s)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (s == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Null key."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'k'</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">this</span>.comma) &#123;</span><br><span class="line">					<span class="keyword">this</span>.writer.write(<span class="string">','</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				stack[top - <span class="number">1</span>].putOnce(s, Boolean.TRUE);</span><br><span class="line">				<span class="keyword">this</span>.writer.write(JSONObject.quote(s));</span><br><span class="line">				<span class="keyword">this</span>.writer.write(<span class="string">':'</span>);</span><br><span class="line">				<span class="keyword">this</span>.comma = <span class="keyword">false</span>;</span><br><span class="line">				<span class="keyword">this</span>.mode = <span class="string">'o'</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(e);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Misplaced key."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Begin appending a new object. All keys and values until the balancing</span><br><span class="line">	 * &lt;code&gt;endObject&lt;/code&gt; will be appended to this object. The</span><br><span class="line">	 * &lt;code&gt;endObject&lt;/code&gt; method must be called to mark the object's end.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the nesting is too deep, or if the object is started in</span><br><span class="line">	 *             the wrong place (for example as a key or after the end of the</span><br><span class="line">	 *             outermost array or object).</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">object</span><span class="params">()</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'i'</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.mode = <span class="string">'o'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.mode == <span class="string">'o'</span> || <span class="keyword">this</span>.mode == <span class="string">'a'</span>) &#123;</span><br><span class="line">			<span class="keyword">this</span>.append(<span class="string">"&#123;"</span>);</span><br><span class="line">			<span class="keyword">this</span>.push(<span class="keyword">new</span> JSONObject());</span><br><span class="line">			<span class="keyword">this</span>.comma = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Misplaced object."</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Pop an array or object scope.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> c</span><br><span class="line">	 *            The scope to close.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If nesting is wrong.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">(<span class="keyword">char</span> c)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.top &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Nesting error."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">char</span> m = <span class="keyword">this</span>.stack[<span class="keyword">this</span>.top - <span class="number">1</span>] == <span class="keyword">null</span> ? <span class="string">'a'</span> : <span class="string">'k'</span>;</span><br><span class="line">		<span class="keyword">if</span> (m != c) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Nesting error."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.top -= <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">this</span>.mode = <span class="keyword">this</span>.top == <span class="number">0</span> ? <span class="string">'d'</span></span><br><span class="line">				: <span class="keyword">this</span>.stack[<span class="keyword">this</span>.top - <span class="number">1</span>] == <span class="keyword">null</span> ? <span class="string">'a'</span> : <span class="string">'k'</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Push an array or object scope.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> c</span><br><span class="line">	 *            The scope to open.</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If nesting is too deep.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(JSONObject jo)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.top &gt;= maxdepth) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> JSONException(<span class="string">"Nesting too deep."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.stack[<span class="keyword">this</span>.top] = jo;</span><br><span class="line">		<span class="keyword">this</span>.mode = jo == <span class="keyword">null</span> ? <span class="string">'a'</span> : <span class="string">'k'</span>;</span><br><span class="line">		<span class="keyword">this</span>.top += <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append either the value &lt;code&gt;true&lt;/code&gt; or the value &lt;code&gt;false&lt;/code&gt;</span><br><span class="line">	 * .</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> b</span><br><span class="line">	 *            A boolean.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">value</span><span class="params">(<span class="keyword">boolean</span> b)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.append(b ? <span class="string">"true"</span> : <span class="string">"false"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a double value.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> d</span><br><span class="line">	 *            A double.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the number is not finite.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">value</span><span class="params">(<span class="keyword">double</span> d)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.value(<span class="keyword">new</span> Double(d));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append a long value.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> l</span><br><span class="line">	 *            A long.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">value</span><span class="params">(<span class="keyword">long</span> l)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.append(Long.toString(l));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Append an object value.</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> o</span><br><span class="line">	 *            The object to append. It can be null, or a Boolean, Number,</span><br><span class="line">	 *            String, JSONObject, or JSONArray, or an object with a</span><br><span class="line">	 *            toJSONString() method.</span><br><span class="line">	 * <span class="doctag">@return</span> this</span><br><span class="line">	 * <span class="doctag">@throws</span> JSONException</span><br><span class="line">	 *             If the value is out of sequence.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> JSONWriter <span class="title">value</span><span class="params">(Object o)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.append(JSONObject.valueToString(o));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="weibo4j-util包">weibo4j.util包</h1><h2 id="BareBonesBrowserLaunch-java">BareBonesBrowserLaunch.java</h2><figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.util;</span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//Bare Bones Browser Launch                            //</span></span><br><span class="line"><span class="comment">//Version 1.5 (December 10, 2005)                      //</span></span><br><span class="line"><span class="comment">//By Dem Pilafian                                      //</span></span><br><span class="line"><span class="comment">//Supports: Mac OS X, GNU/Linux, Unix, Windows XP      //</span></span><br><span class="line"><span class="comment">//Example Usage:                                       //</span></span><br><span class="line"><span class="comment">// String url = "http://www.centerkey.com/";           //</span></span><br><span class="line"><span class="comment">// BareBonesBrowserLaunch.openURL(url);                //</span></span><br><span class="line"><span class="comment">//Public Domain Software -- Free to Use as You Like    //</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * @author Dem Pilafian</span><br><span class="line"> * @author John Kristian</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JOptionPane;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> BareBonesBrowserLaunch &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> openURL(String url) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			browse(url);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			JOptionPane.showMessageDialog(</span><br><span class="line">					<span class="keyword">null</span>,</span><br><span class="line">					<span class="string">"Error attempting to launch web browser:\n"</span></span><br><span class="line">							+ e.getLocalizedMessage());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> browse(String url) <span class="keyword">throws</span> ClassNotFoundException,</span><br><span class="line">			IllegalAccessException, IllegalArgumentException,</span><br><span class="line">			InterruptedException, InvocationTargetException, IOException,</span><br><span class="line">			NoSuchMethodException &#123;</span><br><span class="line">		String osName = System.getProperty(<span class="string">"os.name"</span>, <span class="string">""</span>);</span><br><span class="line">		<span class="keyword">if</span> (osName.startsWith(<span class="string">"Mac OS"</span>)) &#123;</span><br><span class="line">			<span class="keyword">Class</span> fileMgr = <span class="keyword">Class</span>.forName(<span class="string">"com.apple.eio.FileManager"</span>);</span><br><span class="line">			Method openURL = fileMgr.getDeclaredMethod(<span class="string">"openURL"</span>,</span><br><span class="line">					<span class="keyword">new</span> <span class="keyword">Class</span>[] &#123; String.<span class="keyword">class</span> &#125;);</span><br><span class="line">			openURL.invoke(<span class="keyword">null</span>, <span class="keyword">new</span> Object[] &#123; url &#125;);</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (osName.startsWith(<span class="string">"Windows"</span>)) &#123;</span><br><span class="line">			<span class="keyword">Runtime</span>.getRuntime().exec(</span><br><span class="line">					<span class="string">"rundll32 url.dll,FileProtocolHandler "</span> + url);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// assume Unix or Linux</span></span><br><span class="line">			String[] browsers = &#123; <span class="string">"firefox"</span>, <span class="string">"opera"</span>, <span class="string">"konqueror"</span>, <span class="string">"epiphany"</span>,</span><br><span class="line">					<span class="string">"mozilla"</span>, <span class="string">"netscape"</span> &#125;;</span><br><span class="line">			String browser = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> <span class="keyword">count</span> = <span class="number">0</span>; <span class="keyword">count</span> &lt; browsers.length &amp;&amp; browser == <span class="keyword">null</span>; <span class="keyword">count</span>++)</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">Runtime</span>.getRuntime()</span><br><span class="line">						.exec(<span class="keyword">new</span> String[] &#123; <span class="string">"which"</span>, browsers[<span class="keyword">count</span>] &#125;)</span><br><span class="line">						.waitFor() == <span class="number">0</span>)</span><br><span class="line">					browser = browsers[<span class="keyword">count</span>];</span><br><span class="line">			<span class="keyword">if</span> (browser == <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodException(<span class="string">"Could not find web browser"</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">Runtime</span>.getRuntime().exec(<span class="keyword">new</span> String[] &#123; browser, url &#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="URLEncodeUtils-java">URLEncodeUtils.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.util.BitSet;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * @author sinaWeibo</span><br><span class="line"> * </span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> class URLEncodeUtils &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> BitSet dontNeedEncoding;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * The list of characters that are not encoded has been determined as</span><br><span class="line">		 * follows:</span><br><span class="line">		 * </span><br><span class="line">		 * RFC 2396 states: ----- Data characters that are allowed in a URI but</span><br><span class="line">		 * do not have a reserved purpose are called unreserved. These include</span><br><span class="line">		 * upper and lower case letters, decimal digits, and a limited set of</span><br><span class="line">		 * punctuation marks and symbols.</span><br><span class="line">		 * </span><br><span class="line">		 * unreserved = alphanum | mark</span><br><span class="line">		 * </span><br><span class="line">		 * mark = "-" | "_" | "." | "!" | "~" | "*" | "'" | "(" | ")"</span><br><span class="line">		 * </span><br><span class="line">		 * Unreserved characters can be escaped without changing the semantics</span><br><span class="line">		 * of the URI, but this should not be done unless the URI is being used</span><br><span class="line">		 * in a context that does not allow the unescaped character to appear.</span><br><span class="line">		 * -----</span><br><span class="line">		 * </span><br><span class="line">		 * It appears that both Netscape and Internet Explorer escape all</span><br><span class="line">		 * special characters from this list with the exception of "-", "_",</span><br><span class="line">		 * ".", "*". While it is not clear why they are escaping the other</span><br><span class="line">		 * characters, perhaps it is safest to assume that there might be</span><br><span class="line">		 * contexts in which the others are unsafe if not escaped. Therefore, we</span><br><span class="line">		 * will use the same list. It is also noteworthy that this is consistent</span><br><span class="line">		 * with O'Reilly's "HTML: The Definitive Guide" (page 164).</span><br><span class="line">		 * </span><br><span class="line">		 * As a last note, Intenet Explorer does not encode the "@" character</span><br><span class="line">		 * which is clearly not unreserved according to the RFC. We are being</span><br><span class="line">		 * consistent with the RFC in this matter, as is Netscape.</span><br><span class="line">		 */</span></span><br><span class="line"></span><br><span class="line">		dontNeedEncoding = <span class="keyword">new</span> BitSet(<span class="number">256</span>);</span><br><span class="line">		<span class="built_in">int</span> i;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="string">'a'</span>; i &lt;= <span class="string">'z'</span>; i++) &#123;</span><br><span class="line">			dontNeedEncoding.<span class="built_in">set</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="string">'A'</span>; i &lt;= <span class="string">'Z'</span>; i++) &#123;</span><br><span class="line">			dontNeedEncoding.<span class="built_in">set</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="string">'0'</span>; i &lt;= <span class="string">'9'</span>; i++) &#123;</span><br><span class="line">			dontNeedEncoding.<span class="built_in">set</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">' '</span>); <span class="comment">/*</span><br><span class="line">									 * encoding a space to a + is done in the</span><br><span class="line">									 * encode() method</span><br><span class="line">									 */</span></span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'-'</span>);</span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'_'</span>);</span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'.'</span>);</span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'*'</span>);</span><br><span class="line"></span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'+'</span>);</span><br><span class="line">		dontNeedEncoding.<span class="built_in">set</span>(<span class="string">'%'</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 判断段落文本是否被urlencode过</span><br><span class="line">	 * </span><br><span class="line">	 * @param str</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">boolean</span> isURLEncoded(<span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">str</span> == <span class="keyword">null</span> || <span class="string">""</span>.equals(<span class="built_in">str</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">char</span>[] chars = <span class="built_in">str</span>.toCharArray();</span><br><span class="line">		<span class="built_in">boolean</span> containsPercent = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">char</span> c : chars) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Character.isWhitespace(c)) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!dontNeedEncoding.<span class="built_in">get</span>(c)) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (c == <span class="string">'%'</span>) &#123;</span><br><span class="line">				containsPercent = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!containsPercent) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> encodeURL(<span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLEncoder.encode(<span class="built_in">str</span>, <span class="string">"utf-8"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> decodeURL(<span class="keyword">String</span> <span class="built_in">str</span>) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> URLDecoder.decode(<span class="built_in">str</span>, <span class="string">"utf-8"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="WeiboConfig-java">WeiboConfig.java</h2><figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> weibo4j.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class WeiboConfig &#123;</span><br><span class="line">	<span class="keyword">public</span> WeiboConfig() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			props.load(Thread.currentThread().getContextClassLoader()</span><br><span class="line">					.getResourceAsStream(<span class="string">"config.properties"</span>));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getValue(<span class="keyword">String</span> <span class="variable">key</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> props.getProperty(<span class="variable">key</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> updateProperties(<span class="keyword">String</span> <span class="variable">key</span>, <span class="keyword">String</span> value) &#123;</span><br><span class="line">		props.setProperty(<span class="variable">key</span>, value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Java/">Java</a><a href="/tags/网络爬虫/">网络爬虫</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	<div class="share-jiathis">
	  
<div class="jiathis_style_24x24">
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_googleplus"></a>
	<a class="jiathis_button_douban"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
" charset="utf-8"></script>      

	 </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/09/08/Java性能优化-12-最小化类和成员可访问能力/" title="Java性能优化(12):最小化类和成员可访问能力">
  <strong>上一篇：</strong><br/>
  <span>
  Java性能优化(12):最小化类和成员可访问能力</span>
</a>
</div>


<div class="next">
<a href="/2015/09/06/Java性能优化-11-考虑实现Comparable接口/"  title="Java性能优化(11):考虑实现Comparable接口">
 <strong>下一篇：</strong><br/> 
 <span>Java性能优化(11):考虑实现Comparable接口
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/09/07/基于OAtuth2的新浪微博Java爬虫/" data-title="基于OAtuth2的新浪微博Java爬虫" data-url="http://pangjiuzala.github.io/2015/09/07/基于OAtuth2的新浪微博Java爬虫/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#代码结构图"><span class="toc-number">1.</span> <span class="toc-text">代码结构图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#说明"><span class="toc-number">2.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#依赖jar包"><span class="toc-number">3.</span> <span class="toc-text">依赖jar包</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#存储文件"><span class="toc-number">4.</span> <span class="toc-text">存储文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#配置文件"><span class="toc-number">5.</span> <span class="toc-text">配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#config-properties"><span class="toc-number">5.1.</span> <span class="toc-text">config.properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log4j-properties"><span class="toc-number">5.2.</span> <span class="toc-text">log4j.properties</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#getData包"><span class="toc-number">6.</span> <span class="toc-text">getData包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GetFriendsData-java"><span class="toc-number">6.1.</span> <span class="toc-text">GetFriendsData.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#graph包"><span class="toc-number">7.</span> <span class="toc-text">graph包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GraphGenerate-java"><span class="toc-number">7.1.</span> <span class="toc-text">GraphGenerate.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GraphGenerateDriver-java"><span class="toc-number">7.2.</span> <span class="toc-text">GraphGenerateDriver.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MergeGraph-java"><span class="toc-number">7.3.</span> <span class="toc-text">MergeGraph.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IO包"><span class="toc-number">8.</span> <span class="toc-text">IO包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#FileIOOperation-java"><span class="toc-number">8.1.</span> <span class="toc-text">FileIOOperation.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j包"><span class="toc-number">9.</span> <span class="toc-text">weibo4j包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Friendships-java"><span class="toc-number">9.1.</span> <span class="toc-text">Friendships.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Users-java"><span class="toc-number">9.2.</span> <span class="toc-text">Users.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weibo-java"><span class="toc-number">9.3.</span> <span class="toc-text">Weibo.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-http包"><span class="toc-number">10.</span> <span class="toc-text">weibo4j.http包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AccessToken-java"><span class="toc-number">10.1.</span> <span class="toc-text">AccessToken.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BASE64Encoder-java"><span class="toc-number">10.2.</span> <span class="toc-text">BASE64Encoder.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTMLEntity-java"><span class="toc-number">10.3.</span> <span class="toc-text">HTMLEntity.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HttpClient-java"><span class="toc-number">10.4.</span> <span class="toc-text">HttpClient.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ImageItem-java"><span class="toc-number">10.5.</span> <span class="toc-text">ImageItem.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Response-java"><span class="toc-number">10.6.</span> <span class="toc-text">Response.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-model包"><span class="toc-number">11.</span> <span class="toc-text">weibo4j.model包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ApiRateLimits-java"><span class="toc-number">11.1.</span> <span class="toc-text">ApiRateLimits.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configuration-java"><span class="toc-number">11.2.</span> <span class="toc-text">Configuration.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Constants-java"><span class="toc-number">11.3.</span> <span class="toc-text">Constants.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySSLSocketFactory-java"><span class="toc-number">11.4.</span> <span class="toc-text">MySSLSocketFactory.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paging-java"><span class="toc-number">11.5.</span> <span class="toc-text">Paging.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PostParameter-java"><span class="toc-number">11.6.</span> <span class="toc-text">PostParameter.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Source-java"><span class="toc-number">11.7.</span> <span class="toc-text">Source.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Status-java"><span class="toc-number">11.8.</span> <span class="toc-text">Status.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StatusWapper-java"><span class="toc-number">11.9.</span> <span class="toc-text">StatusWapper.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#User-java"><span class="toc-number">11.10.</span> <span class="toc-text">User.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UserTrend-java"><span class="toc-number">11.11.</span> <span class="toc-text">UserTrend.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UserWapper-java"><span class="toc-number">11.12.</span> <span class="toc-text">UserWapper.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Version-java"><span class="toc-number">11.13.</span> <span class="toc-text">Version.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Visible-java"><span class="toc-number">11.14.</span> <span class="toc-text">Visible.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboException-java"><span class="toc-number">11.15.</span> <span class="toc-text">WeiboException.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboResponse-java"><span class="toc-number">11.16.</span> <span class="toc-text">WeiboResponse.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-org-json包"><span class="toc-number">12.</span> <span class="toc-text">weibo4j.org.json包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CDL-java"><span class="toc-number">12.1.</span> <span class="toc-text">CDL.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-java"><span class="toc-number">12.2.</span> <span class="toc-text">Cookie.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CookieList-java"><span class="toc-number">12.3.</span> <span class="toc-text">CookieList.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-java"><span class="toc-number">12.4.</span> <span class="toc-text">HTTP.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTPTokener-java"><span class="toc-number">12.5.</span> <span class="toc-text">HTTPTokener.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONArray-java"><span class="toc-number">12.6.</span> <span class="toc-text">JSONArray.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONException-java"><span class="toc-number">12.7.</span> <span class="toc-text">JSONException.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONObject-java"><span class="toc-number">12.8.</span> <span class="toc-text">JSONObject.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONString-java"><span class="toc-number">12.9.</span> <span class="toc-text">JSONString.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONStringer-java"><span class="toc-number">12.10.</span> <span class="toc-text">JSONStringer.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONTokener-java"><span class="toc-number">12.11.</span> <span class="toc-text">JSONTokener.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONWriter-java"><span class="toc-number">12.12.</span> <span class="toc-text">JSONWriter.java</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#weibo4j-util包"><span class="toc-number">13.</span> <span class="toc-text">weibo4j.util包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BareBonesBrowserLaunch-java"><span class="toc-number">13.1.</span> <span class="toc-text">BareBonesBrowserLaunch.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URLEncodeUtils-java"><span class="toc-number">13.2.</span> <span class="toc-text">URLEncodeUtils.java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeiboConfig-java"><span class="toc-number">13.3.</span> <span class="toc-text">WeiboConfig.java</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=2129798793&verifier=c0951e84&dpc=1"></iframe>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>31</sup></a></li>
			
		
			
				<li><a href="/tags/大数据/" title="大数据">大数据<sup>26</sup></a></li>
			
		
			
				<li><a href="/tags/性能优化/" title="性能优化">性能优化<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/数据挖掘/" title="数据挖掘">数据挖掘<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/HBase/" title="HBase">HBase<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Spark/" title="Spark">Spark<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/机器学习/" title="机器学习">机器学习<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/网络爬虫/" title="网络爬虫">网络爬虫<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/移动互联网/" title="移动互联网">移动互联网<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/物联网/" title="物联网">物联网<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/云平台/" title="云平台">云平台<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Taobao-File-System/" title="Taobao File System">Taobao File System<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/智慧医疗/" title="智慧医疗">智慧医疗<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/设计模式/" title="设计模式">设计模式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/爬虫/" title="爬虫">爬虫<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/云计算/" title="云计算">云计算<sup>1</sup></a></li>
			
		
		</ul>
</div>


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">31</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">25</span></li></ul>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.csdn.net/pangjiuzala" target="_blank" title="My Blog in  CSDN">CSDN</a>
            
          </li>
        
          <li>
            
            	<a href="http://saliormoon.github.io/" target="_blank" title="王宇峰的博客">王宇峰的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.changhuiyuan.com/" target="_blank" title="常惠源的博客">常惠源的博客</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="https://github.com/search?q=pangjiuzala&amp;type=Users" target="_blank" title="关注刘兴的github">关注</a>
</div>

  

  


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello,I&#39;m from ZjuCs! <br/>
			The more you diligent, the more you lucky!</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Copyright@ 2015 Liuxing All rights reserved.
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"pangjiuzala"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'null', 'null');  
ga('send', 'pageview');
</script>



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffeafc504b70a541dd3845d467335f367' type='text/javascript'%3E%3C/script%3E"));
</script>



<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_null'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s23.cnzz.com/z_stat.php%3Fid%3Dnull' type='text/javascript'%3E%3C/script%3E"));</script>

<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<script>
var option = {
  engineKey: '4ac092ad8d749fdc6293'
};
(function(w,d,t,u,n,s,e){
  s = d.createElement(t);
  s.src = u;
  s.async = 1;
  w[n] = function(r){
    w[n].opts = r;
  };
  e = d.getElementsByTagName(t)[0];
  e.parentNode.insertBefore(s, e);
})(window,document,'script','//tinysou-cdn.b0.upaiyun.com/ts.js','_ts');
_ts(option);
</script>

<!-- Tiny_search End -->

  </body>
</html>
